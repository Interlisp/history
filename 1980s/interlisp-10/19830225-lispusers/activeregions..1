(FILECREATED "13-OCT-82 01:21:42" {SDR2020}PS:<DOLPHIN.LISPUSERS>ACTIVEREGIONS.;3 6212         changes to:  (FNS ACTIVEREGIONS/DEFAULTHIGHLIGHTFN)      previous date: " 2-SEP-82 15:35:22" {SDR2020}PS:<DOLPHIN.LISPUSERS>ACTIVEREGIONS.;2)(PRETTYCOMPRINT ACTIVEREGIONSCOMS)(RPAQQ ACTIVEREGIONSCOMS ((* * public part)			  (RECORDS ACTIVEREGION)			  (FNS * ACTIVEREGIONSFNS)			  (* * private part)			  (FNS * ACTIVEREGIONSHIDDENFNS)))(* * public part)[DECLARE: EVAL@COMPILE (RECORD ACTIVEREGION (REGION HELPSTRING DOWNFN UPFN HIGHLIGHTFN LOWLIGHTFN DATA))](RPAQQ ACTIVEREGIONSFNS (SETACTIVEREGIONS ADDACTIVEREGION DELETEACTIVEREGION 					  FINDACTIVEREGION SETPICKREGION GETPICKREGION))(DEFINEQ(SETACTIVEREGIONS  (LAMBDA (Window Regionlist Highlightfn Lowlightfn)                                                      (* DRB: " 1-SEP-82 15:28")    (COND      ((NOT (WINDOWP Window))	(ERROR "SETACTIVEREGIONS: ARG NOT WINDOW" Window))      (T (WINDOWPROP Window (QUOTE ACTIVEREGIONS)		     Regionlist)	 (WINDOWPROP Window (QUOTE HIGHLIGHTFN)		     (AND Regionlist (OR Highlightfn (FUNCTION 					   ACTIVEREGIONS/DEFAULTHIGHLIGHTFN))))	 (WINDOWPROP Window (QUOTE LOWLIGHTFN)		     (AND Regionlist (OR Lowlightfn Highlightfn (FUNCTION 					   ACTIVEREGIONS/DEFAULTHIGHLIGHTFN))))	 (WINDOWPROP Window (QUOTE BUTTONEVENTFN)		     (AND Regionlist (FUNCTION ACTIVEREGIONS/BUTTONEVENTFN)))	 (WINDOWPROP Window (QUOTE PICKREGION)		     NIL)))))(ADDACTIVEREGION  (LAMBDA (Window Activeregion)                       (* DRB: " 1-SEP-82 15:17")    (COND      ((NOT (WINDOWP Window))	(ERROR "ADDACTIVEREGION: ARG NOT WINDOW" Window)	NIL)      (T (WINDOWPROP Window (QUOTE ACTIVEREGIONS)		     (CONS Activeregion (WINDOWPROP Window (QUOTE ACTIVEREGIONS))))))))(DELETEACTIVEREGION  (LAMBDA (Window Activeregion)                       (* DRB: " 1-SEP-82 15:21")    (COND      ((NOT (WINDOWP Window))	(ERROR "DELETEACTIVEREGION: ARG NOT WINDOW" Window)	NIL)      (T (AND (EQ Activeregion (GETPICKREGION Window))	      (SETPICKREGION Window NIL))	 (WINDOWPROP Window (QUOTE ACTIVEREGIONS)		     (DREMOVE Activeregion (WINDOWPROP Window (QUOTE ACTIVEREGIONS))))))))(FINDACTIVEREGION  (LAMBDA (Window Xcoord Ycoord Regionlist/optional)                                                      (* DRB: " 1-SEP-82 15:11")    (COND      ((NOT (WINDOWP Window))	(ERROR "FINDACTIVEREGION: ARG NOT WINDOW" Window)	NIL)      (T (for X in (OR Regionlist/optional (WINDOWPROP Window (QUOTE ACTIVEREGIONS)))	    thereis (ACTIVEREGIONS/CHECKPOSITION (fetch (ACTIVEREGION REGION)						    of X)						 Xcoord Ycoord))))))(SETPICKREGION  (LAMBDA (Window Activeregion Oldregion/local)       (* DRB: " 2-SEP-82 15:12")    (COND      ((NOT (WINDOWP Window))	(ERROR "DELETEACTIVEREGION: ARG NOT WINDOW" Window)	NIL)      ((NEQ Activeregion (SETQ Oldregion/local (GETPICKREGION Window)))	(AND Oldregion/local (ACTIVEREGIONS/DOLOWLIGHT Window Oldregion/local))	(AND Activeregion (PROGN (APPLY* (OR (fetch (ACTIVEREGION DOWNFN) of Activeregion)					     (FUNCTION NILL))					 Window					 (fetch (ACTIVEREGION REGION) of Activeregion)					 (fetch (ACTIVEREGION DATA) of Activeregion))				 (MOUSESTATE LEFT))	     (PROGN (ACTIVEREGIONS/DOHIGHLIGHT Window Activeregion)		    Activeregion)))      (T Activeregion))))(GETPICKREGION  (LAMBDA (Window)                                    (* DRB: " 1-SEP-82 10:43")    (WINDOWPROP Window (QUOTE PICKREGION)))))(* * private part)(RPAQQ ACTIVEREGIONSHIDDENFNS (ACTIVEREGIONS/BUTTONEVENTFN ACTIVEREGIONS/CHECKPOSITION 							   ACTIVEREGIONS/DOHIGHLIGHT 							   ACTIVEREGIONS/DOLOWLIGHT 						     ACTIVEREGIONS/DEFAULTHIGHLIGHTFN))(DEFINEQ(ACTIVEREGIONS/BUTTONEVENTFN  (LAMBDA (Window)                                    (* DRB: " 2-SEP-82 14:09")    (while (MOUSESTATE LEFT) bind (PLACELIST _(WINDOWPROP Window (QUOTE ACTIVEREGIONS)))				  (LASTPLACE _(GETPICKREGION Window))       do (SETQ LASTPLACE (SETPICKREGION Window (FINDACTIVEREGION Window (LASTMOUSEX								    Window)								  (LASTMOUSEY Window)								  PLACELIST)))       finally (PROGN (AND LASTPLACE (APPLY* (OR (fetch (ACTIVEREGION UPFN) of LASTPLACE)						 (FUNCTION NILL))					     Window					     (fetch (ACTIVEREGION REGION) of LASTPLACE)					     (fetch (ACTIVEREGION DATA) of LASTPLACE)))		      (RETURN LASTPLACE)))))(ACTIVEREGIONS/CHECKPOSITION  (LAMBDA (Region Xcoord Ycoord)                      (* DRB: " 1-SEP-82 09:44")          (* Returns NIL unless (Xcoord Ycoord) is within Region)    (AND (IGEQ Xcoord (fetch (REGION LEFT) of Region))	 (ILEQ Xcoord (fetch (REGION RIGHT) of Region))	 (IGEQ Ycoord (fetch (REGION BOTTOM) of Region))	 (ILEQ Ycoord (fetch (REGION TOP) of Region)))))(ACTIVEREGIONS/DOHIGHLIGHT  (LAMBDA (Window Activeregion)                       (* DRB: " 2-SEP-82 15:10")    (APPLY* (OR (fetch (ACTIVEREGION HIGHLIGHTFN) of Activeregion)		(WINDOWPROP Window (QUOTE HIGHLIGHTFN))		(FUNCTION NILL))	    Window Activeregion)    (WINDOWPROP Window (QUOTE PICKREGION)		Activeregion)))(ACTIVEREGIONS/DOLOWLIGHT  (LAMBDA (Window Activeregion)                       (* DRB: " 2-SEP-82 15:11")    (APPLY* (OR (fetch (ACTIVEREGION LOWLIGHTFN) of Activeregion)		(WINDOWPROP Window (QUOTE LOWLIGHTFN))		(FUNCTION NILL))	    Window Activeregion)    (WINDOWPROP Window (QUOTE PICKREGION)		NIL)))(ACTIVEREGIONS/DEFAULTHIGHLIGHTFN  (LAMBDA (Window Activeregion)                       (* ejs: "12-OCT-82 23:58")    (PROG ((WC (DSPCLIPPINGREGION NIL Window)))          (BITBLT NIL NIL NIL Window (fetch (REGION LEFT) of WC)		  (fetch (REGION BOTTOM) of WC)		  (fetch (REGION WIDTH) of WC)		  (fetch (REGION HEIGHT) of WC)		  (QUOTE TEXTURE)		  (QUOTE INVERT)		  BLACKSHADE		  (fetch (ACTIVEREGION REGION) of Activeregion))))))(DECLARE: DONTCOPY  (FILEMAP (NIL (726 3634 (SETACTIVEREGIONS 736 . 1501) (ADDACTIVEREGION 1503 . 1828) (DELETEACTIVEREGION 1830 . 2255) (FINDACTIVEREGION 2257 . 2737) (SETPICKREGION 2739 . 3482) (GETPICKREGION 3484 . 3632)) (3872 6190 (ACTIVEREGIONS/BUTTONEVENTFN 3882 . 4608) (ACTIVEREGIONS/CHECKPOSITION 4610 . 5036) (ACTIVEREGIONS/DOHIGHLIGHT 5038 . 5375) (ACTIVEREGIONS/DOLOWLIGHT 5377 . 5702) (ACTIVEREGIONS/DEFAULTHIGHLIGHTFN 5704 . 6188)))))STOP