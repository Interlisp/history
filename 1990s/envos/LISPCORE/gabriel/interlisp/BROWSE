(FILECREATED "18-Nov-85 14:31:42" {QV}<PEDERSEN>BENCHMARKS>BROWSE.;4 5551         changes to:  (FNS MATCH! BROWSE SEED-BROWSE RANDOMIZE RANDOM-BROWSE INIT-BROWSE INVESTIGATE)		   (VARS BROWSECOMS)      previous date: "28-Nov-84 19:18:36" {PHYLUM}<GABRIEL>BROWSE.;17)(* Copyright (c) 1983, 1984, 1985 by RPG. All rights reserved.)(PRETTYCOMPRINT BROWSECOMS)(RPAQQ BROWSECOMS ((MACROS CHAR1)		     (FNS INIT-BROWSE RANDOM-BROWSE SEED-BROWSE RANDOMIZE MATCH! BROWSE INVESTIGATE)		     (* * Call (BROWSE))		     (DECLARE: DONTCOPY DONTEVAL@LOAD DOEVAL@COMPILE (LOCALVARS . T))))(DECLARE: EVAL@COMPILE (PUTPROPS CHAR1 MACRO ((X)	   (NTHCHAR X 1))))(DEFINEQ(INIT-BROWSE  [LAMBDA (N M NPATS IPATS)                                  (* JonL "28-Nov-84 19:17")    (PROG ((IPATS (SUBST NIL NIL IPATS))	     LOSER)	    (RPLACD (SETQ LOSER (LAST IPATS))		      IPATS)	    (RETURN (PROG1 (bind (A _ NIL) for old N from N to 1 by -1				  as (I _ M) by (if (ZEROP I)							then M						      else (SUB1 I))				  as (NAME _(GENSYM)) by (GENSYM)				  do (push A NAME)				       (RPTQ I (PUTPROP NAME (GENSYM)							    NIL))				       (PUTPROP NAME (QUOTE PATTERN)						  (bind (A _ NIL) for I from NPATS						     to 1 by -1 as IPATS on IPATS						     do (push A (CAR IPATS))						     finally (RETURN A)))				       (RPTQ (DIFFERENCE M I)					       (PUTPROP NAME (GENSYM)							  NIL))				  finally (RETURN A))			       (RPLACD LOSER NIL)          (* To break the circularities)			       ])(RANDOM-BROWSE  [LAMBDA NIL                                                (* jop: "18-Nov-85 14:28")    (DECLARE (GLOBALVARS RAND-BROWSE))    (SETQ RAND-BROWSE (IMOD (ITIMES RAND-BROWSE 17)				251])(SEED-BROWSE  [LAMBDA NIL                                                (* jop: "18-Nov-85 14:28")    (DECLARE (GLOBALVARS RAND-BROWSE))    (SETQ RAND-BROWSE 21])(RANDOMIZE  [LAMBDA (L)                                                (* jop: "18-Nov-85 14:25")    (bind (A _ NIL) while L       do [PROG [(N (IMOD (RANDOM-BROWSE)				(LENGTH L]		    (COND		      ((ZEROP N)			(push A (CAR L))			(SETQ L (CDR L)))		      (T (for N from N to 2 by -1 as X on L do NIL			    finally (PROGN (push A (CADR X))					       (RPLACD X (CDDR X]       finally (RETURN A])(MATCH!  [LAMBDA (PAT DAT ALIST)                                    (* jop: "18-Nov-85 14:13")    (COND      ((NULL PAT)	(NULL DAT))      ((NULL DAT)	NIL)      ((OR (EQ (CAR PAT)		   (QUOTE ?))	     (EQ (CAR PAT)		   (CAR DAT)))	(MATCH! (CDR PAT)		  (CDR DAT)		  ALIST))      ((EQ (CAR PAT)	     (QUOTE *))	(OR (MATCH! (CDR PAT)			DAT ALIST)	      (MATCH! (CDR PAT)			(CDR DAT)			ALIST)	      (MATCH! PAT (CDR DAT)			ALIST)))      (T (COND	   [(NLISTP (CAR PAT))	     (COND	       [(EQ (CHAR1 (CAR PAT))		      (QUOTE ?))		 (PROG ((VAL (FASSOC (CAR PAT)					 ALIST)))		         (RETURN (COND				     (VAL (MATCH! (CONS (CDR VAL)							    (CDR PAT))						    DAT ALIST))				     (T (MATCH! (CDR PAT)						  (CDR DAT)						  (CONS (CONS (CAR PAT)								  (CAR DAT))							  ALIST]	       ((EQ (CHAR1 (CAR PAT))		      (QUOTE *))		 (PROG ((VAL (FASSOC (CAR PAT)					 ALIST)))		         (RETURN (COND				     (VAL (MATCH! (APPEND (CDR VAL)							      (CDR PAT))						    DAT ALIST))				     (T (for (L _ NIL) by (NCONC L (LIST (CAR DTEMP)))					   as E on (CONS NIL DAT) as (DTEMP _ DAT)					   by (CDR DTEMP)					   do (COND						  ((MATCH! (CDR PAT)							     DTEMP							     (CONS (CONS (CAR PAT)									     L)								     ALIST))						    (RETURN T]	   (T (AND (NOT (NLISTP (CAR DAT)))		     (MATCH! (CAR PAT)			       (CAR DAT)			       ALIST)		     (MATCH! (CDR PAT)			       (CDR DAT)			       ALIST])(BROWSE  [LAMBDA NIL                                                (* jop: "18-Nov-85 14:26")    (SEED-BROWSE)    (INVESTIGATE [RANDOMIZE (INIT-BROWSE 100 10 4					       (QUOTE ((A A A B B B B A A A A A B B A A A)							  (A A B B B B A A (A A)							     (B B))							  (A A A B (B A)							     B A B A]		   (QUOTE ((*A ?B *B ?B A *A A *B *A)			      (*A *B *B *A (*A)				  (*B))			      (? ? *(B A)* ? ?])(INVESTIGATE  [LAMBDA (UNITS PATS)                                       (* edited: "25-FEB-83 13:07")    (for UNITS on UNITS do (for PATS on PATS do (for P on (GETP (CAR UNITS)										  (QUOTE PATTERN))							       do (MATCH! (CAR PATS)									      (CAR P)									      NIL]))(* * Call (BROWSE))(DECLARE: DONTCOPY DONTEVAL@LOAD DOEVAL@COMPILE (DECLARE: DOEVAL@COMPILE DONTCOPY(LOCALVARS . T)))(PUTPROPS BROWSE COPYRIGHT ("RPG" 1983 1984 1985))(DECLARE: DONTCOPY  (FILEMAP (NIL (673 5348 (INIT-BROWSE 683 . 1743) (RANDOM-BROWSE 1745 . 1976) (SEED-BROWSE 1978 . 2164) (RANDOMIZE 2166 . 2692) (MATCH! 2694 . 4532) (BROWSE 4534 . 4988) (INVESTIGATE 4990 . 5346)))))STOP