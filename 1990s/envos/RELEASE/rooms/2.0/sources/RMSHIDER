(DEFINE-FILE-INFO READTABLE "XCL" PACKAGE "ROOMS")(IL:FILECREATED "30-Mar-93 18:37:04" IL:|{DSK}<python2>tmp>rooms>sources>RMSHIDER.;1| 54649        IL:|changes| IL:|to:|  (FILE-ENVIRONMENTS IL:RMSHIDER)                             (IL:VARS IL:RMSHIDERCOMS)); Copyright (c) 1993 by Venue.  All rights reserved.(IL:PRETTYCOMPRINT IL:RMSHIDERCOMS)(IL:RPAQQ IL:RMSHIDERCOMS          ((FILE-ENVIRONMENTS IL:RMSHIDER)           (IL:P (EXPORT '(HIDE-WINDOW UN-HIDE-WINDOW WINDOW-HIDDEN? ALL-WINDOWS LOST-WINDOWS))                 (REQUIRE "ROOMS"))           (IL:DECLARE\: IL:EVAL@COMPILE IL:DONTCOPY (IL:FILES (IL:LOADCOMP T)                                                            IL:WINDOW IL:FILEIO IL:LLDISPLAY IL:TTYIN                                                            ))           (IL:FUNCTIONS ALL-WINDOWS GET-HIDDEN-WINDOWS LOST-WINDOWS)           (IL:FUNCTIONS HIDE-ALL-WINDOWS HIDE-WINDOW HIDE-WINDOW-INTERNAL UN-HIDE-WINDOW                   UN-HIDE-WINDOW-INTERNAL DO-TOTOP-FUNCTIONS WINDOW-HIDDEN? %WINDOW-HIDDEN?)           (IL:FNS SHAPEW1 \\CLOSEW1 MOVEW \\INTERNALTOTOPW WFROMMENU RESHOWTITLE \\RESHOWBORDER1                   TTYIN.SETUP)           (IL:GLOBALVARS IL:LAMBDASPLST IL:\\EM.DISPINTERRUPT IL:\\SCREENBITMAPS                   IL:\\TTYIN.LAST.FONT IL:\\TTYIN.LAST.COMMENTFONT)           (EVAL-WHEN (LOAD)                  (IL:P (IL:MOVD 'SHAPEW1 'IL:SHAPEW1)                        (IL:MOVD '\\CLOSEW1 'IL:\\CLOSEW1)                        (IL:MOVD 'MOVEW 'IL:MOVEW)                        (IL:MOVD '\\INTERNALTOTOPW 'IL:\\INTERNALTOTOPW)                        (IL:MOVD 'WFROMMENU 'IL:WFROMMENU)                        (IL:MOVD 'RESHOWTITLE 'IL:RESHOWTITLE)                        (IL:MOVD '\\RESHOWBORDER1 'IL:\\RESHOWBORDER1)                        (IL:MOVD 'TTYIN.SETUP 'IL:TTYIN.SETUP)))           (IL:ADVISE IL:ATTACHWINDOW)))(DEFINE-FILE-ENVIRONMENT IL:RMSHIDER :COMPILER :COMPILE-FILE   :PACKAGE "ROOMS"   :READTABLE "XCL")(EXPORT '(HIDE-WINDOW UN-HIDE-WINDOW WINDOW-HIDDEN? ALL-WINDOWS LOST-WINDOWS))(REQUIRE "ROOMS")(IL:DECLARE\: IL:EVAL@COMPILE IL:DONTCOPY (IL:FILESLOAD (IL:LOADCOMP T)       IL:WINDOW IL:FILEIO IL:LLDISPLAY IL:TTYIN))(DEFUN ALL-WINDOWS (&OPTIONAL INCLUDE-HIDDEN?)(IL:* IL:|;;;| "returns a list of all the window groups in bottom first order.")   (LET (RESULT MAIN-WINDOW)        (DOLIST (WINDOW (IL:OPENWINDOWS IL:\\CURSORSCREEN)                       RESULT)            (PUSHNEW (MAIN-WINDOW WINDOW)                   RESULT :TEST 'EQ))        (WHEN INCLUDE-HIDDEN?            (MAPHASH #'(LAMBDA (WINDOW TRUE)                              (PUSHNEW (MAIN-WINDOW WINDOW)                                     RESULT :TEST 'EQ))                   (GET-HIDDEN-WINDOWS)))        RESULT))(DEFMACRO GET-HIDDEN-WINDOWS ()   '(GETF (IL:|fetch| (IL:SCREEN IL:SCDATA) IL:|of| IL:\\CURSORSCREEN)          '*HIDDEN-WINDOWS*))(DEFUN LOST-WINDOWS ()(IL:* IL:|;;;| "returns the subset of all existing windows which are not in any room.")(IL:* IL:|;;;| "as UPDATE-PLACEMENTS guarentees us that all un-hidden windows belong to a room, we know that all lost windows must be hidden. ")   (UPDATE-PLACEMENTS)   (WITH-COLLECTION (DOLIST (WINDOW (ALL-WINDOWS T))                        (UNLESS (FIND-ROOMS-CONTAINING WINDOW)                               (COLLECT WINDOW)))))(DEFUN HIDE-ALL-WINDOWS ()   (DOLIST (WINDOW (NREVERSE (ALL-WINDOWS)))       (HIDE-WINDOW WINDOW)))(DEFUN HIDE-WINDOW (WINDOW)   (LET ((WINDOW (MAIN-WINDOW WINDOW)))        (UNLESS (WINDOW-HIDDEN? WINDOW)            (LET ((ICON (WINDOW-ICON WINDOW)))                 (WHEN ICON (HIDE-WINDOW-INTERNAL ICON)))            (HIDE-WINDOW-INTERNAL WINDOW)            (IL:* IL:|;;| "return T if we succeded")            T)))(DEFUN HIDE-WINDOW-INTERNAL (WINDOW)   (UNLESS (WINDOW-HIDDEN? WINDOW)       (DOLIST (ATTACHED-WINDOW (IL:WINDOWPROP WINDOW 'IL:ATTACHEDWINDOWS))           (IL:* IL:|;;| "recursively hide attached windows")           (HIDE-WINDOW-INTERNAL ATTACHED-WINDOW))       (WHEN (IL:OPENWP WINDOW)           (IL:* IL:|;;| "save the image")           (IL:\\CLOSEW1 WINDOW))       (LET* ((DSP (IL:|fetch| (IL:WINDOW IL:DSP) IL:|of| WINDOW))              (BORDER (IL:|ffetch| (IL:WINDOW IL:WBORDER) IL:|of| WINDOW))              (CLIPPING-REGION (IL:DSPCLIPPINGREGION NIL DSP)))             (IL:UNINTERRUPTABLY                                  (IL:* IL:|;;| "switch the destination to the save bitmap")                 (IL:DSPDESTINATION (IL:|ffetch| (IL:WINDOW IL:SAVE) IL:|of| WINDOW)                        DSP)                 (IL:* IL:|;;| "adjust the offset")                 (IL:DSPXOFFSET (- BORDER (REGION-LEFT CLIPPING-REGION))                        DSP)                 (IL:DSPYOFFSET (- BORDER (REGION-BOTTOM CLIPPING-REGION))                        DSP)                 (IL:* IL:|;;| "so it's still IL:OPENWP")                 (IL:|freplace| (IL:WINDOW IL:NEXTW) IL:|of| WINDOW IL:|with| NIL))             (SETF (GETHASH WINDOW (GET-HIDDEN-WINDOWS))                   T))       T))(DEFUN UN-HIDE-WINDOW (WINDOW)   (LET* ((WINDOW (MAIN-WINDOW WINDOW))          (ICON (WINDOW-ICON WINDOW))          (SHRUNKEN? (SHRUNKEN? WINDOW)))         (WHEN ICON             (UN-HIDE-WINDOW-INTERNAL ICON (NOT SHRUNKEN?)))         (UN-HIDE-WINDOW-INTERNAL WINDOW SHRUNKEN?)         T))(DEFUN UN-HIDE-WINDOW-INTERNAL (WINDOW &OPTIONAL NO-OPEN)   (WHEN (WINDOW-HIDDEN? WINDOW)       (IL:UNINTERRUPTABLY           (LET* ((DSP (IL:|fetch| (IL:WINDOW IL:DSP) IL:|of| WINDOW))                  (REGION (IL:|ffetch| (IL:WINDOW IL:REG) IL:|of| WINDOW))                  (BORDER (IL:|ffetch| (IL:WINDOW IL:WBORDER) IL:|of| WINDOW))                  (CLIPPING-REGION (IL:DSPCLIPPINGREGION NIL DSP)))                 (IL:* IL:|;;| "switch the destination to the screen")                 (IL:DSPDESTINATION (IL:|fetch| (IL:SCREEN IL:SCDESTINATION)                                       IL:|of| (IL:|ffetch| (IL:WINDOW IL:SCREEN)                                                      IL:|of| WINDOW))                        DSP)                 (IL:* IL:|;;| "adjust the offsets")                 (IL:DSPXOFFSET (- (+ (REGION-LEFT REGION)                                      BORDER)                                   (REGION-LEFT CLIPPING-REGION))                        DSP)                 (IL:DSPYOFFSET (- (+ (REGION-BOTTOM REGION)                                      BORDER)                                   (REGION-BOTTOM CLIPPING-REGION))                        DSP)                 (IL:* IL:|;;| "so it's not IL:OPENWP")                 (IL:|freplace| (IL:WINDOW IL:NEXTW) IL:|of| WINDOW IL:|with|                                                                            'IL:CLOSED))))   (UNLESS NO-OPEN (IL:\\OPENW1 WINDOW))   (REMHASH WINDOW (GET-HIDDEN-WINDOWS))   (DOLIST (ATTACHED-WINDOW (IL:WINDOWPROP WINDOW 'IL:ATTACHEDWINDOWS))       (IL:* IL:|;;| "recursively un-hide attached windows")       (UN-HIDE-WINDOW-INTERNAL ATTACHED-WINDOW NO-OPEN))   (UNLESS NO-OPEN (DO-TOTOP-FUNCTIONS WINDOW)))(DEFUN DO-TOTOP-FUNCTIONS (WINDOW)   (LET ((TOTOPFN (IL:WINDOWPROP WINDOW 'IL:TOTOPFN)))        (IL:* IL:|;;| "TOTOPFN's often look at what's behind a window & since this window now has a new screen behind it we do these.  This makes buttons & icons work right.  ")        (WHEN (AND TOTOPFN (NOT                                 (IL:* IL:|;;| "we take care of attached windows already")                                (OR (IL:EQMEMB 'IL:TOPATTACHEDWINDOWS TOTOPFN)                                    (IL:EQMEMB 'IL:ATTACHEDWINDOWTOTOPFN TOTOPFN))))              (IL:DOUSERFNS TOTOPFN WINDOW))))(DEFUN WINDOW-HIDDEN? (WINDOW)   (%WINDOW-HIDDEN? WINDOW))(DEFINLINE %WINDOW-HIDDEN? (WINDOW)   (EQ (IL:FETCH (IL:\\DISPLAYDATA IL:|DDDestination|) IL:OF (IL:FETCH (STREAM                                                                                          IL:IMAGEDATA                                                                                          )                                                                        IL:OF (IL:FETCH                                                                                   (IL:WINDOW IL:DSP)                                                                                     IL:OF WINDOW                                                                                   )))       (IL:FFETCH (IL:WINDOW IL:SAVE) IL:OF WINDOW)))(IL:DEFINEQ(SHAPEW1  (IL:LAMBDA (IL:WINDOW IL:REGION)                 (IL:* IL:\; "Edited 15-Jun-88 17:08 by drc:")    (IL:* IL:|;;|   "entry for shaping a window that does the reshape without checking for a user function.")    (DECLARE (IL:LOCALVARS . T))    (IL:SETQ IL:WINDOW (IL:\\INSUREWINDOW IL:WINDOW))    (OR (IL:REGIONP IL:REGION)        (IL:\\ILLEGAL.ARG IL:REGION))    (PROG ((IL:OLDREGION (IL:|fetch| (IL:WINDOW IL:REG) IL:|of| IL:WINDOW))           (IL:OLDCLIPREG (IL:DSPCLIPPINGREGION NIL (IL:|fetch| (IL:WINDOW IL:DSP) IL:|of|                                                                                       IL:WINDOW)))           (IL:WBORDER (IL:|fetch| (IL:WINDOW IL:WBORDER) IL:|of| IL:WINDOW))           (IL:SAVE (IL:|fetch| (IL:WINDOW IL:SAVE) IL:|of| IL:WINDOW))           (IL:SCREEN (IL:|fetch| (IL:WINDOW IL:SCREEN) IL:|of| IL:WINDOW))           IL:NUSAV IL:NOWOPEN? IL:HIDDEN?)          (IL:SETQ IL:NUSAV (IL:BITMAPCREATE (IL:|fetch| (IL:REGION IL:WIDTH) IL:|of|                                                                                         IL:REGION)                                   (IL:|fetch| (IL:REGION IL:HEIGHT) IL:|of| IL:REGION)                                   (IL:|fetch| (IL:BITMAP IL:BITMAPBITSPERPIXEL)                                      IL:|of| (IL:|fetch| (IL:SCREEN IL:SCDESTINATION)                                                     IL:|of| IL:SCREEN))))          (IL:UNINTERRUPTABLY              (COND                 ((IL:OPENWP IL:WINDOW)                  (IL:|if| (WINDOW-HIDDEN? IL:WINDOW)                      IL:|then| (IL:SETQ IL:HIDDEN? T)                    IL:|else|                            (IL:* IL:\;                        "notice whether window is open or not to call OPENFNs only if not now open.")                          (IL:SETQ IL:NOWOPEN? T)                          (IL:\\CLOSEW1 IL:WINDOW))))        (IL:* IL:\; "Save window image")              (IL:|replace| (IL:WINDOW IL:REG) IL:|of| IL:WINDOW IL:|with| IL:REGION)              (IL:|replace| (IL:WINDOW IL:SAVE) IL:|of| IL:WINDOW IL:|with| IL:NUSAV)              (IL:|if| IL:HIDDEN?                  IL:|then| (LET ((IL:TWICEBORDER (IL:ITIMES (IL:|fetch| (IL:WINDOW                                                                                         IL:WBORDER)                                                                    IL:|of| IL:WINDOW)                                                             2))                                      (IL:DSP (IL:|fetch| (IL:WINDOW IL:DSP) IL:|of|                                                                                        IL:WINDOW)))                                     (IL:DSPDESTINATION IL:NUSAV IL:DSP)                                     (IL:DSPCLIPPINGREGION                                      (IL:|create| IL:REGION                                         IL:|using|                                         (IL:DSPCLIPPINGREGION NIL IL:DSP)                                         IL:WIDTH IL:_ (- (IL:|fetch| (IL:REGION IL:WIDTH)                                                             IL:|of| IL:REGION)                                                          IL:TWICEBORDER)                                         IL:HEIGHT IL:_                                         (+ (- (IL:|fetch| (IL:REGION IL:HEIGHT) IL:|of|                                                                                     IL:REGION)                                               IL:TWICEBORDER)                                            (IL:|if| (IL:|fetch| (IL:WINDOW IL:WTITLE)                                                            IL:|of| IL:WINDOW)                                                IL:|then| (IL:DSPLINEFEED NIL (IL:|fetch|                                                                                   (IL:SCREEN                                                                                          IL:SCTITLEDS                                                                                          )                                                                                     IL:|of|                                                                                     IL:SCREEN))                                              IL:|else| 0)))                                      IL:DSP)                                     (IL:SHOWWFRAME IL:WINDOW))                IL:|else| (IL:ADVISEWDS IL:WINDOW IL:OLDREGION)                      (IL:SHOWWFRAME IL:WINDOW)                      (COND                         (IL:NOWOPEN? (IL:\\OPENW1 IL:WINDOW))                         (T (IL:OPENW IL:WINDOW)))))          (IL:DOUSERFNS2 (OR (IL:|fetch| (IL:WINDOW IL:RESHAPEFN) IL:|of| IL:WINDOW)                             (IL:FUNCTION IL:RESHAPEBYREPAINTFN))                 IL:WINDOW IL:SAVE (IL:|create| IL:REGION                                          IL:LEFT IL:_ IL:WBORDER                                          IL:BOTTOM IL:_ IL:WBORDER                                          IL:WIDTH IL:_ (IL:|fetch| (IL:REGION IL:WIDTH)                                                           IL:|of| IL:OLDCLIPREG)                                          IL:HEIGHT IL:_ (IL:|fetch| (IL:REGION IL:HEIGHT)                                                            IL:|of| IL:OLDCLIPREG))                 IL:OLDREGION)          (RETURN IL:WINDOW))))(\\CLOSEW1  (IL:LAMBDA (IL:WINDOW)                           (IL:* IL:\; "Edited 15-Jun-88 15:36 by drc:")    (IL:* IL:|;;|   "actually does the closing operation.  Is used by SHRINKW to avoid the CLOSEFN mechanism.")    (LET (IL:SCREEN IL:NEXTW)         (IL:|if| (WINDOW-HIDDEN? IL:WINDOW)             IL:|then| (UN-HIDE-WINDOW-INTERNAL IL:WINDOW T)                   'IL:CLOSED           IL:|else| (IL:SETQ IL:SCREEN (IL:|fetch| (IL:WINDOW IL:SCREEN) IL:|of|                                                                                         IL:WINDOW))                 (IL:.WHILE.TOP.DS. IL:WINDOW (IL:\\SW2BM (IL:|fetch| (IL:SCREEN IL:SCDESTINATION                                                                                 ) IL:|of|                                                                                          IL:SCREEN)                                                     (IL:|fetch| (IL:WINDOW IL:REG) IL:|of|                                                                                        IL:WINDOW)                                                     (IL:|fetch| (IL:WINDOW IL:SAVE) IL:|of|                                                                                         IL:WINDOW)                                                     NIL)                        (IL:SETQ IL:NEXTW (IL:|fetch| (IL:WINDOW IL:NEXTW) IL:|of| IL:WINDOW)                         )                        (IL:|replace| (IL:SCREEN IL:SCTOPW) IL:|of| IL:SCREEN IL:|with|                                                                                      IL:NEXTW)                        (IL:SETQ IL:\\TOPWDS (COND                                                (IL:NEXTW (IL:|fetch| (IL:WINDOW IL:DSP)                                                             IL:|of| IL:NEXTW))))                                                             (IL:* IL:\;                                                  "smash the window's link to other's in the chain.")                        (IL:|replace| (IL:WINDOW IL:NEXTW) IL:|of| IL:WINDOW                           IL:|with| 'IL:CLOSED))))))(MOVEW  (IL:LAMBDA (IL:WINDOW IL:|POSorX| IL:Y)          (IL:* IL:\; "Edited 15-Jun-88 15:42 by drc:")    (IL:* IL:|;;| "moves a window.  If window is closed and position is given, it won't open the window.  It also calls the window's MOVEFN property.")    (IL:SETQ IL:WINDOW (IL:\\INSUREWINDOW IL:WINDOW))    (PROG ((IL:OLDREGION (IL:|fetch| (IL:WINDOW IL:REG) IL:|of| IL:WINDOW))           (IL:USERMOVEFN (IL:|fetch| (IL:WINDOW IL:MOVEFN) IL:|of| IL:WINDOW))           (IL:OPEN? (IL:OPENWP IL:WINDOW))           IL:OLDSCREEN IL:POS IL:NEWREGION IL:OLDLEFT IL:OLDBOTTOM IL:OLDWIDTH IL:OLDHEIGHT            IL:OLDCLIPREGION IL:LFT IL:BTM IL:REG IL:FN)          (IL:SETQ IL:OLDSCREEN (IL:|fetch| (IL:WINDOW IL:SCREEN) IL:|of| IL:WINDOW))          (COND             ((COND                 ((IL:LISTP IL:USERMOVEFN)                  (IL:FMEMB 'IL:DON\'T IL:USERMOVEFN))                 (T (EQ IL:USERMOVEFN 'IL:DON\'T)))              (IL:PROMPTPRINT "This window cannot be moved.")              (RETURN)))          (COND             ((NOT (IL:SUBREGIONP IL:OLDREGION (IL:|fetch| (IL:SCREEN IL:SCREGION) IL:|of|                                                                                       IL:OLDSCREEN))                   )                                         (IL:* IL:\;                                 "use T as an indication that the window was completely off screen.")              (IL:SETQ IL:OLDCLIPREGION (OR (IL:\\ONSCREENCLIPPINGREGION IL:WINDOW)                                            T))))          (IL:SETQ IL:OLDLEFT (IL:|fetch| (IL:REGION IL:LEFT) IL:|of| IL:OLDREGION))          (IL:SETQ IL:OLDBOTTOM (IL:|ffetch| (IL:REGION IL:BOTTOM) IL:|of| IL:OLDREGION))          (IL:SETQ IL:OLDWIDTH (IL:|ffetch| (IL:REGION IL:WIDTH) IL:|of| IL:OLDREGION))          (IL:SETQ IL:OLDHEIGHT (IL:|ffetch| (IL:REGION IL:HEIGHT) IL:|of| IL:OLDREGION))          (COND             ((AND IL:|POSorX| (IL:SETQ IL:POS (COND                                                  ((IL:POSITIONP IL:|POSorX|)                                                   IL:|POSorX|)                                                  ((IL:NUMBERP IL:|POSorX|)                                                   (COND                                                      ((IL:NUMBERP IL:Y)                                                       (IL:|create| IL:POSITION                                                              IL:XCOORD IL:_ IL:|POSorX|                                                              IL:YCOORD IL:_ IL:Y))                                                      (T (IL:\\ILLEGAL.ARG IL:Y))))                                                  ((IL:REGIONP IL:|POSorX|)                                                   (IL:|create| IL:POSITION                                                          IL:XCOORD IL:_ (IL:|fetch| (IL:REGION                                                                                          IL:LEFT)                                                                            IL:|of| IL:|POSorX|)                                                          IL:YCOORD IL:_ (IL:|fetch| (IL:REGION                                                                                          IL:BOTTOM)                                                                            IL:|of| IL:|POSorX|))                                                   )                                                  (T (IL:\\ILLEGAL.ARG IL:|POSorX|)))))                                                             (IL:* IL:\;                                                            "if not aready open, don't")              (AND IL:OPEN? (IL:TOTOPW IL:WINDOW)))             (T                                              (IL:* IL:\;                                          "no position to move to has been given, ask user for one.")                (IL:TOTOPW IL:WINDOW)                        (IL:* IL:\;                                                     "TOTOPW opens the window if it is not already.")                (COND                   ((AND (IL:SETQ IL:FN (IL:WINDOWPROP IL:WINDOW 'IL:CALCULATEREGIONFN))                         (IL:SETQ IL:REG (IL:APPLY* IL:FN IL:WINDOW 'MOVEW)))                                                             (IL:* IL:\;                                             "prompt with a region that is calculated by the window")                    (IL:SETQ IL:POS (IL:GETBOXPOSITION (IL:|fetch| (IL:REGION IL:WIDTH)                                                          IL:|of| IL:REG)                                           (IL:|ffetch| (IL:REGION IL:HEIGHT) IL:|of| IL:REG)                                           (IL:SETQ IL:LFT (IL:|ffetch| (IL:REGION IL:LEFT)                                                              IL:|of| IL:REG))                                           (IL:SETQ IL:BTM (IL:|ffetch| (IL:REGION IL:BOTTOM)                                                              IL:|of| IL:REG))))                    (IL:* IL:|;;| "use a position that is offset by the same amount as the calculated region was from the window's region.")                    (IL:SETQ IL:POS (IL:|create| IL:POSITION                                           IL:XCOORD IL:_ (IL:IPLUS (IL:|fetch| (IL:POSITION                                                                                     IL:XCOORD)                                                                       IL:|of| IL:POS)                                                                 (IL:IDIFFERENCE IL:OLDLEFT IL:LFT))                                           IL:YCOORD IL:_ (IL:IPLUS (IL:|ffetch| (IL:POSITION                                                                                      IL:YCOORD)                                                                       IL:|of| IL:POS)                                                                 (IL:IDIFFERENCE IL:OLDBOTTOM IL:BTM)                                                                 ))))                   (T (IL:SETQ IL:POS (IL:GETBOXPOSITION IL:OLDWIDTH IL:OLDHEIGHT IL:OLDLEFT                                              IL:OLDBOTTOM))))                (IL:SETQ IL:OPEN? T)))          (COND             ((AND (IL:LISTP IL:USERMOVEFN)                   (NOT (IL:FMEMB (CAR IL:USERMOVEFN)                               IL:LAMBDASPLST)))              (AND (EQ (IL:|for| IL:MFN IL:|in| IL:USERMOVEFN                          IL:|do| (IL:SETQ IL:NEWREGION (IL:APPLY* IL:MFN IL:WINDOW IL:POS))                                (COND                                   ((EQ IL:NEWREGION 'IL:DON\'T)                                    (RETURN 'IL:DON\'T))                                   ((IL:POSITIONP IL:NEWREGION)                                    (IL:SETQ IL:POS IL:NEWREGION))))                       'IL:DON\'T)                   (RETURN)))             (IL:USERMOVEFN (IL:SETQ IL:NEWREGION (IL:APPLY* IL:USERMOVEFN IL:WINDOW IL:POS))                    (COND                       ((EQ IL:NEWREGION 'IL:DON\'T)                        (RETURN))                       ((IL:POSITIONP IL:NEWREGION)                        (IL:SETQ IL:POS IL:NEWREGION)))))          (COND             ((OR (NOT (EQ (IL:|fetch| (IL:POSITION IL:XCOORD) IL:|of| IL:POS)                           IL:OLDLEFT))                  (NOT (EQ (IL:|ffetch| (IL:POSITION IL:YCOORD) IL:|of| IL:POS)                           IL:OLDBOTTOM)))              (IL:SETQ IL:NEWREGION (IL:|create| IL:REGION                                           IL:LEFT IL:_ (IL:|ffetch| (IL:POSITION IL:XCOORD)                                                           IL:|of| IL:POS)                                           IL:BOTTOM IL:_ (IL:|ffetch| (IL:POSITION IL:YCOORD)                                                             IL:|of| IL:POS)                                           IL:WIDTH IL:_ IL:OLDWIDTH                                           IL:HEIGHT IL:_ IL:OLDHEIGHT))              (IL:|if| (WINDOW-HIDDEN? IL:WINDOW)                  IL:|then|                         (IL:* IL:|;;| "just update region")                        (IL:|replace| (IL:WINDOW IL:REG) IL:|of| IL:WINDOW IL:|with|                                                                                   IL:NEWREGION)                IL:|else| (IL:UNINTERRUPTABLY                                  (COND                                     (IL:OPEN?                                             (IL:* IL:|;;| "if window is open, move it to top as its MOVEFN may have changed things and swap its bits to its new location")                                            (IL:.WHILE.TOP.DS. IL:WINDOW (IL:\\SW2BM                                                                          (IL:|fetch|                                                                           (IL:SCREEN                                                                                   IL:SCDESTINATION)                                                                             IL:|of| IL:OLDSCREEN                                                                           )                                                                          IL:OLDREGION                                                                          (IL:|fetch|                                                                           (IL:WINDOW IL:SAVE)                                                                             IL:|of| IL:WINDOW)                                                                          NIL)                                                   (IL:\\SW2BM (IL:|ffetch| (IL:WINDOW IL:SAVE)                                                                  IL:|of| IL:WINDOW)                                                          NIL                                                          (IL:|ffetch| (IL:SCREEN                                                                                   IL:SCDESTINATION)                                                             IL:|of| IL:OLDSCREEN)                                                          IL:NEWREGION))))                                  (IL:|replace| (IL:WINDOW IL:REG) IL:|of| IL:WINDOW                                     IL:|with| IL:NEWREGION)                                  (IL:ADVISEWDS IL:WINDOW IL:OLDREGION T)))              (COND                 ((AND IL:OPEN? (IL:WINDOWPROP IL:WINDOW 'IL:REPAINTFN)                       IL:OLDCLIPREGION)                     (IL:* IL:\;                                                   "redisplay those parts that were off the screen.")                  (COND                     ((EQ IL:OLDCLIPREGION T)                (IL:* IL:\; "whole window was off.")                      (IL:REDISPLAYW IL:WINDOW NIL T))                     (T (PROG (IL:NEWCLIPPINGREGION IL:NCL IL:OCL IL:NCB IL:OCB IL:OCR IL:NCR IL:OCW                                     IL:NCW IL:OCH IL:NCH IL:OCT IL:NCT)                              (IL:SETQ IL:NEWCLIPPINGREGION (IL:\\ONSCREENCLIPPINGREGION IL:WINDOW))                                                             (IL:* IL:\;                                                "the title may be the only thing now on the screen.")                              (OR IL:NEWCLIPPINGREGION (RETURN))                              (IL:SETQ IL:NCB (IL:|fetch| (IL:REGION IL:BOTTOM) IL:|of|                                                                                                                                                                     IL:NEWCLIPPINGREGION                                                     ))                              (IL:SETQ IL:OCB (IL:|fetch| (IL:REGION IL:BOTTOM) IL:|of|                                                                                    IL:OLDCLIPREGION)                               )                              (IL:SETQ IL:OCW (IL:|ffetch| (IL:REGION IL:WIDTH) IL:|of|                                                                                    IL:OLDCLIPREGION)                               )                              (IL:SETQ IL:NCW (IL:|ffetch| (IL:REGION IL:WIDTH) IL:|of|                                                                                                                                                                     IL:NEWCLIPPINGREGION                                                     ))                              (IL:SETQ IL:OCH (IL:|ffetch| (IL:REGION IL:HEIGHT) IL:|of|                                                                                     IL:OLDCLIPREGION                                                     ))                              (IL:SETQ IL:NCH (IL:|ffetch| (IL:REGION IL:HEIGHT) IL:|of|                                                                                                                                                                      IL:NEWCLIPPINGREGION                                                     ))                              (COND                                 ((IL:ILESSP (IL:SETQ IL:NCL (IL:|ffetch| (IL:REGION IL:LEFT)                                                                IL:|of| IL:NEWCLIPPINGREGION))                                         (IL:SETQ IL:OCL (IL:|ffetch| (IL:REGION IL:LEFT)                                                            IL:|of| IL:OLDCLIPREGION)))                                  (IL:REDISPLAYW IL:WINDOW (IL:CREATEREGION IL:NCL IL:OCB                                                                  (IL:IDIFFERENCE IL:OCL IL:NCL)                                                                  IL:OCH))))                              (COND                                 ((IL:ILESSP (IL:SETQ IL:OCR (IL:IPLUS IL:OCL IL:OCW))                                         (IL:SETQ IL:NCR (IL:IPLUS IL:NCL IL:NCW)))                                                             (IL:* IL:\;                                                            "some stuff appeared from the right.")                                  (IL:REDISPLAYW IL:WINDOW (IL:CREATEREGION IL:OCR IL:OCB                                                                  (IL:IDIFFERENCE IL:NCR IL:OCR)                                                                  IL:OCH))))                              (COND                                 ((IL:ILESSP IL:NCB IL:OCB)                                  (IL:REDISPLAYW IL:WINDOW (IL:CREATEREGION IL:NCL IL:NCB IL:NCW                                                                  (IL:IDIFFERENCE IL:OCB IL:NCB)))))                              (COND                                 ((IL:ILESSP (IL:SETQ IL:OCT (IL:IPLUS IL:OCB IL:OCH))                                         (IL:SETQ IL:NCT (IL:IPLUS IL:NCB IL:NCH)))                                                             (IL:* IL:\;                                                            "some stuff appeared from the top")                                  (IL:REDISPLAYW IL:WINDOW (IL:CREATEREGION IL:NCL IL:OCT IL:NCW                                                                  (IL:IDIFFERENCE IL:NCT IL:OCT)))))                              (COND                                 ((IL:IGREATERP (IL:IPLUS IL:OLDBOTTOM IL:OLDHEIGHT)                                         (IL:|fetch| (IL:SCREEN IL:SCHEIGHT) IL:|of|                                                                                        IL:OLDSCREEN))                                                             (IL:* IL:\;                                        "should reshow the title but don't have any entry for that.")                                  NIL)))))))              (IL:DOUSERFNS (IL:WINDOWPROP IL:WINDOW 'IL:AFTERMOVEFN)                     IL:WINDOW)))          (RETURN IL:POS))))(\\INTERNALTOTOPW  (IL:LAMBDA (IL:W1 IL:RPT)                        (IL:* IL:\; "Edited 15-Jun-88 14:50 by drc:")    (PROG (IL:SCREEN IL:SCREENTOPW)          (IL:SETQ IL:W1 (IL:\\INSUREWINDOW IL:W1))          (IL:SETQ IL:SCREEN (IL:|fetch| (IL:WINDOW IL:SCREEN) IL:|of| IL:W1))          (IL:SETQ IL:SCREENTOPW (IL:|fetch| (IL:SCREEN IL:SCTOPW) IL:|of| IL:SCREEN))          (OR (EQ IL:W1 IL:SCREENTOPW)              (WINDOW-HIDDEN? IL:W1)              (COND                 ((NULL IL:SCREENTOPW)                       (IL:* IL:\;                                                            "all windows are closed open this one.")                  (IL:OPENW IL:W1))                 (T (IL:UNINTERRUPTABLY                        (IL:\\TTW1 IL:W1 IL:SCREENTOPW)                        (IL:* IL:|;;| "N.B.  \\TTW1 can side effect the screen")                        (COND                           ((EQ IL:W1 (IL:|fetch| (IL:SCREEN IL:SCTOPW) IL:|of| IL:SCREEN)))                           ((NOT IL:RPT)                     (IL:* IL:\;                   "GC msgs or other glitches can cause W1 not to make it.  Check and try ONCE more")                            (\\INTERNALTOTOPW IL:W1 T))))))))))(WFROMMENU  (IL:LAMBDA (IL:MENU)                             (IL:* IL:\; "Edited 15-Jun-88 19:19 by drc:")(IL:* IL:|;;;| "finds the window that menu is in if any.")    (BLOCK WFROMMENU        (DOLIST (IL:WINDOW (ALL-WINDOWS T))            (LABELS ((IL:SEARCH-ATTACHED-WINDOWS (IL:WINDOW)                            (WHEN (IL:FMEMB IL:MENU (IL:WINDOWPROP IL:WINDOW 'IL:MENU))                                  (RETURN-FROM WFROMMENU IL:WINDOW))                            (DOLIST (IL:WINDOW (IL:WINDOWPROP IL:WINDOW 'IL:ATTACHEDWINDOWS))                                (IL:SEARCH-ATTACHED-WINDOWS IL:WINDOW))))                   (IL:SEARCH-ATTACHED-WINDOWS IL:WINDOW))))))(RESHOWTITLE  (IL:LAMBDA (IL:TITLE IL:WINDOW IL:JUSTDISPLAYFLG)(IL:* IL:\; "Edited 15-Jun-88 18:57 by drc:")    (IL:* IL:|;;| "updates a windows display with a new title")    (PROG* ((IL:WREG (IL:|fetch| (IL:WINDOW IL:REG) IL:|of| IL:WINDOW))            (IL:TITLEDS (IL:|fetch| (IL:SCREEN IL:SCTITLEDS) IL:|of| (IL:|fetch|                                                                              (IL:WINDOW IL:SCREEN)                                                                                IL:|of| IL:WINDOW                                                                              )))            (IL:TITLEHEIGHT (IL:IMINUS (IL:DSPLINEFEED NIL IL:TITLEDS)))            (IL:OLDTITLE (IL:|fetch| (IL:WINDOW IL:WTITLE) IL:|of| IL:WINDOW))            (IL:BORDER (IL:|fetch| (IL:WINDOW IL:WBORDER) IL:|of| IL:WINDOW))            IL:BM IL:BMBTM IL:HGHT)           (COND              (IL:JUSTDISPLAYFLG)              ((EQ IL:TITLE (IL:|fetch| (IL:WINDOW IL:WTITLE) IL:|of| IL:WINDOW))               (RETURN))              (T (IL:|replace| (IL:WINDOW IL:WTITLE) IL:|of| IL:WINDOW IL:|with| IL:TITLE                        )                 (COND                    ((OR (NULL IL:OLDTITLE)                         (NULL IL:TITLE)                         (IL:NEQ IL:TITLEHEIGHT (IL:IDIFFERENCE                                                 (IL:|fetch| (IL:REGION IL:HEIGHT) IL:|of|                                                                                       IL:WREG)                                                 (IL:IPLUS (IL:|fetch| (IL:REGION IL:HEIGHT)                                                              IL:|of| (IL:DSPCLIPPINGREGION                                                                           NIL                                                                           (IL:|fetch|                                                                            (IL:WINDOW IL:DSP)                                                                              IL:|of| IL:WINDOW))                                                                  )                                                        (IL:ITIMES 2 IL:BORDER)))))                                                             (IL:* IL:\;                                                        "Previously no title, so make space for one")                                                             (IL:* IL:\; "Have to remove title")                                                             (IL:* IL:\; "or title height changed.")                                                             (IL:* IL:\;                                            "so windows region on the screen has to be made larger.")                     (IL:\\RESHOWBORDER1 (IL:|fetch| (IL:WINDOW IL:WBORDER) IL:|of| IL:WINDOW                                                )                            (IL:|fetch| (IL:WINDOW IL:WBORDER) IL:|of| IL:WINDOW)                            IL:WINDOW)                     (RETURN)))))                            (IL:* IL:\;              "code from here is to reprint the title in place to avoid creating any large bitmaps.")           (IL:SETQ IL:BM (IL:BITMAPCREATE (IL:|fetch| (IL:REGION IL:WIDTH) IL:|of| IL:WREG)                                 (IL:SETQ IL:TITLEHEIGHT (IL:ADD1 IL:TITLEHEIGHT))                                 (IL:BITSPERPIXEL (IL:|fetch| (IL:SCREEN IL:SCDESTINATION)                                                     IL:|of| (IL:|fetch| (IL:WINDOW IL:SCREEN                                                                                        )                                                                    IL:|of| IL:WINDOW)))))           (IL:BITBLT NIL NIL NIL IL:BM 0 0 NIL NIL 'IL:TEXTURE 'IL:REPLACE IL:BLACKSHADE)                                                             (IL:* IL:\;                          "use SHOWWTITLE to put the image of the title into the auxilliary bitmap.")           (IL:SHOWWTITLE IL:TITLE IL:BM IL:BORDER NIL IL:WINDOW)           (COND              ((IL:IGREATERP IL:TITLEHEIGHT (IL:SETQ IL:HGHT (IL:|fetch| (IL:REGION IL:HEIGHT)                                                                IL:|of| IL:WREG)))               (IL:SETQ IL:BMBTM (IL:IDIFFERENCE (IL:SUB1 IL:TITLEHEIGHT)                                        IL:HGHT))))           (LET ((IL:HIDDEN? (WINDOW-HIDDEN? IL:WINDOW)))                (IL:UNINTERRUPTABLY                    (IL:TOTOPW IL:WINDOW)                    (IL:BITBLT IL:BM 0 (COND                                          (IL:BMBTM)                                          ((IL:IGREATERP IL:BORDER 0)                                           (IL:* IL:|;;| "if there is a border, the title was printed in the scratch bitmap so to leave one point of the border on top")                                           0)                                          (T 1))                           (IL:DSPDESTINATION NIL IL:WINDOW)                           (IL:|if| IL:HIDDEN?                               IL:|then| 0                             IL:|else| (IL:|fetch| (IL:REGION IL:LEFT) IL:|of| IL:WREG))                           (IL:IDIFFERENCE (IL:|if| IL:HIDDEN?                                               IL:|then| (IL:|fetch| (IL:REGION IL:HEIGHT)                                                                IL:|of| IL:WREG)                                             IL:|else| (IL:|fetch| (IL:REGION IL:PTOP)                                                              IL:|of| IL:WREG))                                  (COND                                     (IL:BMBTM IL:HGHT)                                     (T (IL:IPLUS IL:TITLEHEIGHT (COND                                                                    ((IL:IGREATERP IL:BORDER 0)                                             (IL:* IL:|;;| "if there is a border, the title was printed in the scratch bitmap so to leave one point of the border on top")                                                                     0)                                                                    (T -1))))))                           NIL                           (COND                              (IL:BMBTM IL:HGHT))))))))(\\RESHOWBORDER1  (IL:LAMBDA (IL:NEWBORDER IL:OLDBORDER IL:WINDOW) (IL:* IL:\; "Edited 15-Jun-88 19:05 by drc:")    (IL:* IL:|;;| "redisplays the border of a window.  Is called by RESHOWBORDER and RESHOWTITLE.  It doesn't check for equality between the new and old borders because it is also used when a title is added or deleted.")    (PROG ((IL:REGION (IL:|fetch| (IL:WINDOW IL:REG) IL:|of| IL:WINDOW))           (IL:OLDSAVE (IL:|fetch| (IL:WINDOW IL:SAVE) IL:|of| IL:WINDOW))           IL:NUSAV IL:DELTA IL:NUWIDTH IL:NUHEIGHT IL:HIDDEN?)          (IL:SETQ IL:DELTA (IL:IDIFFERENCE IL:NEWBORDER IL:OLDBORDER))          (IL:SETQ IL:NUWIDTH (IL:IPLUS (IL:|fetch| (IL:REGION IL:WIDTH) IL:|of| IL:REGION)                                     (IL:ITIMES IL:DELTA 2)))          (IL:SETQ IL:NUHEIGHT (IL:IDIFFERENCE (IL:IPLUS (IL:|fetch| (IL:REGION IL:HEIGHT)                                                            IL:|of| (IL:DSPCLIPPINGREGION                                                                         NIL                                                                         (IL:|fetch| (IL:WINDOW                                                                                          IL:DSP)                                                                            IL:|of| IL:WINDOW)))                                                      (IL:ITIMES IL:NEWBORDER 2))                                      (COND                                         ((IL:|fetch| (IL:WINDOW IL:WTITLE) IL:|of| IL:WINDOW                                                 )                                          (IL:DSPLINEFEED NIL (IL:|fetch| (IL:SCREEN IL:SCTITLEDS                                                                                     )                                                                 IL:|of| (IL:|fetch|                                                                              (IL:WINDOW IL:SCREEN)                                                                                IL:|of| IL:WINDOW                                                                              ))))                                         (T 0))))          (IL:SETQ IL:NUSAV (IL:BITMAPCREATE IL:NUWIDTH IL:NUHEIGHT (IL:|fetch| (IL:BITMAP                                                                                 IL:BITMAPBITSPERPIXEL                                                                                           )                                                                       IL:|of| IL:OLDSAVE)))          (IL:SETQ IL:HIDDEN? (WINDOW-HIDDEN? IL:WINDOW))          (IL:.WHILE.TOP.DS. IL:WINDOW                       (IL:* IL:\; "Save window image")                 (OR IL:HIDDEN? (IL:\\SW2BM (IL:|fetch| (IL:SCREEN IL:SCDESTINATION)                                               IL:|of| (IL:|fetch| (IL:WINDOW IL:SCREEN)                                                              IL:|of| IL:WINDOW))                                       IL:REGION                                       (IL:|fetch| (IL:WINDOW IL:SAVE) IL:|of| IL:WINDOW)                                       NIL))                 (IL:* IL:\;                                                            "put new save image into window")                 (IL:|replace| (IL:WINDOW IL:SAVE) IL:|of| IL:WINDOW IL:|with| IL:NUSAV)                 (IL:|if| IL:HIDDEN?                     IL:|then| (IL:DSPDESTINATION IL:NUSAV IL:WINDOW))                 (IL:|replace| (IL:WINDOW IL:WBORDER) IL:|of| IL:WINDOW IL:|with|                                                                                       IL:NEWBORDER)                 (IL:|if| IL:HIDDEN?                     IL:|then|                            (IL:* IL:|;;| "re-adjust X & Y offset")                           (IL:DSPXOFFSET IL:NEWBORDER IL:WINDOW)                           (IL:DSPYOFFSET IL:NEWBORDER IL:WINDOW))                                                             (IL:* IL:\;                            "create a region that coresponds to the old region with the new border.")                 (IL:|replace| (IL:WINDOW IL:REG) IL:|of| IL:WINDOW                    IL:|with| (IL:|create| IL:REGION                                         IL:LEFT IL:_ (IL:IDIFFERENCE (IL:|fetch| (IL:REGION                                                                                       IL:LEFT)                                                                         IL:|of| IL:REGION)                                                             IL:DELTA)                                         IL:BOTTOM IL:_ (IL:IDIFFERENCE (IL:|fetch| (IL:REGION                                                                                         IL:BOTTOM)                                                                           IL:|of| IL:REGION)                                                               IL:DELTA)                                         IL:WIDTH IL:_ IL:NUWIDTH                                         IL:HEIGHT IL:_ IL:NUHEIGHT))                 (IL:UPDATE/SCROLL/REG IL:WINDOW)            (IL:* IL:\;                                                            "draw border in the new image.")                 (IL:SHOWWFRAME IL:WINDOW)                   (IL:* IL:\;                                        "copy the visible part from the old image into the new one.")                 (IL:BITBLT IL:OLDSAVE IL:OLDBORDER IL:OLDBORDER IL:NUSAV IL:NEWBORDER IL:NEWBORDER                        (IL:IDIFFERENCE (IL:|fetch| (IL:BITMAP IL:BITMAPWIDTH) IL:|of|                                                                                          IL:OLDSAVE)                               (IL:ITIMES 2 IL:OLDBORDER))                        (IL:|fetch| (IL:REGION IL:HEIGHT) IL:|of| (IL:DSPCLIPPINGREGION                                                                           NIL                                                                           (IL:|fetch|                                                                            (IL:WINDOW IL:DSP)                                                                              IL:|of| IL:WINDOW))                               )                        'IL:INPUT                        'IL:REPLACE)                         (IL:* IL:\;                                                            "put the new image up on the screen.")                 (OR IL:HIDDEN? (IL:\\SW2BM (IL:|fetch| (IL:SCREEN IL:SCDESTINATION)                                               IL:|of| (IL:|fetch| (IL:WINDOW IL:SCREEN)                                                              IL:|of| IL:WINDOW))                                       (IL:|fetch| (IL:WINDOW IL:REG) IL:|of| IL:WINDOW)                                       (IL:|fetch| (IL:WINDOW IL:SAVE) IL:|of| IL:WINDOW)                                       NIL))))))(TTYIN.SETUP  (IL:LAMBDA NIL                                   (IL:* IL:\; "Edited 16-Jun-88 11:37 by drc:")                                                             (IL:* IL:\;                                                            "Disable buttons so we can do selection")    (LET ((IL:WINDOW (IL:WFROMDS IL:\\DSP T)))         (COND            (IL:WINDOW (IL:|replace| (IL:TTYINBUFFER IL:TTOLDRIGHTFN) IL:|of| IL:\\TTYINSTATE                          IL:|with| (IL:WINDOWPROP IL:WINDOW 'IL:RIGHTBUTTONFN 'IL:TOTOPW))                   (IL:|replace| (IL:TTYINBUFFER IL:TTOLDBUTTONFN) IL:|of| IL:\\TTYINSTATE                      IL:|with| (IL:WINDOWPROP IL:WINDOW 'IL:BUTTONEVENTFN 'IL:TOTOPW))                   (IL:|replace| (IL:TTYINBUFFER IL:TTOLDENTRYFN) IL:|of| IL:\\TTYINSTATE                      IL:|with| (IL:WINDOWPROP IL:WINDOW 'IL:WINDOWENTRYFN 'IL:TTYINENTRYFN))                   (IL:|replace| (IL:TTYINBUFFER IL:TTYINWINDOW) IL:|of| IL:\\TTYINSTATE                      IL:|with| IL:WINDOW)                   (IL:WINDOWPROP IL:WINDOW 'IL:TTYINSTATE (IL:|fetch| (IL:TTYINBUFFER                                                                                   IL:TTYINWINDOWSTATE                                                                                  ) IL:|of|                                                                                    IL:\\TTYINSTATE))                   (IL:RESETSAVE NIL (LIST (IL:FUNCTION IL:TTYIN.CLEANUP)                                           IL:\\TTYINSTATE))))         (COND            ((OR (IL:IMAGESTREAMTYPEP IL:\\DSP 'IL:TEXT)                 (IL:FMEMB (IL:DSPDESTINATION NIL IL:\\DSP)                        IL:\\SCREENBITMAPS)                 (AND IL:WINDOW (WINDOW-HIDDEN? IL:WINDOW)))             (IL:SETQ IL:\\CHARWIDTH (IL:CHARWIDTH (IL:CHARCODE IL:A)                                            IL:\\DSP))             (IL:SETQ IL:\\FONT (IL:DSPFONT NIL IL:\\DSP))             (IL:|if| (EQ IL:\\FONT IL:\\TTYIN.LAST.FONT)                 IL:|then| (IL:SETQ IL:\\COMMENTFONT IL:\\TTYIN.LAST.COMMENTFONT)               IL:|elseif| IL:\\READING                 IL:|then|                               (IL:* IL:\;                                                            "Want a \"comment\" font for ?=")                       (IL:SETQ IL:\\COMMENTFONT (IL:SETQ IL:\\TTYIN.LAST.COMMENTFONT                                                  (IL:FONTCOPY IL:\\FONT 'IL:WEIGHT                                                         (IL:SELECTQ (IL:FONTPROP IL:\\FONT                                                                            'IL:WEIGHT)                                                               (IL:BOLD 'IL:MEDIUM)                                                               'IL:BOLD))))                       (IL:SETQ IL:\\TTYIN.LAST.FONT IL:\\FONT)               IL:|else| (IL:SETQ IL:\\COMMENTFONT IL:\\FONT))             (IL:SETQ IL:\\CHARHEIGHT (MAX (IL:FONTHEIGHT IL:\\FONT)                                           (IL:FONTHEIGHT IL:\\COMMENTFONT)))             (IL:SETQ IL:\\DESCENT (IL:FONTPROP IL:\\FONT 'IL:DESCENT))                                                             (IL:* IL:\;                                                 "How many pixels below the baseline this font goes")             (IL:SETQ IL:\\TEXTURE (IL:DSPTEXTURE NIL IL:\\DSP))             (IL:SETQ IL:\\TTPAGELENGTH (IL:PAGEHEIGHT NIL IL:\\DSP))             (IL:SETQ IL:\\LMARG (IL:DSPLEFTMARGIN NIL IL:\\DSP))                                                             (IL:* IL:\; "bit pos of left margin")             (IL:SETQ IL:\\RMARG (IL:DSPRIGHTMARGIN NIL IL:\\DSP))                                                             (IL:* IL:\;                                                            "bit pos of right margin, dsp relative")             (IL:SETQ IL:\\INITPOS (IL:DSPXPOSITION NIL IL:\\DSP))))))))(IL:DECLARE\: IL:DOEVAL@COMPILE IL:DONTCOPY(IL:GLOBALVARS IL:LAMBDASPLST IL:\\EM.DISPINTERRUPT IL:\\SCREENBITMAPS IL:\\TTYIN.LAST.FONT        IL:\\TTYIN.LAST.COMMENTFONT))(EVAL-WHEN (LOAD)(IL:MOVD 'SHAPEW1 'IL:SHAPEW1)(IL:MOVD '\\CLOSEW1 'IL:\\CLOSEW1)(IL:MOVD 'MOVEW 'IL:MOVEW)(IL:MOVD '\\INTERNALTOTOPW 'IL:\\INTERNALTOTOPW)(IL:MOVD 'WFROMMENU 'IL:WFROMMENU)(IL:MOVD 'RESHOWTITLE 'IL:RESHOWTITLE)(IL:MOVD '\\RESHOWBORDER1 'IL:\\RESHOWBORDER1)(IL:MOVD 'TTYIN.SETUP 'IL:TTYIN.SETUP))(REINSTALL-ADVICE 'IL:ATTACHWINDOW :AFTER '((:LAST (WHEN (AND (WINDOW-HIDDEN? (IL:INSURE.WINDOW                                                                                   IL:MAINWINDOW))                                                              (NOT (WINDOW-HIDDEN? (                                                                                     IL:INSURE.WINDOW                                                                                                                                                                            IL:WINDOWTOATTACH                                                                                        ))))                                                         (HIDE-WINDOW-INTERNAL IL:WINDOWTOATTACH)                                                         ))))(IL:READVISE IL:ATTACHWINDOW)(IL:PUTPROPS IL:RMSHIDER IL:COPYRIGHT ("Venue" 1993))(IL:DECLARE\: IL:DONTCOPY  (IL:FILEMAP (NIL (8923 53190 (SHAPEW1 8936 . 14646) (\\CLOSEW1 14648 . 16904) (MOVEW 16906 . 33322) (\\INTERNALTOTOPW 33324 . 34603) (WFROMMENU 34605 . 35307) (RESHOWTITLE 35309 . 41863) (\\RESHOWBORDER1 41865 . 49102) (TTYIN.SETUP 49104 . 53188)))))IL:STOP