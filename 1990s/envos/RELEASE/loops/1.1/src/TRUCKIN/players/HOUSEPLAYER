(DEFINE-FILE-INFO PACKAGE "IL" READTABLE "INTERLISP" BASE 10)(FILECREATED "18-Jul-88 19:11:56" |{POGO:AISNORTH:XEROX}<LOOPSCORE>TRUCKIN>PLAYERS>HOUSEPLAYER.;3| 113914       changes to%:  (METHODS HousePlanner.UnionHall HousePlayer.RateGasStations                            HousePlayer.RateConsumers HousePlayer.RateProducers HousePlayer.TakeTurn                            HousePlayer.SellGoods HousePlayer.RateSpotsNearAlices                            HousePlayer.MaxPurchase HousePlayer.GoToStoppingPlace                            HousePlayer.FindStoppingPlace HousePlanner.TakeTurn HousePlanner.SetGoal                            HousePlanner.RateProducers HousePlanner.RateGasStations                            HousePlanner.RateConsumers HousePlanner.GoToStoppingPlace                            HousePlanner.FindStoppingPlace)                    (VARS HOUSEPLAYERCOMS)                    (CLASSES HousePlayer HousePlanner)      previous date%: "15-Jul-88 16:09:26" |{POGO:AISNORTH:XEROX}<LOOPSCORE>TRUCKIN>PLAYERS>HOUSEPLAYER.;2|)(* "Copyright (c) 1987, 1988 by Xerox Corporation.  All rights reserved.")(PRETTYCOMPRINT HOUSEPLAYERCOMS)(RPAQQ HOUSEPLAYERCOMS        ((DECLARE%: DONTCOPY (PROP MAKEFILE-ENVIRONMENT HOUSEPLAYER))        (INSTANCES)        (CLASSES HousePlanner HousePlayer)        (FNS)        (METHODS HousePlanner.FindStoppingPlace HousePlanner.GoToStoppingPlace                HousePlanner.RateConsumers HousePlanner.RateGasStations HousePlanner.RateProducers                HousePlanner.SetGoal HousePlanner.TakeTurn HousePlanner.UnionHall                HousePlayer.FindStoppingPlace HousePlayer.GoToStoppingPlace HousePlayer.MaxPurchase                HousePlayer.RateConsumers HousePlayer.RateGasStations HousePlayer.RateProducers                HousePlayer.RateSpotsNearAlices HousePlayer.SellGoods HousePlayer.TakeTurn)))(DECLARE%: DONTCOPY (PUTPROPS HOUSEPLAYER MAKEFILE-ENVIRONMENT (:PACKAGE "IL" :READTABLE "INTERLISP" :BASE 10)))(DEFCLASSES HousePlanner HousePlayer)(DEFCLASS HousePlanner   (MetaClass PlayerMeta Edited%:                            (* sm%: "26-JUL-83 14:19"))   (Supers Planner)   (InstanceVariables (horizon 0 doc "how far to look in deciding on stopping place")))(DEFCLASS HousePlayer   (MetaClass PlayerMeta Edited%:                            (* sm%: "26-JUL-83 13:23"))   (Supers Traveler)   (InstanceVariables (goal Peddle)          (destination NIL doc "Current destination.")          (direction NIL doc "Forward or Backward direction of travel on the highway.")          (alices NIL doc "Instance of Alices chosen for end game.")          (cashReserve 1000 doc "Minimum cash to keep on hand.")))(\BatchMethodDefs)(METH HousePlanner  FindStoppingPlace NIL      "Method implementing a RuleSet" (method HousePlanner.FindStoppingPlace RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 611)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 611))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 731)))            (name #,($A HousePlanner.FindStoppingPlace NIL RememberName))            (compiledRules HousePlanner.FindStoppingPlace)            (workSpace HousePlanner)            (tempVars (wStation gasStation has roughRd))            (taskVars NIL)            (debugVars NIL)            (numRules 6)            (controlStructure DO1)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlanner  GoToStoppingPlace NIL      "Method implementing a RuleSet" (method HousePlanner.GoToStoppingPlace RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 618)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 618))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 732)))            (name #,($A HousePlanner.GoToStoppingPlace NIL RememberName))            (compiledRules HousePlanner.GoToStoppingPlace)            (workSpace HousePlanner)            (tempVars NIL)            (taskVars NIL)            (debugVars NIL)            (numRules 3)            (controlStructure DO1)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlanner  RateConsumers (rs)      "Method implementing a RuleSet" (method HousePlanner.RateConsumers RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 619)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 619))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 733)))            (name #,($A HousePlanner.RateConsumers NIL RememberName))            (compiledRules HousePlanner.RateConsumers)            (workSpace HousePlanner)            (tempVars (rating cargo))            (taskVars NIL)            (debugVars NIL)            (numRules 6)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlanner  RateGasStations (rs)      "Method implementing a RuleSet" (method HousePlanner.RateGasStations RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 620)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 620))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 734)))            (name #,($A HousePlanner.RateGasStations NIL RememberName))            (compiledRules HousePlanner.RateGasStations)            (workSpace HousePlanner)            (tempVars (rating))            (taskVars NIL)            (debugVars NIL)            (numRules 6)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlanner  RateProducers (rs)      "Method implementing a RuleSet" (method HousePlanner.RateProducers RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 621))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 735)))            (name #,($A HousePlanner.RateProducers NIL RememberName))            (compiledRules HousePlanner.RateProducers)            (workSpace HousePlanner)            (tempVars (rating maxBuy))            (taskVars NIL)            (debugVars NIL)            (numRules 10)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions NIL)            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlanner  SetGoal NIL      "Method implementing a RuleSet" (method HousePlanner.SetGoal RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 622))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 736)))            (name #,($A HousePlanner.SetGoal NIL RememberName))            (compiledRules HousePlanner.SetGoal)            (workSpace HousePlanner)            (tempVars NIL)            (taskVars NIL)            (debugVars NIL)            (numRules 10)            (controlStructure DO1)            (whileCondition NIL)            (compilerOptions NIL)            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlanner  TakeTurn NIL      "Method implementing a RuleSet" (method HousePlanner.TakeTurn RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 623)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 623))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 737)))            (name #,($A HousePlanner.TakeTurn NIL RememberName))            (compiledRules HousePlanner.TakeTurn)            (workSpace HousePlanner)            (tempVars (possibleStops))            (taskVars NIL)            (debugVars NIL)            (numRules 5)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlanner  UnionHall NIL      "Method implementing a RuleSet" (method HousePlanner.UnionHall RuleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 16)) methodClass RuleSet UID (LRX0.%:F5.o28.dL@ . 16))            (perspectiveNode #,($& RuleSetNode (LRX0.%:F5.o28.dL@ . 20)))            (name #,($A HousePlanner.UnionHall NIL RememberName))            (compiledRules HousePlanner.UnionHall)            (workSpace HousePlanner)            (tempVars NIL)            (taskVars NIL)            (debugVars NIL)            (numRules 1)            (controlStructure DO1)            (whileCondition NIL)            (compilerOptions NIL)            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlayer  FindStoppingPlace NIL      "Method implementing a RuleSet" (method HousePlayer.FindStoppingPlace RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 625)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 625))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 738)))            (name #,($A HousePlayer.FindStoppingPlace NIL RememberName))            (compiledRules HousePlayer.FindStoppingPlace)            (workSpace HousePlayer)            (tempVars (wStation gasStation))            (taskVars NIL)            (debugVars NIL)            (numRules 5)            (controlStructure DO1)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlayer  GoToStoppingPlace NIL      "Method implementing a RuleSet" (method HousePlayer.GoToStoppingPlace RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 631))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 739)))            (name #,($A HousePlayer.GoToStoppingPlace NIL RememberName))            (compiledRules HousePlayer.GoToStoppingPlace)            (workSpace HousePlayer)            (tempVars (realLocation numBuy))            (taskVars NIL)            (debugVars NIL)            (numRules 8)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlayer  MaxPurchase (roadStop)      "Method implementing a RuleSet" (method HousePlayer.MaxPurchase RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 635)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 635))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 740)))            (name #,($A HousePlayer.MaxPurchase NIL RememberName))            (compiledRules HousePlayer.MaxPurchase)            (workSpace HousePlayer)            (tempVars (volumeCapacity weightCapacity volumeLimit weightLimit cashLimit producerLimit                              numBuy cashCapacity))            (taskVars NIL)            (debugVars NIL)            (numRules 3)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlayer  RateConsumers (rs)      "Method implementing a RuleSet" (method HousePlayer.RateConsumers RuleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14)) methodClass RuleSet UID (LRX0.%:F5.o28.dL@ . 14))            (perspectiveNode #,($& RuleSetNode (LRX0.%:F5.o28.dL@ . 21)))            (name #,($A HousePlayer.RateConsumers NIL RememberName))            (compiledRules HousePlayer.RateConsumers)            (workSpace HousePlayer)            (tempVars (rating cargo))            (taskVars NIL)            (debugVars NIL)            (numRules 9)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlayer  RateGasStations (rs)      "Method implementing a RuleSet" (method HousePlayer.RateGasStations RuleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 15)) methodClass RuleSet UID (LRX0.%:F5.o28.dL@ . 15))            (perspectiveNode #,($& RuleSetNode (LRX0.%:F5.o28.dL@ . 22)))            (name #,($A HousePlayer.RateGasStations NIL RememberName))            (compiledRules HousePlayer.RateGasStations)            (workSpace HousePlayer)            (tempVars (rating))            (taskVars NIL)            (debugVars NIL)            (numRules 6)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlayer  RateProducers (rs)      "Method implementing a RuleSet" (method HousePlayer.RateProducers RuleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13)) methodClass RuleSet UID (LRX0.%:F5.o28.dL@ . 13))            (perspectiveNode #,($& RuleSetNode (LRX0.%:F5.o28.dL@ . 23)))            (name #,($A HousePlayer.RateProducers NIL RememberName))            (compiledRules HousePlayer.RateProducers)            (workSpace HousePlayer)            (tempVars (rating maxBuy))            (taskVars NIL)            (debugVars NIL)            (numRules 12)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions NIL)            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlayer  RateSpotsNearAlices (roadStop)      "Method implementing a RuleSet" (method HousePlayer.RateSpotsNearAlices RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 636)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 636))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 741)))            (name #,($A HousePlayer.RateSpotsNearAlices NIL RememberName))            (compiledRules HousePlayer.RateSpotsNearAlices)            (workSpace HousePlayer)            (tempVars (rating cargo))            (taskVars NIL)            (debugVars NIL)            (numRules 6)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions NIL)            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlayer  SellGoods NIL      "Method implementing a RuleSet" (method HousePlayer.SellGoods RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 637)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 637))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 742)))            (name #,($A HousePlayer.SellGoods NIL RememberName))            (compiledRules HousePlayer.SellGoods)            (workSpace HousePlayer)            (tempVars (cargo sellQty))            (taskVars NIL)            (debugVars NIL)            (numRules 5)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH HousePlayer  TakeTurn NIL      "Method implementing a RuleSet" (method HousePlayer.TakeTurn RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639)) methodClass RuleSet UID (LOX0.%:F5.o28.D_; . 639))            (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 743)))            (name #,($A HousePlayer.TakeTurn NIL RememberName))            (compiledRules HousePlayer.TakeTurn)            (workSpace HousePlayer)            (tempVars (possibleStops gasStation))            (taskVars NIL)            (debugVars NIL)            (numRules 9)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 731))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 611)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 744))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 732))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 618)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 745))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 733))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 619)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 746))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 734))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 620)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 747))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 735))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 748))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 736))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 749))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 737))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 623)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 750))))(DEFINST RuleSetNode ((LRX0.%:F5.o28.dL@ . 20))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 16)) Source #,($& RuleSetSource (LRX0.%:F5.o28.dL@ . 24))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 738))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 625)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 751))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 739))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 752))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 740))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 635)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 753))))(DEFINST RuleSetNode ((LRX0.%:F5.o28.dL@ . 21))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14)) Source #,($& RuleSetSource (LRX0.%:F5.o28.dL@ . 25))))(DEFINST RuleSetNode ((LRX0.%:F5.o28.dL@ . 22))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 15)) Source #,($& RuleSetSource (LRX0.%:F5.o28.dL@ . 26))))(DEFINST RuleSetNode ((LRX0.%:F5.o28.dL@ . 23))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13)) Source #,($& RuleSetSource (LRX0.%:F5.o28.dL@ . 27))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 741))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 636)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 754))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 742))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 637)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 755))))(DEFINST RuleSetNode ((LOX0.%:F5.o28.D_; . 743))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639)) Source #,($& RuleSetSource (LOX0.%:F5.o28.D_; . 756))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 744))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 731)))         (created "15-Jul-88 15:49:59")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 757)) #,($& Rule (LOX0.%:F5.o28.D_; . 758)) #,($& Rule (LOX0.%:F5.o28.D_; . 759)) #,($& Rule (LOX0.%:F5.o28.D_; . 760)) #,($& Rule (LOX0.%:F5.o28.D_; . 761)) #,($& Rule (LOX0.%:F5.o28.D_; . 762)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 745))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 732)))         (created "15-Jul-88 15:50:06")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 763)) #,($& Rule (LOX0.%:F5.o28.D_; . 764)) #,($& Rule (LOX0.%:F5.o28.D_; . 765)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 746))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 733)))         (created "15-Jul-88 15:50:10")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 766)) #,($& Rule (LOX0.%:F5.o28.D_; . 767)) #,($& Rule (LOX0.%:F5.o28.D_; . 768)) #,($& Rule (LOX0.%:F5.o28.D_; . 769)) #,($& Rule (LOX0.%:F5.o28.D_; . 770)) #,($& Rule (LOX0.%:F5.o28.D_; . 771)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 747))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 734)))         (created "15-Jul-88 15:50:15")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 772)) #,($& Rule (LOX0.%:F5.o28.D_; . 773)) #,($& Rule (LOX0.%:F5.o28.D_; . 774)) #,($& Rule (LOX0.%:F5.o28.D_; . 775)) #,($& Rule (LOX0.%:F5.o28.D_; . 776)) #,($& Rule (LOX0.%:F5.o28.D_; . 777)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 748))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 735)))         (created "15-Jul-88 15:50:18")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 778)) #,($& Rule (LOX0.%:F5.o28.D_; . 779)) #,($& Rule (LOX0.%:F5.o28.D_; . 780)) #,($& Rule (LOX0.%:F5.o28.D_; . 781)) #,($& Rule (LOX0.%:F5.o28.D_; . 782)) #,($& Rule (LOX0.%:F5.o28.D_; . 783)) #,($& Rule (LOX0.%:F5.o28.D_; . 784)) #,($& Rule (LOX0.%:F5.o28.D_; . 785)) #,($& Rule (LOX0.%:F5.o28.D_; . 786)) #,($& Rule (LOX0.%:F5.o28.D_; . 787))                          )))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 749))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 736)))         (created "15-Jul-88 15:50:24")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 788)) #,($& Rule (LOX0.%:F5.o28.D_; . 789)) #,($& Rule (LOX0.%:F5.o28.D_; . 790)) #,($& Rule (LOX0.%:F5.o28.D_; . 791)) #,($& Rule (LOX0.%:F5.o28.D_; . 792)) #,($& Rule (LOX0.%:F5.o28.D_; . 793)) #,($& Rule (LOX0.%:F5.o28.D_; . 794)) #,($& Rule (LOX0.%:F5.o28.D_; . 795)) #,($& Rule (LOX0.%:F5.o28.D_; . 796)) #,($& Rule (LOX0.%:F5.o28.D_; . 797))                          )))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 750))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 737)))         (created "15-Jul-88 15:50:27")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 798)) #,($& Rule (LOX0.%:F5.o28.D_; . 799)) #,($& Rule (LOX0.%:F5.o28.D_; . 800)) #,($& Rule (LOX0.%:F5.o28.D_; . 801)) #,($& Rule (LOX0.%:F5.o28.D_; . 802)))))(DEFINST RuleSetSource ((LRX0.%:F5.o28.dL@ . 24))         (perspectiveNode #,($& RuleSetNode (LRX0.%:F5.o28.dL@ . 20)))         (created "18-Jul-88 19:06:17")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LRX0.%:F5.o28.dL@ . 28)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 751))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 738)))         (created "15-Jul-88 15:50:31")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 803)) #,($& Rule (LOX0.%:F5.o28.D_; . 804)) #,($& Rule (LOX0.%:F5.o28.D_; . 805)) #,($& Rule (LOX0.%:F5.o28.D_; . 806)) #,($& Rule (LOX0.%:F5.o28.D_; . 807)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 752))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 739)))         (created "15-Jul-88 15:50:38")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 808)) #,($& Rule (LOX0.%:F5.o28.D_; . 809)) #,($& Rule (LOX0.%:F5.o28.D_; . 810)) #,($& Rule (LOX0.%:F5.o28.D_; . 811)) #,($& Rule (LOX0.%:F5.o28.D_; . 812)) #,($& Rule (LOX0.%:F5.o28.D_; . 813)) #,($& Rule (LOX0.%:F5.o28.D_; . 814)) #,($& Rule (LOX0.%:F5.o28.D_; . 815)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 753))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 740)))         (created "15-Jul-88 15:50:43")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 816)) #,($& Rule (LOX0.%:F5.o28.D_; . 817)) #,($& Rule (LOX0.%:F5.o28.D_; . 818)))))(DEFINST RuleSetSource ((LRX0.%:F5.o28.dL@ . 25))         (perspectiveNode #,($& RuleSetNode (LRX0.%:F5.o28.dL@ . 21)))         (created "18-Jul-88 19:02:38")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LRX0.%:F5.o28.dL@ . 29)) #,($& Rule (LRX0.%:F5.o28.dL@ . 30)) #,($& Rule (LRX0.%:F5.o28.dL@ . 31)) #,($& Rule (LRX0.%:F5.o28.dL@ . 32)) #,($& Rule (LRX0.%:F5.o28.dL@ . 33)) #,($& Rule (LRX0.%:F5.o28.dL@ . 34)) #,($& Rule (LRX0.%:F5.o28.dL@ . 35)) #,($& Rule (LRX0.%:F5.o28.dL@ . 36)) #,($& Rule (LRX0.%:F5.o28.dL@ . 37)))))(DEFINST RuleSetSource ((LRX0.%:F5.o28.dL@ . 26))         (perspectiveNode #,($& RuleSetNode (LRX0.%:F5.o28.dL@ . 22)))         (created "18-Jul-88 19:04:03")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LRX0.%:F5.o28.dL@ . 38)) #,($& Rule (LRX0.%:F5.o28.dL@ . 39)) #,($& Rule (LRX0.%:F5.o28.dL@ . 40)) #,($& Rule (LRX0.%:F5.o28.dL@ . 41)) #,($& Rule (LRX0.%:F5.o28.dL@ . 42)) #,($& Rule (LRX0.%:F5.o28.dL@ . 43)))))(DEFINST RuleSetSource ((LRX0.%:F5.o28.dL@ . 27))         (perspectiveNode #,($& RuleSetNode (LRX0.%:F5.o28.dL@ . 23)))         (created "18-Jul-88 19:01:46")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LRX0.%:F5.o28.dL@ . 44)) #,($& Rule (LRX0.%:F5.o28.dL@ . 45)) #,($& Rule (LRX0.%:F5.o28.dL@ . 46)) #,($& Rule (LRX0.%:F5.o28.dL@ . 47)) #,($& Rule (LRX0.%:F5.o28.dL@ . 48)) #,($& Rule (LRX0.%:F5.o28.dL@ . 49)) #,($& Rule (LRX0.%:F5.o28.dL@ . 50)) #,($& Rule (LRX0.%:F5.o28.dL@ . 51)) #,($& Rule (LRX0.%:F5.o28.dL@ . 52)) #,($& Rule (LRX0.%:F5.o28.dL@ . 53)) #,($& Rule (LRX0.%:F5.o28.dL@ . 54)) #,($& Rule (LRX0.%:F5.o28.dL@ . 55)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 754))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 741)))         (created "15-Jul-88 15:50:47")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 819)) #,($& Rule (LOX0.%:F5.o28.D_; . 820)) #,($& Rule (LOX0.%:F5.o28.D_; . 821)) #,($& Rule (LOX0.%:F5.o28.D_; . 822)) #,($& Rule (LOX0.%:F5.o28.D_; . 823)) #,($& Rule (LOX0.%:F5.o28.D_; . 824)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 755))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 742)))         (created "15-Jul-88 15:50:52")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 825)) #,($& Rule (LOX0.%:F5.o28.D_; . 826)) #,($& Rule (LOX0.%:F5.o28.D_; . 827)) #,($& Rule (LOX0.%:F5.o28.D_; . 828)) #,($& Rule (LOX0.%:F5.o28.D_; . 829)))))(DEFINST RuleSetSource ((LOX0.%:F5.o28.D_; . 756))         (perspectiveNode #,($& RuleSetNode (LOX0.%:F5.o28.D_; . 743)))         (created "15-Jul-88 15:50:57")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LOX0.%:F5.o28.D_; . 830)) #,($& Rule (LOX0.%:F5.o28.D_; . 831)) #,($& Rule (LOX0.%:F5.o28.D_; . 832)) #,($& Rule (LOX0.%:F5.o28.D_; . 833)) #,($& Rule (LOX0.%:F5.o28.D_; . 834)) #,($& Rule (LOX0.%:F5.o28.D_; . 835)) #,($& Rule (LOX0.%:F5.o28.D_; . 836)) #,($& Rule (LOX0.%:F5.o28.D_; . 837)) #,($& Rule (LOX0.%:F5.o28.D_; . 838)))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 757))         (source "(* Returns a stopping place en route to a destination.)(* If already at destination, make it be stoppingPlace)IF truck:location=destinationTHEN stoppingPlace_destination;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 611))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 758))         (source "(* Obey the law - stop at WeighStations.)IF truck:cargo   wStation_(NearestRoadStop (RoadStops $WeighStation horizon direction 'Room))   (Distance wStation)<(Distance destination) THEN stoppingPlace_wStation;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 611))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 759))         (source "(* check if fragile cargo)IF truck:cargo has_(CAR truck:cargo) (ISA has $FragileCommodity)   roughRd_(NearestRoadStop (RoadStops $RoughRoad horizon direction 'Room))   (Distance roughRd)<(Distance destination)THEN stoppingPlace_roughRd;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 611))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 760))         (source        "IF (Distance destination)<=.Range1 (RoomToParkP destination)THEN stoppingPlace_destination;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 611))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 761))         (source "IF goal~='GoToAlices   truck:fuel < .6 * truck::MaxFuel   gasStation_(FurthestRoadStop (RoadStops $GasStation horizon direction 'Room))   gasStation:qty>0THEN stoppingPlace_gasStation;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 611))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 762))         (source "THEN stoppingPlace_(NthRoadStop  horizon direction NIL 'Room);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 611))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 763))         (source "(* Go to the stoppingPlace)IF stoppingPlace=truck:location THEN (WriteGameStatus %"Hm! %" driver %" already there%");")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 618))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 764))         (source "IF stoppingPlace.BanditP THEN (WriteGameStatus  driver %" Not moving because of bandits%")      (_ \PlayerInterface Move self truck:location);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 618))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 765))         (source "-> (_ \PlayerInterface Move self stoppingPlace);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 618))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 766))         (source           "	(* Rate the suitability of a proposed Consumer.)-> cargo _ (CAR truck:cargo) rating_0;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 619))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 767))         (source "(* Consumer must want current cargo.) IF ~(ISA cargo rs::Commodity)  THEN (STOP -10000 NIL 'CannotSellHere);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 619))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 768))         (source "(* Exclude consumers that have full inventory.) IF rs:qty < 1  THEN (STOP -10000 NIL 'CannotSellHere);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 619))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 769))         (source "(* Dont go if Bandits)IF rs.BanditP THEN rating _ rating - 10000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 619))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 770))         (source "(* Favor high price ratios.)  -> rating _ rating + 100 * rs:pr ;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 619))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 771))         (source      "(* Favor close places.)  -> rating _ rating - 5 * [truck::Gpm *(Distance rs truck:location)];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 619))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 772))         (source "(* rate gas stations within range) THEN rating _ 0;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 620))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 773))         (source "IF rs:qty=0  THEN rating _ -2000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 620))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 774))         (source "IF ~(RoomToParkP rs) THEN rating _ rating - 200;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 620))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 775))         (source "IF rs.BanditP THEN rating _ rating - 200;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 620))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 776))         (source " THEN rating _ rating - [10 * (Distance rs truck:location)];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 620))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 777))         (source " THEN rating _ rating + (IMIN rs:qty truck::MaxFuel);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 620))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 778))         (source "	(* Rate the suitability of a proposed Producer.)-> rating _ 0;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 779))         (source           "(* Exclude gas stations.) IF (ISA rs $GasStation)  THEN (STOP -100000 NIL 'GasStation);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 780))         (source       "(* Exclude producers that are sold out.) IF rs:qty < 1  THEN (STOP -100000 NIL 'CannotBuy);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 781))         (source "(* Penalize producers for which can buy < 1 items.) IF maxBuy_(_ self MaxPurchase rs)     maxBuy < 1  THEN (STOP -100000 NIL 'CannotBuy);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 782))         (source "(* If Bandits there, dont go)IF rs.BanditPTHEN rating _ rating - 10000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 783))         (source "(* Exclude perishables.) IF (SUBCLASS rs::Commodity $PerishableCommodity)  THEN rating _ rating - 2000 + [100 * rs::Commodity::MinLifetime];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 784))         (source         "(* favor LuxuryGoods)IF (SUBCLASS rs::Commodity $LuxuryGoods)THEN rating _ rating + 2000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 785))         (source "IF (SUBCLASS rs::Commodity $Xerox1100)THEN rating _ rating + 2000 ;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 8)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 786))         (source "(* favor higher qty) -> rating _ rating + [10 * maxBuy];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 9)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 787))         (source    "(* Favor close places.)  -> rating _ rating - [10 * truck::Gpm * (Distance rs truck:location)];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 10)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 621))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 788))         (source "(* Sets the goal)IF (ISA truck:location $AlicesRestaurant) .TimeAtStop>=29 THEN goal_'LeaveAlice;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 789))         (source "IF goal << '(SitTight BuyGas) THEN ;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 790))         (source "IF goal='GoToAlice (ISA truck:location $AlicesRestaurant)  THEN goal_'SitTight;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 791))         (source "IF \Simulator:timeLeft <30 THEN goal_'GoToAlice higherGoal_'GoToAlice;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 792))         (source         "IF truck:fuel < .35 * truck::MaxFuel  truck:cashBox > 0 THEN higherGoal_goal goal_'BuyGas;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 793))         (source "IF \Simulator:timeLeft < 60  THEN goal_'GetClose higherGoal_'GoToAlice;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 794))         (source "IF truck:fuel=0 truck:cashBox > 500000  THEN goal_'SitTight;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 795))         (source "IF truck:fuel=0 \Simulator:timeLeft > 300 THEN goal_'UnionHall;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 8)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 796))         (source "IF truck:cargo THEN goal_'Sell;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 9)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 797))         (source "-> goal_'Buy;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 10)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 622))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 798))         (source "   (* Top-Level RuleSet for taking turns.  Sets goal and destination. Iteration Condition:   ( : ( LispVar Communicator ) gameStarted );"                )         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 623))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 799))         (source ")  ->  .SetGoal;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 623))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 800))         (source "IF goal THEN (_! self goal);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 623))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 801))         (source "IF destination THEN horizon_(IMIN .Range1 (Distance destination))                     .FindStoppingPlace;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 623))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 802))         (source "IF destination stoppingPlace  THEN .GoToStoppingPlace      .AtCurrentStop;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 623))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 28))         (source "-> destination_(AnyRoadStop $UnionHall)   direction_(DirectionOf destination);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 16))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 803))         (source "(* Returns a stopping place en route to a destination.)(* If already at destination, make it be stoppingPlace)IF truck:location=destinationTHEN stoppingPlace_destination;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 625))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 804))         (source "(* Obey the law - stop at WeighStations.)IF truck:cargo   wStation_(NearestRoadStop (RoadStops $WeighStation .Range1 direction 'Room))   (Distance wStation)<(Distance destination) THEN stoppingPlace_wStation;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 625))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 805))         (source        "IF (Distance destination)<=.Range1 (RoomToParkP destination)THEN stoppingPlace_destination;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 625))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 806))         (source "IF goal~='GoToAlices   truck:fuel < .6 * truck::MaxFuel   gasStation_(FurthestRoadStop (RoadStops $GasStation .Range1 direction 'Room))   gasStation:qty>0THEN stoppingPlace_gasStation;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 625))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 807))         (source "THEN stoppingPlace_(NthRoadStop  (IMIN .Range1  (Distance destination))                                 direction NIL 'Room);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 625))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 808))         (source "	THEN direction_ (DirectionOf destination);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 809))         (source "        -> realLocation_truck:location;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 810))         (source "	IF .FindStoppingPlace stoppingPlace~=truck:location           ~stoppingPlace.BanditP	THEN (_ \PlayerInterface Move self stoppingPlace)                realLocation_truck:location;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 811))         (source "        IF realLocation~=stoppingPlace 	THEN (WriteGameStatus %"Oh!! %" driver %" didnt go to stoppingPlace%");")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 812))         (source "	IF (ISA realLocation $GasStation) realLocation:qty > 0	THEN .BuyGas goal_'Peddle destination_NIL (STOP 'Peddle NIL 'BoughtGas);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 813))         (source "	IF (ISA realLocation $Producer)            goal='Peddle	   realLocation=destination            numBuy_(_ self MaxPurchase realLocation)           numBuy>=1  	THEN (_ \PlayerInterface Buy self numBuy);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 814))         (source "	IF (ISA realLocation $Consumer) truck:cargo	THEN .SellGoods;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 815))         (source "        IF realLocation=destination         THEN destination_NIL;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 8)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 631))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 816))         (source "	(* Rules for deciding how much the HousePlayer could buy at a Producer.)(* Sale can be limited by volume, weight, cash, or availability.)-> volumeCapacity _ truck::MaxVolume-truck:volume   weightCapacity _ truck::MaxWeight-truck:weight   cashCapacity _ (MAX 0  truck:cashBox-cashReserve);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 635))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 817))         (source "   -> volumeLimit _ volumeCapacity / roadStop::Commodity::VolPerQty   weightLimit _ weightCapacity / roadStop::Commodity::WtPerQty   cashLimit _ cashCapacity / (PricePerUnit roadStop)   producerLimit _ roadStop:qty;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 635))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 818))         (source "-> numBuy _ (MIN volumeLimit weightLimit cashLimit producerLimit);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 635))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 29))         (source           "	(* Rate the suitability of a proposed Consumer.)-> cargo _ (CAR truck:cargo) rating_0;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 30))         (source "(* if spoilt go to CityDump)IF ~cargo:status (ISA rs $CityDump) THEN (STOP 5000 'CityDump 'LookNoMore);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 31))         (source "IF ~cargo:statusTHEN (STOP NIL 'SpoiltGoods 'CannotSell);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 32))         (source "(* Consumer must want current cargo.) IF ~(ISA cargo rs::Commodity)  THEN (STOP -10000 NIL 'CannotSellHere);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 33))         (source "(* Exclude consumers that have full inventory.) IF rs:qty < 1  THEN (STOP -10000 NIL 'CannotSellHere);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 34))         (source "(* Need to be able to park) IF ~(RoomToParkP rs)  THEN rating _ rating - 200;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 35))         (source "(* Dont go if Bandits)IF rs.BanditP THEN rating _ rating - 10000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 36))         (source "(* Favor high price ratios.)  -> rating _ rating + 100 * rs:pr ;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 8)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 37))         (source      "(* Favor close places.)  -> rating _ rating - 5 * [truck::Gpm *(Distance rs truck:location)];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 9)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 14))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 38))         (source "(* rate gas stations within range) THEN rating _ 0;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 15))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 39))         (source "IF rs:qty=0  THEN rating _ -2000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 15))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 40))         (source "IF ~(RoomToParkP rs) THEN rating _ rating - 200;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 15))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 41))         (source "IF rs.BanditP THEN rating _ rating - 200;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 15))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 42))         (source " THEN rating _ rating - [10 * (Distance rs truck:location)];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 15))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 43))         (source " THEN rating _ rating + (IMIN rs:qty truck::MaxFuel);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 15))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 44))         (source "	(* Rate the suitability of a proposed Producer.)-> rating _ 0;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 45))         (source           "(* Exclude gas stations.) IF (ISA rs $GasStation)  THEN (STOP -100000 NIL 'GasStation);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 46))         (source       "(* Exclude producers that are sold out.) IF rs:qty < 1  THEN (STOP -100000 NIL 'CannotBuy);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 47))         (source "(* Penalize producers for which can buy < 1 items.) IF maxBuy_(_ self MaxPurchase rs)     maxBuy < 1  THEN (STOP -100000 NIL 'CannotBuy);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 48))         (source "(* Need to be able to park)IF ~(RoomToParkP rs) THEN rating _ -500;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 49))         (source "(* If Bandits there, dont go)IF rs.BanditPTHEN rating _ rating - 10000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 50))         (source "(* Exclude perishables.) IF (SUBCLASS rs::Commodity $PerishableCommodity)  THEN rating _ rating - 2000 + [100 * rs::Commodity::MinLifetime];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 51))         (source "(* Exclude excessively fragile goods.) IF (SUBCLASS rs::Commodity $FragileCommodity)    THEN rating _ rating - [100 * rs::Commodity::FragilityLevel];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 8)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 52))         (source         "(* favor LuxuryGoods)IF (SUBCLASS rs::Commodity $LuxuryGoods)THEN rating _ rating + 1000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 9)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 53))         (source "IF (SUBCLASS rs::Commodity $Xerox1100)THEN rating _ rating + 1000 ;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 10)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 54))         (source "(* favor higher qty) -> rating _ rating + [20 * maxBuy];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 11)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LRX0.%:F5.o28.dL@ . 55))         (source    "(* Favor close places.)  -> rating _ rating - [10 * truck::Gpm * (Distance rs truck:location)];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 12)         (ruleSet #,($& RuleSet (LRX0.%:F5.o28.dL@ . 13))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 819))         (source "(* Rating RuleSet for spots near Alices.  Returns a number for spots.)-> cargo _ (CAR truck:cargo);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 636))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 820))         (source             "   (* Favor places closer to Alices.)-> rating _ 100 - 4 * (Distance roadStop alices);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 636))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 821))         (source "IF ~(RoomToParkP roadStop) THEN rating _ -1000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 636))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 822))         (source "IF (ISA roadStop $UnionHall) THEN rating _ -1000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 636))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 823))         (source "IF (ISA roadStop $AlicesRestaurant) THEN rating _ -500;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 636))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 824))         (source "IF cargo (ISA roadStop $Consumer) (ISA cargo roadStop::Commodity)   roadStop:qty>0 roadStop:pr>1 THEN rating _ rating + 20;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 636))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 825))         (source "(* Make sale as limited by cargo and consumer.)	-> cargo_(CAR truck:cargo);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 637))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 826))         (source              "	IF ~(ISA cargo truck:location::Commodity)	THEN (STOP NIL 'NoSale 'WrongKindOfBuyer);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 637))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 827))         (source "        IF ~cargo:status (ISA truck:location $CityDump)         THEN sellQty_(IMIN truck:location:qty cargo:qty)              (_ \PlayerInterface Sell self cargo sellQty)              (STOP T 'Sold 'AtCityDump);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 637))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 828))         (source "	IF truck:location:pr < cargo:pr 	THEN (STOP NIL 'NoSale 'AvoidLoss);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 637))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 829))         (source "	IF cargo:status sellQty_(IMIN truck:location:qty cargo:qty) sellQty>=1 	THEN (_ \PlayerInterface Sell self cargo sellQty)              cashReserve_(MIN 5000 (TIMES 0.1 truck:cashBox));")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 637))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 830))         (source "   (* Top-Level RuleSet for taking turns.  Sets goal and destination.)  (* If no fuel, but close to end with enough cash, sit tight) IF truck:fuel=0 truck:cashBox > 300000  \gameMaster:timeRemaining < 300  THEN destination_NIL  goal_'SitTight;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 831))         (source "   (* Don't move away from Alices during endgame.) IF goal='GoToAlices (ISA truck:location $AlicesRestaurant)  THEN goal_'SitTight;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 832))         (source "   (* make sure not overstaying at Alices) IF goal='SitTight (ISA truck:location $AlicesRestaurant)      .TimeAtStop >=28  THEN destination_ (NearestRoadStop(RoadStops $AlicesRestaurant ))     goal='GoToAlices;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 833))         (source "   (* Get near to Alices when time gets close)		 IF \Simulator:timeLeft < 60 ~[goal<<'(SitTight GetClose GoToAlices)]    THEN alices_(NearestRoadStop (RoadStops $AlicesRestaurant))       destination_ (PickHiObj self 'RateSpotsNearAlices (RoadStops) )       goal_'GetClose;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 834))         (source "   (* Go to Alices now that it is time) IF \Simulator:timeLeft < 29     ~(ISA truck:location $AlicesRestaurant)     THEN destination_ (NearestRoadStop (RoadStops $AlicesRestaurant NIL NIL T))       goal_'GoToAlices ;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 835))         (source " IF goal~='SitTight     truck:fuel < .35 * truck::MaxFuel    truck:cashBox > 0    gasStation_(PickHiObj self 'RateGasStations (RoadStops $GasStation .Range) )  THEN goal_'BuyGas destination_gasStation;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 836))         (source " IF goal='Peddle truck:cargo  possibleStops_(Buyers (CAR truck:cargo) NIL T)  THEN destination_(PickHiObj self 'RateConsumers possibleStops );")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 837))         (source " IF goal='Peddle ~truck:cargo \Simulator:timeLeft > 70    possibleStops_(RoadStops $Producer)  THEN destination_(PickHiObj  self 'RateProducers possibleStops);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 8)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639))))(DEFINST Rule ((LOX0.%:F5.o28.D_; . 838))         (source " IF destination  THEN .GoToStoppingPlace;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 9)         (ruleSet #,($& RuleSet (LOX0.%:F5.o28.D_; . 639))))(Method ((HousePlanner FindStoppingPlace) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value wStation gasStation has roughRd)     ^firstRules         [COND            [(EQ (GetValue (GetValue self 'truck)                        'location)                 (GetValue self 'destination))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 612]                                 (PutAuditRec self 'stoppingPlace (GetValue self 'destination)                                        ^auditRecord]            [[AND (GetValue (GetValue self 'truck)                         'cargo)                  [SETQ wStation (NearestRoadStop (RoadStops ($ WeighStation)                                                         (GetValue self 'horizon)                                                         (GetValue self 'direction)                                                         'Room]                  (LESSP (Distance wStation)                         (Distance (GetValue self 'destination]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 613]                                 (PutAuditRec self 'stoppingPlace wStation ^auditRecord]            [[AND (GetValue (GetValue self 'truck)                         'cargo)                  [SETQ has (CAR (GetValue (GetValue self 'truck)                                        'cargo]                  (ISA has ($ FragileCommodity))                  [SETQ roughRd (NearestRoadStop (RoadStops ($ RoughRoad)                                                        (GetValue self 'horizon)                                                        (GetValue self 'direction)                                                        'Room]                  (LESSP (Distance roughRd)                         (Distance (GetValue self 'destination]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 614]                                 (PutAuditRec self 'stoppingPlace roughRd ^auditRecord]            [[AND (LEQ (Distance (GetValue self 'destination))                       (_ self Range1))                  (RoomToParkP (GetValue self 'destination]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 615]                                 (PutAuditRec self 'stoppingPlace (GetValue self 'destination)                                        ^auditRecord]            [(AND (NEQ (GetValue self 'goal)                       'GoToAlices)                  [LESSP (GetValue (GetValue self 'truck)                                'fuel)                         (TIMES 0.6 (GetClassValue (GetValue self 'truck)                                           'MaxFuel]                  [SETQ gasStation (FurthestRoadStop (RoadStops ($ GasStation)                                                            (GetValue self 'horizon)                                                            (GetValue self 'direction)                                                            'Room]                  (GREATERP (GetValue gasStation 'qty)                         0))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 616]                                 (PutAuditRec self 'stoppingPlace gasStation ^auditRecord]            (T (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                          (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                                New))                                          (PutValue ^auditRecord 'rule (GetObjFromUID                                                                        '(LOX0.%:F5.o28.D_; . 617]                                   (PutAuditRec self 'stoppingPlace (NthRoadStop (GetValue                                                                                  self                                                                                  'horizon)                                                                           (GetValue self                                                                                  'direction)                                                                           NIL                                                                           'Room)                                          ^auditRecord]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlanner GoToStoppingPlace) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value)     ^firstRules         [COND            ((EQ (GetValue self 'stoppingPlace)                 (GetValue (GetValue self 'truck)                        'location))             (SETQ ^value (WriteGameStatus "Hm! " (GetValue self 'driver)                                 " already there")))            [(_ (GetValue self 'stoppingPlace)                BanditP)             (SETQ ^value (PROGN (WriteGameStatus (GetValue self 'driver)                                        " Not moving because of bandits")                                 (_ PlayerInterface Move self (GetValue (GetValue self 'truck)                                                                     'location))]            (T (SETQ ^value (_ PlayerInterface Move self (GetValue self 'stoppingPlace))]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlanner RateConsumers) self rs) "Method implementing a RuleSet"   (PROG (^auditRecord ^value rating cargo)     ^firstRules         (SETQ ^value (PROGN [SETQ cargo (CAR (GetValue (GetValue self 'truck)                                                     'cargo]                             (SETQ rating 0)))         [COND            ([NOT (ISA cargo (GetClassValue rs 'Commodity]             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 10000)                                        NIL                                        'CannotSellHere)                                 (GO QUIT]         [COND            ((LESSP (GetValue rs 'qty)                    1)             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 10000)                                        NIL                                        'CannotSellHere)                                 (GO QUIT]         [COND            ((_ rs BanditP)             (SETQ ^value (SETQ rating (DIFFERENCE rating 10000]         [SETQ ^value (SETQ rating (PLUS rating (TIMES 100 (GetValue rs 'pr]         [SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES 5                                                             (TIMES (GetClassValue                                                                     (GetValue self 'truck)                                                                     'Gpm)                                                                    (Distance                                                                     rs                                                                     (GetValue (GetValue self                                                                                      'truck)                                                                            'location]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlanner RateGasStations) self rs) "Method implementing a RuleSet"   (PROG (^auditRecord ^value rating)     ^firstRules         (SETQ ^value (SETQ rating 0))         [COND            ((EQ (GetValue rs 'qty)                 0)             (SETQ ^value (SETQ rating (MINUS 2000]         [COND            ((NOT (RoomToParkP rs))             (SETQ ^value (SETQ rating (DIFFERENCE rating 200]         [COND            ((_ rs BanditP)             (SETQ ^value (SETQ rating (DIFFERENCE rating 200]         [SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES 10 (Distance rs                                                                       (GetValue (GetValue                                                                                  self                                                                                  'truck)                                                                              'location]         [SETQ ^value (SETQ rating (PLUS rating (IMIN (GetValue rs 'qty)                                                      (GetClassValue (GetValue self 'truck)                                                             'MaxFuel]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlanner RateProducers) self rs) "Method implementing a RuleSet"   (PROG (^value rating maxBuy)     ^firstRules         (SETQ ^value (SETQ rating 0))         [COND            ((ISA rs ($ GasStation))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 100000)                                        NIL                                        'GasStation)                                 (GO QUIT]         [COND            ((LESSP (GetValue rs 'qty)                    1)             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 100000)                                        NIL                                        'CannotBuy)                                 (GO QUIT]         [COND            ((AND (SETQ maxBuy (_ self MaxPurchase rs))                  (LESSP maxBuy 1))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 100000)                                        NIL                                        'CannotBuy)                                 (GO QUIT]         [COND            ((_ rs BanditP)             (SETQ ^value (SETQ rating (DIFFERENCE rating 10000]         [COND            ((SUBCLASS (GetClassValue rs 'Commodity)                    ($ PerishableCommodity))             (SETQ ^value (SETQ rating (PLUS (DIFFERENCE rating 2000)                                             (TIMES 100 (GetClassValue (GetClassValue rs 'Commodity)                                                               'MinLifetime]         [COND            ((SUBCLASS (GetClassValue rs 'Commodity)                    ($ LuxuryGoods))             (SETQ ^value (SETQ rating (PLUS rating 2000]         [COND            ((SUBCLASS (GetClassValue rs 'Commodity)                    ($ Xerox1100))             (SETQ ^value (SETQ rating (PLUS rating 2000]         [SETQ ^value (SETQ rating (PLUS rating (TIMES 10 maxBuy]         [SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES (TIMES 10 (GetClassValue                                                                        (GetValue self 'truck)                                                                        'Gpm))                                                             (Distance rs (GetValue                                                                           (GetValue self                                                                                  'truck)                                                                           'location]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlanner SetGoal) self) "Method implementing a RuleSet"   (PROG (^value)     ^firstRules         [COND            [(AND (ISA (GetValue (GetValue self 'truck)                              'location)                       ($ AlicesRestaurant))                  (GEQ (_ self TimeAtStop)                       29))             (SETQ ^value (PutValue self 'goal 'LeaveAlice]            ((FMEMB (GetValue self 'goal)                    '(SitTight BuyGas))             (SETQ ^value (PROGN)))            [(AND (EQ (GetValue self 'goal)                      'GoToAlice)                  (ISA (GetValue (GetValue self 'truck)                              'location)                       ($ AlicesRestaurant)))             (SETQ ^value (PutValue self 'goal 'SitTight]            [(LESSP (GetValue Simulator 'timeLeft)                    30)             (SETQ ^value (PROGN (PutValue self 'goal 'GoToAlice)                                 (PutValue self 'higherGoal 'GoToAlice]            [(AND [LESSP (GetValue (GetValue self 'truck)                                'fuel)                         (TIMES 0.35 (GetClassValue (GetValue self 'truck)                                            'MaxFuel]                  (GREATERP (GetValue (GetValue self 'truck)                                   'cashBox)                         0))             (SETQ ^value (PROGN (PutValue self 'higherGoal (GetValue self 'goal))                                 (PutValue self 'goal 'BuyGas]            [(LESSP (GetValue Simulator 'timeLeft)                    60)             (SETQ ^value (PROGN (PutValue self 'goal 'GetClose)                                 (PutValue self 'higherGoal 'GoToAlice]            [(AND (EQ (GetValue (GetValue self 'truck)                             'fuel)                      0)                  (GREATERP (GetValue (GetValue self 'truck)                                   'cashBox)                         500000))             (SETQ ^value (PutValue self 'goal 'SitTight]            [(AND (EQ (GetValue (GetValue self 'truck)                             'fuel)                      0)                  (GREATERP (GetValue Simulator 'timeLeft)                         300))             (SETQ ^value (PutValue self 'goal 'UnionHall]            [(GetValue (GetValue self 'truck)                    'cargo)             (SETQ ^value (PutValue self 'goal 'Sell]            (T (SETQ ^value (PutValue self 'goal 'Buy]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlanner TakeTurn) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value possibleStops)     ^firstRules         (SETQ ^value (_ self SetGoal))         [COND            ((GetValue self 'goal)             (SETQ ^value (DoMethod self (GetValue self 'goal)                                 NIL]         [COND            ((GetValue self 'destination)             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 624]                                 (PutAuditRec self 'horizon [IMIN (_ self Range1)                                                                  (Distance (GetValue self                                                                                   'destination]                                        ^auditRecord)                                 (_ self FindStoppingPlace)]         [COND            ((AND (GetValue self 'destination)                  (GetValue self 'stoppingPlace))             (SETQ ^value (PROGN (_ self GoToStoppingPlace)                                 (_ self AtCurrentStop)]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlanner UnionHall) self) "Method implementing a RuleSet"   (PROG (^value)     ^firstRules         [COND            (T (SETQ ^value (PROGN (PutValue self 'destination (AnyRoadStop ($ UnionHall)))                                   (PutValue self 'direction (DirectionOf (GetValue self 'destination                                                                                 ]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlayer FindStoppingPlace) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value wStation gasStation)     ^firstRules         [COND            [(EQ (GetValue (GetValue self 'truck)                        'location)                 (GetValue self 'destination))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 626]                                 (PutAuditRec self 'stoppingPlace (GetValue self 'destination)                                        ^auditRecord]            [[AND (GetValue (GetValue self 'truck)                         'cargo)                  [SETQ wStation (NearestRoadStop (RoadStops ($ WeighStation)                                                         (_ self Range1)                                                         (GetValue self 'direction)                                                         'Room]                  (LESSP (Distance wStation)                         (Distance (GetValue self 'destination]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 627]                                 (PutAuditRec self 'stoppingPlace wStation ^auditRecord]            [[AND (LEQ (Distance (GetValue self 'destination))                       (_ self Range1))                  (RoomToParkP (GetValue self 'destination]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 628]                                 (PutAuditRec self 'stoppingPlace (GetValue self 'destination)                                        ^auditRecord]            [(AND (NEQ (GetValue self 'goal)                       'GoToAlices)                  [LESSP (GetValue (GetValue self 'truck)                                'fuel)                         (TIMES 0.6 (GetClassValue (GetValue self 'truck)                                           'MaxFuel]                  [SETQ gasStation (FurthestRoadStop (RoadStops ($ GasStation)                                                            (_ self Range1)                                                            (GetValue self 'direction)                                                            'Room]                  (GREATERP (GetValue gasStation 'qty)                         0))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 629]                                 (PutAuditRec self 'stoppingPlace gasStation ^auditRecord]            (T (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                          (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                                New))                                          (PutValue ^auditRecord 'rule (GetObjFromUID                                                                        '(LOX0.%:F5.o28.D_; . 630]                                   (PutAuditRec self 'stoppingPlace                                          (NthRoadStop [IMIN (_ self Range1)                                                             (Distance (GetValue self 'destination]                                                 (GetValue self 'direction)                                                 NIL                                                 'Room)                                          ^auditRecord]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlayer GoToStoppingPlace) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value realLocation numBuy)     ^firstRules         (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                    (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                          New))                                    (PutValue ^auditRecord 'rule (GetObjFromUID '(LOX0.%:F5.o28.D_; . 632                                                                                  ]                             (PutAuditRec self 'direction (DirectionOf (GetValue self 'destination))                                    ^auditRecord)))         [SETQ ^value (SETQ realLocation (GetValue (GetValue self 'truck)                                                'location]         [COND            ((AND (_ self FindStoppingPlace)                  (NEQ (GetValue self 'stoppingPlace)                       (GetValue (GetValue self 'truck)                              'location))                  (NOT (_ (GetValue self 'stoppingPlace)                          BanditP)))             (SETQ ^value (PROGN (_ PlayerInterface Move self (GetValue self 'stoppingPlace))                                 (SETQ realLocation (GetValue (GetValue self 'truck)                                                           'location]         [COND            ((NEQ realLocation (GetValue self 'stoppingPlace))             (SETQ ^value (WriteGameStatus "Oh!! " (GetValue self 'driver)                                 " didnt go to stoppingPlace"]         [COND            ((AND (ISA realLocation ($ GasStation))                  (GREATERP (GetValue realLocation 'qty)                         0))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 633]                                 (_ self BuyGas)                                 (PutAuditRec self 'goal 'Peddle ^auditRecord)                                 (PutAuditRec self 'destination NIL ^auditRecord)                                 (PROGN                      (* ^value set by RuleSetStop)                                        (RuleSetStop 'Peddle NIL 'BoughtGas)                                        (GO QUIT]         [COND            ((AND (ISA realLocation ($ Producer))                  (EQ (GetValue self 'goal)                      'Peddle)                  (EQ realLocation (GetValue self 'destination))                  (SETQ numBuy (_ self MaxPurchase realLocation))                  (GEQ numBuy 1))             (SETQ ^value (_ PlayerInterface Buy self numBuy)]         [COND            ((AND (ISA realLocation ($ Consumer))                  (GetValue (GetValue self 'truck)                         'cargo))             (SETQ ^value (_ self SellGoods)]         [COND            ((EQ realLocation (GetValue self 'destination))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 634]                                 (PutAuditRec self 'destination NIL ^auditRecord]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlayer MaxPurchase) self roadStop) "Method implementing a RuleSet"   (PROG (^auditRecord ^value volumeCapacity weightCapacity volumeLimit weightLimit cashLimit                 producerLimit numBuy cashCapacity)     ^firstRules         [SETQ ^value (PROGN [SETQ volumeCapacity (DIFFERENCE (GetClassValue (GetValue self                                                                                    'truck)                                                                     'MaxVolume)                                                         (GetValue (GetValue self 'truck)                                                                'volume]                             [SETQ weightCapacity (DIFFERENCE (GetClassValue (GetValue self                                                                                    'truck)                                                                     'MaxWeight)                                                         (GetValue (GetValue self 'truck)                                                                'weight]                             (SETQ cashCapacity (MAX 0 (DIFFERENCE (GetValue (GetValue self                                                                                    'truck)                                                                          'cashBox)                                                              (GetValue self 'cashReserve]         [SETQ ^value (PROGN [SETQ volumeLimit (QUOTIENT volumeCapacity (GetClassValue                                                                         (GetClassValue roadStop                                                                                'Commodity)                                                                         'VolPerQty]                             [SETQ weightLimit (QUOTIENT weightCapacity (GetClassValue                                                                         (GetClassValue roadStop                                                                                'Commodity)                                                                         'WtPerQty]                             (SETQ cashLimit (QUOTIENT cashCapacity (PricePerUnit roadStop)))                             (SETQ producerLimit (GetValue roadStop 'qty]         (SETQ ^value (SETQ numBuy (MIN volumeLimit weightLimit cashLimit producerLimit)))     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlayer RateConsumers) self rs) "Method implementing a RuleSet"   (PROG (^auditRecord ^value rating cargo)     ^firstRules         (SETQ ^value (PROGN [SETQ cargo (CAR (GetValue (GetValue self 'truck)                                                     'cargo]                             (SETQ rating 0)))         [COND            ((AND (NOT (GetValue cargo 'status))                  (ISA rs ($ CityDump)))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop 5000 'CityDump 'LookNoMore)                                 (GO QUIT]         [COND            ((NOT (GetValue cargo 'status))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop NIL 'SpoiltGoods 'CannotSell)                                 (GO QUIT]         [COND            ([NOT (ISA cargo (GetClassValue rs 'Commodity]             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 10000)                                        NIL                                        'CannotSellHere)                                 (GO QUIT]         [COND            ((LESSP (GetValue rs 'qty)                    1)             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 10000)                                        NIL                                        'CannotSellHere)                                 (GO QUIT]         [COND            ((NOT (RoomToParkP rs))             (SETQ ^value (SETQ rating (DIFFERENCE rating 200]         [COND            ((_ rs BanditP)             (SETQ ^value (SETQ rating (DIFFERENCE rating 10000]         [SETQ ^value (SETQ rating (PLUS rating (TIMES 100 (GetValue rs 'pr]         [SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES 5                                                             (TIMES (GetClassValue                                                                     (GetValue self 'truck)                                                                     'Gpm)                                                                    (Distance                                                                     rs                                                                     (GetValue (GetValue self                                                                                      'truck)                                                                            'location]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlayer RateGasStations) self rs) "Method implementing a RuleSet"   (PROG (^auditRecord ^value rating)     ^firstRules         (SETQ ^value (SETQ rating 0))         [COND            ((EQ (GetValue rs 'qty)                 0)             (SETQ ^value (SETQ rating (MINUS 2000]         [COND            ((NOT (RoomToParkP rs))             (SETQ ^value (SETQ rating (DIFFERENCE rating 200]         [COND            ((_ rs BanditP)             (SETQ ^value (SETQ rating (DIFFERENCE rating 200]         [SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES 10 (Distance rs                                                                       (GetValue (GetValue                                                                                  self                                                                                  'truck)                                                                              'location]         [SETQ ^value (SETQ rating (PLUS rating (IMIN (GetValue rs 'qty)                                                      (GetClassValue (GetValue self 'truck)                                                             'MaxFuel]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlayer RateProducers) self rs) "Method implementing a RuleSet"   (PROG (^value rating maxBuy)     ^firstRules         (SETQ ^value (SETQ rating 0))         [COND            ((ISA rs ($ GasStation))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 100000)                                        NIL                                        'GasStation)                                 (GO QUIT]         [COND            ((LESSP (GetValue rs 'qty)                    1)             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 100000)                                        NIL                                        'CannotBuy)                                 (GO QUIT]         [COND            ((AND (SETQ maxBuy (_ self MaxPurchase rs))                  (LESSP maxBuy 1))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop (MINUS 100000)                                        NIL                                        'CannotBuy)                                 (GO QUIT]         [COND            ((NOT (RoomToParkP rs))             (SETQ ^value (SETQ rating (MINUS 500]         [COND            ((_ rs BanditP)             (SETQ ^value (SETQ rating (DIFFERENCE rating 10000]         [COND            ((SUBCLASS (GetClassValue rs 'Commodity)                    ($ PerishableCommodity))             (SETQ ^value (SETQ rating (PLUS (DIFFERENCE rating 2000)                                             (TIMES 100 (GetClassValue (GetClassValue rs 'Commodity)                                                               'MinLifetime]         [COND            ((SUBCLASS (GetClassValue rs 'Commodity)                    ($ FragileCommodity))             (SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES 100 (GetClassValue                                                                      (GetClassValue rs 'Commodity)                                                                      'FragilityLevel]         [COND            ((SUBCLASS (GetClassValue rs 'Commodity)                    ($ LuxuryGoods))             (SETQ ^value (SETQ rating (PLUS rating 1000]         [COND            ((SUBCLASS (GetClassValue rs 'Commodity)                    ($ Xerox1100))             (SETQ ^value (SETQ rating (PLUS rating 1000]         [SETQ ^value (SETQ rating (PLUS rating (TIMES 20 maxBuy]         [SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES (TIMES 10 (GetClassValue                                                                        (GetValue self 'truck)                                                                        'Gpm))                                                             (Distance rs (GetValue                                                                           (GetValue self                                                                                  'truck)                                                                           'location]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlayer RateSpotsNearAlices) self roadStop) "Method implementing a RuleSet"   (PROG (^value rating cargo)     ^firstRules         [SETQ ^value (SETQ cargo (CAR (GetValue (GetValue self 'truck)                                              'cargo]         [SETQ ^value (SETQ rating (DIFFERENCE 100 (TIMES 4 (Distance roadStop (GetValue self                                                                                      'alices]         [COND            ((NOT (RoomToParkP roadStop))             (SETQ ^value (SETQ rating (MINUS 1000]         [COND            ((ISA roadStop ($ UnionHall))             (SETQ ^value (SETQ rating (MINUS 1000]         [COND            ((ISA roadStop ($ AlicesRestaurant))             (SETQ ^value (SETQ rating (MINUS 500]         [COND            ((AND cargo (ISA roadStop ($ Consumer))                  (ISA cargo (GetClassValue roadStop 'Commodity))                  (GREATERP (GetValue roadStop 'qty)                         0)                  (GREATERP (GetValue roadStop 'pr)                         1))             (SETQ ^value (SETQ rating (PLUS rating 20]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlayer SellGoods) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value cargo sellQty)     ^firstRules         [SETQ ^value (SETQ cargo (CAR (GetValue (GetValue self 'truck)                                              'cargo]         [COND            ([NOT (ISA cargo (GetClassValue (GetValue (GetValue self 'truck)                                                   'location)                                    'Commodity]             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop NIL 'NoSale 'WrongKindOfBuyer)                                 (GO QUIT]         [COND            ((AND (NOT (GetValue cargo 'status))                  (ISA (GetValue (GetValue self 'truck)                              'location)                       ($ CityDump)))             (SETQ ^value (PROGN [SETQ sellQty (IMIN (GetValue (GetValue (GetValue self 'truck)                                                                      'location)                                                            'qty)                                                     (GetValue cargo 'qty]                                 (_ PlayerInterface Sell self cargo sellQty)                                 (PROGN                      (* ^value set by RuleSetStop)                                        (RuleSetStop T 'Sold 'AtCityDump)                                        (GO QUIT]         [COND            ((LESSP (GetValue (GetValue (GetValue self 'truck)                                     'location)                           'pr)                    (GetValue cargo 'pr))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop NIL 'NoSale 'AvoidLoss)                                 (GO QUIT]         [COND            ((AND (GetValue cargo 'status)                  [SETQ sellQty (IMIN (GetValue (GetValue (GetValue self 'truck)                                                       'location)                                             'qty)                                      (GetValue cargo 'qty]                  (GEQ sellQty 1))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 638]                                 (_ PlayerInterface Sell self cargo sellQty)                                 (PutAuditRec self 'cashReserve                                        [MIN 5000 (TIMES 0.1 (GetValue (GetValue self 'truck)                                                                    'cashBox]                                        ^auditRecord]     QUIT     ^lastRules         (RETURN ^value)))(Method ((HousePlayer TakeTurn) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value possibleStops gasStation)     ^firstRules         [COND            ((AND (EQ (GetValue (GetValue self 'truck)                             'fuel)                      0)                  (GREATERP (GetValue (GetValue self 'truck)                                   'cashBox)                         300000)                  (LESSP (GetValue gameMaster 'timeRemaining)                         300))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 640]                                 (PutAuditRec self 'destination NIL ^auditRecord)                                 (PutAuditRec self 'goal 'SitTight ^auditRecord]         [COND            ((AND (EQ (GetValue self 'goal)                      'GoToAlices)                  (ISA (GetValue (GetValue self 'truck)                              'location)                       ($ AlicesRestaurant)))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 641]                                 (PutAuditRec self 'goal 'SitTight ^auditRecord]         [COND            ((AND (EQ (GetValue self 'goal)                      'SitTight)                  (ISA (GetValue (GetValue self 'truck)                              'location)                       ($ AlicesRestaurant))                  (GEQ (_ self TimeAtStop)                       28))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 642]                                 (PutAuditRec self 'destination (NearestRoadStop (RoadStops                                                                                  ($ AlicesRestaurant                                                                                     )))                                        ^auditRecord)                                 (EQ (GetValue self 'goal)                                     'GoToAlices]         [COND            ([AND (LESSP (GetValue Simulator 'timeLeft)                         60)                  (NOT (FMEMB (GetValue self 'goal)                              '(SitTight GetClose GoToAlices]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 643]                                 (PutAuditRec self 'alices (NearestRoadStop (RoadStops ($                                                                                      AlicesRestaurant                                                                                          )))                                        ^auditRecord)                                 (PutAuditRec self 'destination (PickHiObj self 'RateSpotsNearAlices                                                                       (RoadStops))                                        ^auditRecord)                                 (PutAuditRec self 'goal 'GetClose ^auditRecord]         [COND            ([AND (LESSP (GetValue Simulator 'timeLeft)                         29)                  (NOT (ISA (GetValue (GetValue self 'truck)                                   'location)                            ($ AlicesRestaurant]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 644]                                 (PutAuditRec self 'destination (NearestRoadStop (RoadStops                                                                                  ($ AlicesRestaurant                                                                                     )                                                                                  NIL NIL T))                                        ^auditRecord)                                 (PutAuditRec self 'goal 'GoToAlices ^auditRecord]         [COND            ([AND (NEQ (GetValue self 'goal)                       'SitTight)                  [LESSP (GetValue (GetValue self 'truck)                                'fuel)                         (TIMES 0.35 (GetClassValue (GetValue self 'truck)                                            'MaxFuel]                  (GREATERP (GetValue (GetValue self 'truck)                                   'cashBox)                         0)                  (SETQ gasStation (PickHiObj self 'RateGasStations (RoadStops ($ GasStation)                                                                           (_ self Range)]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 645]                                 (PutAuditRec self 'goal 'BuyGas ^auditRecord)                                 (PutAuditRec self 'destination gasStation ^auditRecord]         [COND            ((AND (EQ (GetValue self 'goal)                      'Peddle)                  (GetValue (GetValue self 'truck)                         'cargo)                  (SETQ possibleStops (Buyers (CAR (GetValue (GetValue self 'truck)                                                          'cargo))                                             NIL T)))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 646]                                 (PutAuditRec self 'destination (PickHiObj self 'RateConsumers                                                                        possibleStops)                                        ^auditRecord]         [COND            ([AND (EQ (GetValue self 'goal)                      'Peddle)                  (NOT (GetValue (GetValue self 'truck)                              'cargo))                  (GREATERP (GetValue Simulator 'timeLeft)                         70)                  (SETQ possibleStops (RoadStops ($ Producer]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LOX0.%:F5.o28.D_; . 647]                                 (PutAuditRec self 'destination (PickHiObj self 'RateProducers                                                                        possibleStops)                                        ^auditRecord]         [COND            ((GetValue self 'destination)             (SETQ ^value (_ self GoToStoppingPlace)]     QUIT     ^lastRules         (RETURN ^value)))(\UnbatchMethodDefs)(PUTPROPS HOUSEPLAYER COPYRIGHT ("Xerox Corporation" 1987 1988))(DECLARE%: DONTCOPY  (FILEMAP (NIL)))STOP