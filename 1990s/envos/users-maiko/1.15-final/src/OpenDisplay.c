/* @(#) OpenDisplay.c Version 1.1 (3/1/90). copyright venue & Fuji Xerox  */static char *id = "@(#) OpenDisplay.c	1.1 3/1/90	(venue & Fuji Xerox)";/**** Copyright (C) 1988 by Fuji Xerox co.,Ltd. All rights reserved.**		Author: Mitsunori Matsuda*		Date  : June 5, 1988**/#include <stdio.h>#include <X11/Xlib.h>#include <X11/Xutil.h>#include "lispemul.h"#include "XVersion.h"#include "MyWindow.h"#define FALSE 0#define TRUE  !FALSE#define DISPLAY_MAX 65536*16*2		/* same magic number is */					/* in loadsysout.c      */extern char *Display_Name;extern int Auto_Repeat;extern char *Lisp_Screen_Size;Display *Xdisplay;Screen *Xscreen;Bool Backing_Store   , Save_Unders;char *Server_Vendor;int Version  , Revision  , Screen_Number  , Byte_Order  , Bitmap_Bit_Order  , Bitmap_Pad  , Bitmap_Unit  , Default_Depth  , Display_Height  , Display_Width  , LispDisplayWidth  , LispDisplayHeight;unsigned long Black_Pixel            , White_Pixel;Colormap Colors;MyWindow Root_Window;Open_Display(){#ifdef TRACE	printf( "TRACE: Open_Display()\n" );#endif	if( (Xdisplay = XOpenDisplay( Display_Name )) == NULL ) {		fprintf( stderr, "Open_Display: cannot connect to display #s0"			,XDisplayName(Display_Name));		exit(-1);	}#ifdef DEBUG    /****************************************************/    /* If debugging, set the X connection so that	*/    /* we run synchronized--so a debugger can		*/    /* 'stop in _XError' and know EXACTLY where		*/    /* an error got caused.				*/    /****************************************************/	XSynchronize(Xdisplay, 1);#endif DEBUG	Version          = ProtocolVersion( Xdisplay );	Revision         = ProtocolRevision( Xdisplay );	Server_Vendor    = ServerVendor( Xdisplay );	Byte_Order       = ImageByteOrder( Xdisplay );	Bitmap_Bit_Order = BitmapBitOrder( Xdisplay );	Bitmap_Pad       = BitmapPad( Xdisplay );	Bitmap_Unit      = BitmapUnit( Xdisplay );	Screen_Number    = DefaultScreen( Xdisplay );	Xscreen          = ScreenOfDisplay( Xdisplay, Screen_Number );	Backing_Store    = DoesBackingStore( Xscreen );	Save_Unders      = DoesSaveUnders( Xscreen );	Default_Depth	 = DefaultDepthOfScreen( Xscreen );	Black_Pixel      = BlackPixelOfScreen( Xscreen );	White_Pixel      = WhitePixelOfScreen( Xscreen );	Colors           = DefaultColormapOfScreen( Xscreen );	Root_Window.win  = RootWindowOfScreen( Xscreen );	Display_Width    = WidthOfScreen( Xscreen );	Display_Height   = HeightOfScreen( Xscreen );	/* Size of ScreenBitMap */	LispDisplayWidth  = Display_Width  * PERCENT_OF_SCREEN / 100;	LispDisplayHeight = Display_Height * PERCENT_OF_SCREEN / 100; 	if( Lisp_Screen_Size[0] != '\0' ) { /* specified in command line */		int bitmask		  , temp_x		  , temp_y;		bitmask = XParseGeometry( Lisp_Screen_Size						, &temp_x						, &temp_y						, &LispDisplayWidth						, &LispDisplayHeight );	} /* end if */	/* adjust word boundary */	LispDisplayWidth += (BITSPER_DLWORD -1);	LispDisplayWidth -= (LispDisplayWidth % BITSPER_DLWORD);	if( (LispDisplayWidth * LispDisplayHeight ) > DISPLAY_MAX ) {		LispDisplayHeight = DISPLAY_MAX / LispDisplayWidth;	} /* end if */	/* Keyboard Auto Repeat */	if( Auto_Repeat ) {		XAutoRepeatOn( Xdisplay );	} else {		XAutoRepeatOff( Xdisplay );	} /* end if */} /* end OpenDisplay */