/* This is G-file @(#) typeof.c Version 2.3 (5/27/88). copyright Xerox & Fuji Xerox  */static char *id = "@(#) typeof.c	2.3 5/27/88";/* *	Copyright (C) 1987 by Fuji Xerox Co., Ltd. All rights reserved. * *	File   : typeof.c *	Auther :  Takeshi Shimizu	** ADOPTED NEW VERSION * *//****************************************************************//* LISTP(3Q),NTYPEX(4Q),TYPEP(5Q),DTEST(6Q) ,INSTANCEP(303Q)    *//****************************************************************//*				changed : Jan. 13 1987 take				changed : Feb. 05 1987 take				changed : Jul. 24 1987 take*/#include "lispemul.h"#include "lisptypes.h"#include "cell.h"#include "lispmap.h"extern DLword *Atomspace;extern int TopOfStack;extern DLword *CurrentStackPTR ;extern ByteCode *PC ;extern DLword  *MDStypetbl;extern DLword  *Spospspace;extern DLword *DTDspace ;#ifdef C_ONLYOP_dtest(){ /* This OPcode takes 2 arguments that is atom index. */ register unsigned int scratch; register struct dtd *dtd68k ;#ifdef TRACE	printPC();	printf("TRACE: OP_dtest()\n");#endif   scratch = (Get_BYTE(PC+1) << 8 )| (Get_BYTE(PC+2));  for(dtd68k=(struct dtd *) GetDTD(GetTypeNumber(TopOfStack));	scratch != dtd68k->dtd_name ;	dtd68k=(struct dtd *) GetDTD(dtd68k->dtd_supertype))	{		if( dtd68k->dtd_supertype == 0) {			ufn(06);			return ; }	} PC += 3;} /* OP_DTEST END */#elseLispPTR N_OP_dtest(tos, atom_index, error_addr)	register LispPTR tos;	register int atom_index;	int *error_addr;{ register struct dtd *dtd68k ;#ifdef TRACE	printf("TRACE: N_OP_dtest()\n");#endif    for(dtd68k=(struct dtd *) GetDTD(GetTypeNumber(tos));	atom_index != dtd68k->dtd_name ;	dtd68k=(struct dtd *) GetDTD(dtd68k->dtd_supertype))	{		if( dtd68k->dtd_supertype == 0) ERROR_EXIT(error_addr);	} return(tos);} /* OP_DTEST END */#endifLispPTR N_OP_instancep(tos, atom_index)	register LispPTR tos;	register int atom_index;{ register unsigned int type ; register struct dtd *dtd68k ;#ifdef TRACE	printf("TRACE: N_OP_instancep()\n");#endiffor(  dtd68k=(struct dtd *)GetDTD(GetTypeNumber(tos));	atom_index != dtd68k->dtd_name ;	dtd68k=(struct dtd *)GetDTD(dtd68k->dtd_supertype) )	{		if( dtd68k->dtd_supertype== 0) { return(NIL_PTR); }	} return(ATOM_T);} /* N_OP_instancep END */