h42256s 00000/00000/00131d D 1.7 93/02/08 14:43:47 sybalsky 7 6c Big VM (and new CDR coding) changes for 3.0 \nes 00000/00001/00131d D 1.6 92/06/09 16:17:58 sybalsky 6 5c Remove erroneously-copied code line from a comment (line 69)es 00005/00001/00127d D 1.5 92/05/27 19:11:42 sybalsky 5 4c fixing SCCS headers \nes 00000/00000/00128d D 1.4 92/05/27 18:08:58 nilsson 4 3c no changeses 00008/00006/00120d D 1.3 92/04/27 18:42:43 nilsson 3 2c Fix of Xdisplay deps.es 00000/00002/00126d D 1.2 92/04/23 16:29:00 nilsson 2 1c New short name regimen. Improved X commandline handlinges 00128/00000/00000d D 1.1 92/04/21 15:27:29 sybalsky 1 0c date and time created 92/04/21 15:27:29 by sybalskyeuUf e 0tTI 1/* %Z% %M% Version %I% (%G%). copyright venue & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%	(venue & Fuji Xerox)";D 2/* %Z% %M% Version %I% (%G%). copyright venue & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%	(venue & Fuji Xerox)";E 2/**** Copyright (C) 1988 by Fuji Xerox co.,Ltd. All rights reserved.**		Author: Mitsunori Matsuda*		Date  : August 11, 1988**//************************************************************************//*									*//*	Copyright 1989, 1990 Venue, Fuji Xerox Co., Ltd, Xerox Corp.	*//*									*//*	This file is work-product resulting from the Xerox/Venue	*//*	Agreement dated 18-August-1989 for support of Medley.		*//*									*//************************************************************************/#include <stdio.h>#include <X11/Xlib.h>#include <X11/Xutil.h>#include "XVersion.h"#include "MyWindow.h"#include "dbprint.h"#define FALSE 0#define TRUE  !FALSEextern Display *Xdisplay;extern XImage XScreenBitmap;extern MyWindow Lisp_Window	      , Display_Window;extern DisplayArea ScreenRegion;D 3#define Xbitblt(x,y,w,h)			\E 3I 3#define Xbitblt(display, x,y,w,h)			\E 3  {						\D 3    XPutImage( Xdisplay, Display_Window.win,	\E 3I 3D 5    XPutImage( display, Display_Window.win,	\E 5I 5    XLOCK;									\	XPutImage( display, Display_Window.win,	\E 5E 3	       *(Display_Window.gc),		\	       &XScreenBitmap,			\	       x , y, x - ScreenRegion.left_x,	\	      y - ScreenRegion.top_y, w, h );	\I 5	XFlush(display);						\	XUNLOCK;								\E 5  } /************************************************************************/I 5D 6    XPutImage( display, Display_Window.win,	\E 6E 5/*									*//*		    c l i p p i n g _ X b i t b l t			*//*									*//*	BITBLT from the display region to the X server's display,	*//*	clipping to fit the window we're in on the server.		*//*									*//************************************************************************/clipping_Xbitblt(x,y,w,h)  int x, y, w, h;  {     int temp_x, temp_y;     TPRINT(( "TRACE: clipping_Xbitblt()\n" ));    temp_x = x + w - 1;     temp_y = y + h - 1;     if ( (temp_x < ScreenRegion.left_x) 	 || (x > ScreenRegion.right_x) 	 || (temp_y < ScreenRegion.top_y) 	 || (y > ScreenRegion.bottom_y)) return; 	    if ( ( x >= ScreenRegion.left_x ) 	 && ( temp_x <= ScreenRegion.right_x ) 	 && ( y >= ScreenRegion.top_y ) 	 && ( temp_y <= ScreenRegion.bottom_y ) )      { D 3	Xbitblt( x, y, w, h ); E 3I 3	Xbitblt(Xdisplay, x, y, w, h ); E 3	return;       }     if ( x < ScreenRegion.left_x )      { 	w -= ScreenRegion.left_x - x; 	x = ScreenRegion.left_x;       }     if ( temp_x > ScreenRegion.right_x ) w -= temp_x - ScreenRegion.right_x;      if ( y < ScreenRegion.top_y )      { 	h -= ScreenRegion.top_y - y; 	y = ScreenRegion.top_y;       }     if ( temp_y > ScreenRegion.bottom_y ) h -= temp_y - ScreenRegion.bottom_y;  D 3    if ((w>0) && (h>0)) Xbitblt( x, y, w, h ); E 3I 3    if ((w>0) && (h>0)) Xbitblt(Xdisplay, x, y, w, h ); E 3  } /* end clipping_Xbitblt *//************************************************************************//*									*//*			r e f r e s h _ X s c r e e n			*//*									*//*	Redisplay the X display completely.				*//*									*//************************************************************************/D 3refresh_Xscreen()E 3I 3refresh_Xscreen(display)     Display *display;E 3  {    TPRINT(( "TRACE: refresh_Xscreen()\n" ));D 3    Xbitblt( ScreenRegion.left_xE 3I 3    Xbitblt( display,	    ScreenRegion.left_xE 3	   , ScreenRegion.top_y	   , Display_Window.width	   , Display_Window.height );  } /* end refresh_Xscreen */E 1