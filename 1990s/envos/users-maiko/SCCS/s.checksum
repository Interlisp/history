h49149s 00033/00015/00045d D 1.2 91/01/23 16:52:39 gadener 2 1c Trimmed down output messageses 00060/00000/00000d D 1.1 89/01/12 18:49:50 shih 1 0c date and time created 89/01/12 18:49:50 by shiheuUtTI 1#! /bin/sh # First line invokes Bourne shell# ============================================================================# ABSTRACT:#	Bourne script for checking/generating checksums for files contained#	in a specific Medley release directory. Should normally be invoked#	by ldechecksum and expects the calling script to be connected to#	the medley installation directory. Also, expects the directory#	<medleydir>checksumdir to exist. "< W > ..." warning and "< E > ..."#	error messages will be issued.## SYNOPSIS:D 2#	checksum -cg dir fileE 2I 2#	checksum -cg dirE 2##	-c	generates a FOO.check file and compares it to FOO.sum.#	-g	generates a FOO.sum file.#	NOTE: One of -c or -g is required.#	dir	the name of the Medley release directory containing files#		for which checksum checking/generating will be performed.D 2#	file	the name of the generated checksumfile. It will be created#		under <medleydir>/checksumdir E 2## CHANGES:D 2#	11-23-88 Carl Gadener & Larry Harada : Creation of scriptE 2I 2#	05-05-89 Carl Gadener : added "trap" to delete created file if #				interrupted. Also "FOO.check" files are now#				deleted after being used.E 2#	12-14-88 Carl Gadener : Had to rewrite it for Bourne shell becauseD 2#		the "foreach" loop in csh doesn't accept enough argsE 2I 2#				the "foreach" loop in csh doesn't accept#				enough args.E 2# ============================================================================#D 2if test $# -lt 3E 2I 2if test $# -lt 2E 2thenD 2   echo "Usage: checksum -cg dir file"E 2I 2   echo "Usage: checksum -cg dir"E 2   exit 2I 2E 2else   case $1 inD 2      -c) suffix=check ;;      -g) suffix=sum ;;      *) echo "Usage: checksum -cg dir file"E 2I 2      -c) suffix="check"	  operation="Verifying"	  ;;      -g) suffix="sum"	  operation="Generating checksum for"	  ;;      *) echo "Usage: checksum -cg dir"E 2         exit 2 ;;   esacfiif test -d $2then   resultdir=`pwd`/checksumdirI 2   resultfile=`echo "$2" | sed s/\\\//-/g`	   # If interrupted be sure to delete created file   trap "/bin/rm -f $resultdir/$resultfile.$suffix ; exit" 1 2 3 15E 2   cd $2D 2   echo "Checking: `pwd`"   /bin/rm -f $resultdir/$3.$suffixE 2I 2   echo "$operation: $2"   echo "Checksum for directory: $2" > $resultdir/$resultfile.$suffix   echo "" >> $resultdir/$resultfile.$suffixE 2   for file in  `/bin/ls -FL | /bin/grep -v "/" `   doD 2      echo "E > `sum $file` $file" >>$resultdir/$3.$suffixE 2I 2      echo "E > `sum $file` $file" >> $resultdir/$resultfile.$suffixE 2   doneD 2   if test "$1" = "-c"E 2I 2   if test "$1" = "-c"	# VerifyingE 2   thenD 2      /bin/diff $resultdir/$3.sum $resultdir/$3.check | grep "<"E 2I 2      /bin/diff $resultdir/$resultfile.sum \		$resultdir/$resultfile.check | grep "<"   # Remove check-file after check has been done   /bin/rm -f $resultdir/$resultfile.checkE 2   fielse  echo "< W > `pwd`/$2 : Directory not installed"fiI 2E 2E 1