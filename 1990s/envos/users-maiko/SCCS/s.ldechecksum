h31476s 00071/00045/00099d D 1.2 91/01/23 16:54:32 gadener 2 1c Now handles install.sunos4.1es 00144/00000/00000d D 1.1 89/01/12 18:50:03 shih 1 0c date and time created 89/01/12 18:50:03 by shiheuUtTI 1#! /bin/sh# First line invokes Bourne shell# ============================================================================# ABSTRACT:#	Bourne script for checking/generating checksums files for the#	Medley release. The script will generate a checksum-file for each#	release directory, containing the corresponding checksums for all#	files residing in the directory. The files having incorrect#	checksums will be reported with a message. The checksum-files will#	be put under:#	<medleydir>/checksumdir (Normally /usr/local/lde/checksumdir).#	## SYNOPSIS:D 2#	ldechecksum [-cg] [ medleydir ] [ dir | dirgroup ]E 2I 2#	ldechecksum [-cg]  medleydir  [ dir | dirgroup ]E 2#D 2#	-c 	compare checksumfiles "FOO.check" (default).E 2I 2#	-c 	compare checksumfiles "FOO.check" with "FOO.sum" (default).E 2#	-g 	generate checksumfiles "FOO.sum".D 2#	medleydir is the name of the Medley installation directory (defaultE 2I 2#	medleydir is the name of the Medley installation directory (normallyE 2#		is "/usr/local/lde").#	dir	can be any specific directory residing under medleydir. Only#		relative pathnames with respect to medleydir are accepted.D 2#	dirgroup can be either "all" (default) or "lisp" which means the #		"install", "lisplibrary" and "lispsysouts" directories.E 2I 2#	dirgroup can be either "all" (default), "fonts" or "lisp" which#		means the "install.sunosX", "lisplibrary" and "lispsysouts" #		directories.E 2## CHANGES:D 2#	12-12-88 Carl Gadener & Larry Harada : Creation of scriptE 2I 2#	08-23-90 Carl Gadener : Added install.sunos4.1#	05-05-89 Carl Gadener : Added lispusers as an option#	03-30-89 Carl Gadener : Added fonts and fonts/press#	01-19-89 Carl Gadener : Parameter "medleydir" is now mandatory. Also#				check that "checksum" files were installed.#	12-22-88 Carl Gadener : Compressed the big "case $dirspec" statementE 2#	12-15-88 Carl Gadener : Rewrote it for Bourne shell due to limitation#				factors in CSHD 2#	12-22-88 Carl Gadener : Compressed the big "case $dirspec" statementE 2I 2#	12-12-88 Carl Gadener & Larry Harada : Creation of scriptE 2# ============================================================================## First case statement checks arguments to ldechecksumcase $# inD 2  0) arg="-c"     medleydir="/usr/local/lde"     dirspec=all     break ;;E 2I 2  0) echo "Usage: ldechecksum [ -cg ] medleydir [ dir | dirgroup ] "     exit 1 ;;E 2  1) case $1 inD 2       -[c,g]) arg=$1	   medleydir="/usr/local/lde"	   dirspec=all	   break ;;       -*) echo "Usage: ldechecksum [ -cg ] [ medleydir ] [ dir | dirgroup ] "E 2I 2       -*) echo "Usage: ldechecksum [ -cg ] medleydir [ dir | dirgroup ] "E 2           exit 1 ;;       *)  arg="-c"           medleydir=$1           dirspec=all           break ;;     esac ;;  [23])      case $1 inD 2       -[c,g]) arg=$1E 2I 2       -[cg]) arg=$1E 2           medleydir=$2           if test $# = 3           then              dirspec=$3           else             dirspec=all           fi           break  ;;D 2       -*) echo "Usage: ldechecksum [ -cg ] [ medleydir ] [ dir | dirgroup ] "E 2I 2       -*) echo "Usage: ldechecksum [ -cg ] medleydir [ dir | dirgroup ] "E 2           exit 1 ;;       *)  arg="-c"           medleydir=$1           if test $# = 2           then              dirspec=$2           else              echo "Unexpected arg: $3"              exit 1           fi           break  ;;     esac ;;D 2  *) echo "Usage: ldechecksum [ -cg ] [ medleydir ] [ dir | dirgroup ] "E 2I 2  *) echo "Usage: ldechecksum [ -cg ] medleydir [ dir | dirgroup ] "E 2     exit 1 ;;esacI 2#	Checking if the Medley directory existsE 2if test -d $medleydirthen    cd $medleydirD 2   if test -d checksumdirE 2I 2#	Checking that script is correctly installed   if test -d checksumdir \        -a -f checksumdir/ldechecksum \        -a -f checksumdir/checksumE 2   thenI 2      lispdirs="install.sunos3 install.sunos4 install.sunos4.1 lisplibrary lispsysouts"      fonts="JIS1 JIS2 chinese miscellaneous presentation printwheel \             publishing"      if test $arg = "-g"      then 	  operation="Generating"      else   #$arg = "-c"	  operation="Verifying"      fiE 2      case $dirspec in        all)          checksumdir/ldechecksum $arg `pwd` lisp          checksumdir/ldechecksum $arg `pwd` fonts/display          checksumdir/ldechecksum $arg `pwd` fonts/interpressI 2          checksumdir/ldechecksum $arg `pwd` fonts/pressE 2        ;;        lisp)	   echo "----------------------------------------------------"D 2           echo "Generating checksums for Lisp directories"E 2I 2           echo "$operation checksums for Lisp directories"E 2	   echo "----------------------------------------------------"D 2           for file in install lisplibrary lispsysoutsE 2I 2           for file in $lispdirsE 2           doD 2              checksumdir/checksum $arg $file $fileE 2I 2              checksumdir/checksum $arg $fileE 2           done        ;;        fonts)          checksumdir/ldechecksum $arg `pwd` fonts/display          checksumdir/ldechecksum $arg `pwd` fonts/interpressI 2          checksumdir/ldechecksum $arg `pwd` fonts/pressE 2        ;;D 2        fonts/display | fonts/interpress)E 2I 2        fonts/display | \	fonts/interpress)E 2	   fonttype=`basename $dirspec`	   echo "----------------------------------------------------"D 2           echo "Generating checksums for $fonttype font directories"E 2I 2           echo "$operation checksums for $fonttype font directories"E 2	   echo "----------------------------------------------------"D 2           for file in JIS1 JIS2 chinese miscellaneous presentation \                       printwheel publishingE 2I 2           for file in $fontsE 2           doD 2             checksumdir/checksum $arg fonts/$fonttype/$file $fonttype-$fileE 2I 2             checksumdir/checksum $arg $dirspec/$fileE 2       	   done        ;;D 2        install | lisplibrary | lispsysouts)           checksumdir/checksum $arg $dirspec $dirspecE 2I 2#	All Medley directories at the "lowest" level        install.sunos3 | \	install.sunos4 | \	install.sunos4.1 | \	lisplibrary | \	lispsysouts | \	lispusers | \        fonts/display/JIS1 | \	fonts/display/JIS2 | \	fonts/display/chinese | \        fonts/display/miscellaneous | \	fonts/display/presentation | \	fonts/display/printwheel | \	fonts/display/publishing | \        fonts/interpress/JIS1 | \	fonts/interpress/JIS2 | \	fonts/interpress/chinese | \	fonts/interpress/miscellaneous | \	fonts/interpress/presentation | \	fonts/interpress/printwheel | \	fonts/interpress/publishing | \	fonts/press)           checksumdir/checksum $arg $dirspecE 2	;;D 2        fonts/display/JIS1 | fonts/display/JIS2 | fonts/display/chinese | \        fonts/display/miscellaneous | fonts/display/presentation | \	fonts/display/printwheel | fonts/display/publishing)	   file=`basename $dirspec`           checksumdir/checksum $arg fonts/display/$file display-$file	;;        fonts/interpress/JIS1 | fonts/interpress/JIS2 | \	fonts/interpress/chinese | fonts/interpress/miscellaneous | \	fonts/interpress/presentation | fonts/interpress/printwheel | \	fonts/interpress/publishing)	   file=`basename $dirspec`           checksumdir/checksum $arg fonts/interpress/$file interpress-$file	;;        *) echo "$dirspec : No such directory/grouping under lde"E 2I 2        *) echo "$dirspec : No such directory/grouping under `pwd`"E 2            exit 1 ;;      esac   else D 2     echo "`pwd`/checksumdir : No such directory"E 2I 2     echo "`pwd`/checksumdir : No such directory or script incorrectly installed"E 2     exit 1   fielse   echo "$medleydir : No such directory"   exit 1fiE 1