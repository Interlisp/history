h43569s 00016/00023/00283d D 1.4 90/09/18 23:27:36 sybalsky 4 3c Retrofit changes from AIX, DEC3100, PS/2es 00203/00123/00103d D 1.3 90/08/21 17:13:29 sybalsky 3 2c Retrofit AIX changes from IBMes 00000/00000/00226d D 1.2 90/04/20 01:10:30 sybalsky 2 1c AIX:  shortening file names, bulk change.es 00226/00000/00000d D 1.1 90/03/01 15:33:09 osamu 1 0c date and time created 90/03/01 15:33:09 by osamueuUf e 0tTI 1/* %Z% %M% Version %I% (%G%). copyright venue & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%	(venue & Fuji Xerox)";/**** Copyright (C) 1988 by Fuji Xerox co.,Ltd. All rights reserved.**		Author: Mitsunori Matsuda*		Date  : September 5, 1988*/I 3/************************************************************************//*									*//*	Copyright 1989, 1990 Venue, Fuji Xerox Co., Ltd, Xerox Corp.	*//*									*//*	This file is work-product resulting from the Xerox/Venue	*//*	Agreement dated 18-August-1989 for support of Medley.		*//*									*//************************************************************************/E 3#include <stdio.h>#include <X11/Xlib.h>#include <X11/Xutil.h>I 4#include "dbprint.h"E 4#include "XVersion.h"#include "MyWindow.h"extern Display *Xdisplay;extern MyWindow Vert_Scroll_Bar	      , Horiz_Scroll_Bar;extern DisplayArea ScreenRegion;extern int LispDisplayWidth	 , LispDisplayHeight	 , Scroll_WidthI 4	 , Default_DepthE 4	 , Scroll_Border;I 4E 4extern MyWindow Lisp_Window;Pixmap ScrollBar_Pixmap = NULL;I 3/************************************************************************//*									*/I 4/*	        B e f o r e _ C r e a t e S c r o l l b a r		*/E 4/*									*/I 4/*	Called before a scroll bar is created for the X main window.	*/E 4/*									*/D 4/*									*//*									*/E 4/************************************************************************/E 3Before_CreateScrollbar( parent, child )D 4MyWindow *parent       , *child;E 4I 4  MyWindow *parent, *child;E 4D 3{	float temp;E 3I 3  {    float temp;E 3D 4#ifdef TRACED 3	printf( "TRACE: Before_CreateScrollbar()\n" );E 3I 3    printf( "TRACE: Before_CreateScrollbar()\n" );E 3#endifE 4I 4    TPRINT(( "TRACE: Before_CreateScrollbar()\n" ));E 4	D 3	child->border = 1; 			/* fixed width */E 3I 3    child->border = 1; 			/* fixed width */E 3D 3	if( child == &Vert_Scroll_Bar ) {E 3I 3    if( child == &Vert_Scroll_Bar )      {E 3D 4E 4D 3		int height;E 3I 3	int height;E 3/* commentedD 3		child->x     = 1 + child->border;E 3I 3	child->x     = 1 + child->border;E 3*/D 3		child->x     = child->border;		child->width = parent->width - 2*(1 + child->border);E 3I 3	child->x     = child->border;	child->width = parent->width - 2*(1 + child->border);E 3D 3		height = parent->parent->height 			- (Scroll_Width + 2*Scroll_Border) - 1;		temp = (float)ScreenRegion.top_y / (float)LispDisplayHeight;E 3I 3	height = parent->parent->height 		- (Scroll_Width + 2*Scroll_Border) - 1;	temp = (float)ScreenRegion.top_y / (float)LispDisplayHeight;E 3/* commentedD 3		child->y = (1 + child->border)				+ (int)((float)((height - Scroll_Border)							- 2*(1 + child->border))						* temp);E 3I 3	child->y = (1 + child->border)			+ (int)((float)((height - Scroll_Border)						- 2*(1 + child->border))					* temp);E 3*/D 3		child->y = child->border				+ (int)((float)((height - Scroll_Border)							- 2*child->border)						* temp);		temp = (float)height / (float)LispDisplayHeight;E 3I 3	child->y = child->border			+ (int)((float)((height - Scroll_Border)						- 2*child->border)					* temp);	temp = (float)height / (float)LispDisplayHeight;E 3/* commentedD 3		child->height = (int)((float)(height - 2*(1 + child->border)) E 3I 3	child->height = (int)((float)(height - 2*(1 + child->border)) E 3						* temp);*/D 3		child->height = (int)((float)(height - 2*child->border) 						* temp);E 3I 3	child->height = (int)((float)(height - 2*child->border) 					* temp);E 3D 3	} 	else if( child == &Horiz_Scroll_Bar ) {E 3I 3      }     else if( child == &Horiz_Scroll_Bar )      {E 3D 3		int width;E 3I 3	int width;E 3/* commentedD 3		child->y      = 1 + child->border;E 3I 3	child->y      = 1 + child->border;E 3*/D 3		child->y      = child->border;		child->height = parent->height - 2*(1 + child->border);E 3I 3	child->y      = child->border;	child->height = parent->height - 2*(1 + child->border);E 3D 3		width = parent->parent->width 			- (Scroll_Width + 2*Scroll_Border);		temp = (float)ScreenRegion.left_x / (float)LispDisplayWidth;E 3I 3	width = parent->parent->width 		- (Scroll_Width + 2*Scroll_Border);	temp = (float)ScreenRegion.left_x / (float)LispDisplayWidth;E 3/* commentedD 3		child->x = (1 + child->border)				+ (int)((float)((width - Scroll_Border)							- 2*(1 + child->border))						* temp);E 3I 3	child->x = (1 + child->border)			+ (int)((float)((width - Scroll_Border)						- 2*(1 + child->border))					* temp);E 3*/ D 3		child->x = child->border				+ (int)((float)((width - Scroll_Border)							- 2*child->border)						* temp);		temp = (float)width / (float)LispDisplayWidth;E 3I 3	child->x = child->border			+ (int)((float)((width - Scroll_Border)						- 2*child->border)					* temp);	temp = (float)width / (float)LispDisplayWidth;E 3/* commentedD 3		child->width = (int)((float)((width - Scroll_Border)							- 2*(1 + child->border))						* temp);E 3I 3	child->width = (int)((float)((width - Scroll_Border)						- 2*(1 + child->border))					* temp);E 3*/D 3		child->width = (int)((float)((width - Scroll_Border)E 3I 3	child->width = (int)((float)((width - Scroll_Border)E 3							- 2*child->border)						* temp) - 1;D 3	} /* end if */E 3I 3      } /* end if */E 3D 3} /* end Before_CreateScrollbar */E 3I 3  } /* end Before_CreateScrollbar */E 3I 3/************************************************************************//*									*//*									*//*									*//*									*//*									*//************************************************************************/E 3#include "Stipple.h"After_CreateScrollbar( parent, child )MyWindow *parent       , *child;D 3{E 3I 3  {E 3D 4#ifdef TRACED 3	printf( "TRACE: After_CreateScrollbar()\n" );E 3I 3    printf( "TRACE: After_CreateScrollbar()\n" );E 3#endifE 4I 4    TPRINT(( "TRACE: After_CreateScrollbar()\n" ));E 4D 3	XMapWindow( Xdisplay, child->win );E 3I 3    XMapWindow( Xdisplay, child->win );E 3D 3	if( !ScrollBar_Pixmap )		ScrollBar_Pixmap = XCreateBitmapFromData( Xdisplay							, Lisp_Window.win							, check_bits							, check_width							, check_height );E 3I 3D 4#ifndef AIXE 4I 4#ifdef NEVERE 4    if( !ScrollBar_Pixmap )	ScrollBar_Pixmap = XCreateBitmapFromData( Xdisplay						  , Lisp_Window.win						  , check_bits						  , check_width						  , check_height );E 3D 3	XSetWindowBackgroundPixmap( Xdisplay, child->win, ScrollBar_Pixmap );	XClearWindow( Xdisplay, child->win );E 3I 3#else    if (!ScrollBar_Pixmap)      ScrollBar_Pixmap = XCreatePixmapFromBitmapData( Xdisplay,						      Lisp_Window.win,						      check_bits,						      check_width,						      check_height,D 4						      0, 1, 8);#endif AIXE 4I 4						      1, 0, Default_Depth);#endif NEVERE 4E 3D 3} /* end After_CreateScrollbar */E 3I 3    XSetWindowBackgroundPixmap( Xdisplay, child->win, ScrollBar_Pixmap );    XClearWindow( Xdisplay, child->win );E 3I 3  } /* end After_CreateScrollbar *//************************************************************************//*									*//*									*//*									*//*									*//*									*//************************************************************************/E 3Before_ResizeScrollbar( window )MyWindow *window;D 3{	float temp;E 3I 3  {    float temp;E 3D 4#ifdef TRACED 3	printf( "TRACE: Before_ResizeScrollbar()\n" );E 3I 3    printf( "TRACE: Before_ResizeScrollbar()\n" );E 3#endifE 4I 4    TPRINT(( "TRACE: Before_ResizeScrollbar()\n" ));E 4	D 3	if( window == &Vert_Scroll_Bar ) {		int height;E 3I 3    if( window == &Vert_Scroll_Bar )      {	int height;E 3D 3		height = window->parent->parent->height 			- (Scroll_Width + 2*Scroll_Border);		temp = (float)ScreenRegion.top_y / (float)LispDisplayHeight;E 3I 3	height = window->parent->parent->height 		- (Scroll_Width + 2*Scroll_Border);	temp = (float)ScreenRegion.top_y / (float)LispDisplayHeight;E 3/* commentedD 3		window->y = (1 + window->border)				+ (int)((float)((height - Scroll_Border)						      - 2*(1 + window->border))						* temp);E 3I 3	window->y = (1 + window->border)			+ (int)((float)((height - Scroll_Border)					      - 2*(1 + window->border))					* temp);E 3*/D 3		window->y = window->border				+ (int)((float)((height - Scroll_Border)						      - 2*window->border)						* temp);		temp = (float)height / (float)LispDisplayHeight;E 3I 3	window->y = window->border			+ (int)((float)((height - Scroll_Border)					      - 2*window->border)					* temp);	temp = (float)height / (float)LispDisplayHeight;E 3/* commentedD 3		window->height = (int)((float)((height - Scroll_Border)						     - 2*(1 + window->border)) 						* temp);E 3I 3	window->height = (int)((float)((height - Scroll_Border)					     - 2*(1 + window->border)) 					* temp);E 3*/D 3		window->height = (int)((float)((height - Scroll_Border)						     - 2*window->border) 						* temp) - 1;E 3I 3	window->height = (int)((float)((height - Scroll_Border)					     - 2*window->border) 					* temp) - 1;E 3D 3	} 	else if( window == &Horiz_Scroll_Bar ) {		int width;E 3I 3      }     else if( window == &Horiz_Scroll_Bar )      {	int width;E 3D 3		width = window->parent->parent->width 			- (Scroll_Width + 2*Scroll_Border);		temp = (float)ScreenRegion.left_x / (float)LispDisplayWidth;E 3I 3	width = window->parent->parent->width 		- (Scroll_Width + 2*Scroll_Border);	temp = (float)ScreenRegion.left_x / (float)LispDisplayWidth;E 3/* commentedD 3		window->x = (1 + window->border)				+ (int)((float)((width - Scroll_Border)						- 2*(1 + window->border))						*temp);E 3I 3	window->x = (1 + window->border)			+ (int)((float)((width - Scroll_Border)					- 2*(1 + window->border))					*temp);E 3*/D 3		window->x = window->border				+ (int)((float)((width - Scroll_Border)						- 2*window->border)						*temp);		temp = (float)width / (float)LispDisplayWidth;E 3I 3	window->x = window->border			+ (int)((float)((width - Scroll_Border)					- 2*window->border)					*temp);	temp = (float)width / (float)LispDisplayWidth;E 3/* commentedD 3		window->width = (int)((float)((width - Scroll_Border)						- 2*(1 + window->border)) 						* temp);E 3I 3	window->width = (int)((float)((width - Scroll_Border)					- 2*(1 + window->border)) 					* temp);E 3*/D 3		window->width = (int)((float)((width - Scroll_Border)						- 2*window->border) 						* temp) - 1;E 3I 3	window->width = (int)((float)((width - Scroll_Border)					- 2*window->border) 					* temp) - 1;E 3D 3	} /* end if */E 3I 3      } /* end if */E 3D 3} /* Before_ResizeScrollbar */E 3I 3  } /* Before_ResizeScrollbar */E 3I 3/************************************************************************//*									*//*									*//*									*//*									*//*									*//************************************************************************/E 3After_ResizeScrollbar( window )D 3MyWindow *window;{E 3I 3  MyWindow *window;  {E 3D 4#ifdef TRACED 3	printf( "TRACE: After_ResizeScrollbar()\n" );E 3I 3    printf( "TRACE: After_ResizeScrollbar()\n" );E 3#endifE 4I 4    TPRINT(( "TRACE: After_ResizeScrollbar()\n" ));E 4	D 3	if( window == &Vert_Scroll_Bar ) {	} 	else { 	}E 3I 3    if( window == &Vert_Scroll_Bar )      {      }     else       {       }E 3D 3} /* After_ResizeScrollbar */E 3I 3  } /* After_ResizeScrollbar */E 3I 3/************************************************************************//*									*//*									*//*									*//*									*//*									*//************************************************************************/E 3Move_ScrollBar( direction )D 3int direction;{E 3I 3  int direction;  {E 3D 4#ifdef TRACED 3	printf( "TRACE: Reconf_ScrollBar()\" );E 3I 3    printf( "TRACE: Reconf_ScrollBar()\" );E 3#endifE 4I 4    TPRINT(( "TRACE: Reconf_ScrollBar()\n" ));E 4D 3	if( direction == VERTICAL ) {		ResizeWindow( &Vert_Scroll_Bar );	} else { /* direction == HORIZONTAL */		ResizeWindow( &Horiz_Scroll_Bar );	} /* end if(direction) */E 3I 3    if( direction == VERTICAL )      {	ResizeWindow( &Vert_Scroll_Bar );      }    else      { /* direction == HORIZONTAL */	ResizeWindow( &Horiz_Scroll_Bar );      } /* end if(direction) */E 3D 3} /* end Move_ScrollBar */E 3I 3  } /* end Move_ScrollBar */E 3E 1