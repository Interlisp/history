/* This is G-file @(#) arith.c Version 2.2 (5/27/88). copyright Xerox & Fuji Xerox  */static char *id = "@(#) arith.c	2.2 5/27/88";/* *	Copyright (C) 1987 by Fuji Xerox Co., Ltd. All rights reserved. * *	Auther	:	Hiroshi Hayata	 */#include <stdio.h>#include "lispemul.h"#include "lispglobal.h"#include "emulglobal.h"#include "address68k.h"#include "lispmap.h"#include "lisptypes.h"#include "arith.h"#ifdef C_ONLY#define	VAG2		0321/************************************************************OP_vag2	entry		VAG2		OPCODE[0321]	1.	<<Entrer>>		*CurrentStackPTR	:	High address (16 bit)		TopOfStack		:	Low address (16 bit)	2.	If size of both address is not proper, call error.	3.	produce address from *CurrentStackPTR and TopOfStack.		4.	increment PC.	5.	decrement CurrentStackPTR by 2.	6.	<<Exit>>		TopOfStack		:	produced address (24 bit)						Lisp Address************************************************************/OP_vag2(){#ifdef	TRACE	printPC();	printf("TRACE: OP_vag2()\n");#endif	if( (0xFFFF0000 & TopOfStack ) != S_POSITIVE ){#ifdef	DEBUG	printf("DEBUG: OP_vag2[Bad argument. Small number only.]\n");#endif		/**** call \VAG2 Lisp Func. ****/		ufn(VAG2);		return;	}/*CSP	if(*(CurrentStackPTR-1) != SPOS_HI){	*/	if(*(CurrentStackPTR) != SPOS_HI){#ifdef	DEBUG	printf("DEBUG: OP_vag2[Bad argument. Small number only.]\n");#endif		/**** call \VAG2 Lisp Func. ****/		ufn(VAG2);		return;	}	TopOfStack = (0xFFFF0000 & ((*(CurrentStackPTR+1)) << 16)) | (0xFFFF & TopOfStack);	CurrentStackPTR -= 2;	++PC;}#else/************************************************************N_OP_vag2	entry		VAG2		OPCODE[0321]	return ( (a << 16 ) | b)************************************************************/N_OP_vag2(a, b, error_addr)  register int a, b;  int *error_addr;{#ifdef	TRACE	printPC();	printf("TRACE: N_OP_vag2()\n");#endif	if( (0xFFFF0000 & a ) != S_POSITIVE ){#ifdef	DEBUG	printf("DEBUG: OP_vag2[Bad argument. Small number only.]\n");#endif		/**** call \VAG2 Lisp Func. ****/		ERROR_EXIT(error_addr);	}	if(0xFFFF0000 & b != S_POSITIVE){#ifdef	DEBUG	printf("DEBUG: OP_vag2[Bad argument. Small number only.]\n");#endif		/**** call \VAG2 Lisp Func. ****/		ERROR_EXIT(error_addr);	}	return((0xFFFF0000 & (a << 16)) | (0xFFFF & b));}#endif