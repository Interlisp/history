/* This is G-file @(#) common.c Version 2.7 (7/7/88). copyright Xerox & Fuji Xerox  */static char *id = "@(#) common.c	2.7 7/7/88";/* *	Copyright (C) 1987 by Fuji Xerox Co., Ltd. All rights reserved. * *	Auther	:	Hiroshi Hayata	 */#include	<stdio.h>#include  <setjmp.h>#include "lispemul.h"#include "lispmap.h"#include "address68k.h"#include "lispglobal.h"#include "emulglobal.h"#include <pixrect/pixrect_hs.h>stab(){#ifdef  DEBUG	printf("Now in stab\n");#endif}/***************************************************************error	common sub-routine.	Printout error message.	Enter URAID.	And exit.(takeshi)******************************************************************/#define URMAXFXNUM		100extern unsigned int LispReadFds,LispWindowFd,LispKbdFd;extern struct pixrect *ScreenBitMap,*CursorBitMap,*InvisibleCursorBitMap;extern struct screen LispScreen;extern int DisplayWidth,DisplayHeight;extern DLword *DisplayRegion68k;extern int FrameBufferFd; extern char URaid_inputstring[]; extern char URaid_comm; extern char URaid_arg1[256]; extern char URaid_arg2[10]; extern int URaid_argnum; extern char *URaid_errmess; extern  int URaid_currentFX; extern jmp_buf BT_jumpbuf; LispPTR Uraid_mess=NIL;/* Currentry Don't care Ether re-initial *//* Medley only */#define URMAXCOMM	512error(cp)char	*cp;{	char *ptr;	if(device_before_raid()<0) {		printf("Can't Enter URAID.\n");		exit(-1);	}	 /* comm read */	URaid_errmess=cp;	printf("\n*Error* %s\n",cp);	fflush(stdin);	printf("Enter the URaid\n");	print(Uraid_mess); putchar('\n');	URaid_currentFX=URMAXFXNUM +1;uraidloop: 	if(setjmp(BT_jumpbuf) == 1) goto uraidloop;	for(;;){ /* URAID LOOP */				uraid_commclear();		printf("\n< ");		for( ptr=URaid_inputstring;( *ptr= getchar() ) != '\n' ;			 ptr++) {} 		URaid_argnum = sscanf(URaid_inputstring,"%1s%s%s",&URaid_comm,URaid_arg1,URaid_arg2);		if(uraid_commands()==NIL) break; 		} /* for end */	/**TopOfStack = NIL;if error is called from subr TOS will be set NIL**/	if(device_after_raid() <0){		 printf("Can't return to Lisp. Return to UNIX?");		{int c;		 	c= getchar();		 	if((c=='Y')||(c=='y')) {				exit(-1);		  	}		}		fflush(stdin);		goto uraidloop;	}	return(0);}/** Warnning message */warn(s)char *s;{ printf("\nWARN: %s \n",s); }/*****************************************************************stackcheck	common sub-routine.	Not Implented.	1.check Stack overflow.		(check CurrentStackPTR)	2.if overflow, return T (not 0).	  Otherwise, return F (0).******************************************************************/stackcheck(){#ifdef	TRACE2	printf("TRACE:stackcheck()\n");#endif	return(0);}/*****************************************************************stackoverflow	common sub-routine.	Not Implented.	1.error handling of stack overflow.******************************************************************/stackoverflow(){#ifdef	TRACE2	printf("TRACE:stackoverflow()\n");#endif	printf("stackoverflow \n");}