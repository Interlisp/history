/* This is G-file @(#) Kprint.c Version 1.3 (5/8/88). copyright Xerox & Fuji Xerox  */static char *id = "@(#) Kprint.c	1.3 5/8/88";/* *	Copyright (C) 1987 by Fuji Xerox Co., Ltd. All rights reserved. *//* "print.c" edited by Hirofumi Komatsubara   *//***********//* 30 April 1987 *//* print litatom,list,smallp *//***********//* 9 Jun 1987 *//* print string *//* changed prindatum and added print_string */ /***********//* 2 July 1987 *//* print fixp *//* changed printdatum *//************//* Aug 14 87 Take enable to print newstring(Lyric) *//* 26 August 1987 *//* changing for debug tool *//* 6 May 1988 Modify for URAID by Take */#include	<stdio.h>#include	"print.h"#include	"address.h"#include	"lispemul.h"#include	"lisptypes.h"#include	"lispglobal.h"#include	"initatoms.h"#include	"cell.h"#include	"emulglobal.h"#include	"lispmap.h"#include	"address68k.h"int PrintMaxLevel= 2;int Printdepth=0;prindatum(x)LispPTR	x;{	NEWSTRINGP *newstring ;	struct dtd *dtd_base;	int	typen;	DLword	typename;	if(Printdepth > PrintMaxLevel)	{		if(GetTypeNumber(x)==TYPE_LISTP)		{			printf("(-)");		}		else			printf("*");		return;	}		switch (GetTypeNumber(x)) {	case TYPE_LITATOM:			print_atomname(x);			break;	case	TYPE_LISTP:			Printdepth++;			printf("%c" , LEFT_PAREN);		/* print "(" */			lp:	prindatum(car(x));				if (Listp (cdr(x)) == 0) {	/* print doted pair */					if ((x = cdr(x)) != NIL) {							printf(" . ");							prindatum(x);							}						}				else					{					printf("%c" , SPACE);					x = cdr(x);					goto lp;					}				printf("%c" , RIGHT_PAREN);	/* print ")" */				Printdepth--;			break;		case	TYPE_SMALLP:			if ((x & 0xff0000) == S_POSITIVE)				printf("%d" , LOLOC(x));	/* print positive smallp */				else										printf("%d" , (LOLOC(x) | 0xffff0000));	/* print negative smallp */			break;	case	TYPE_FIXP:			print_fixp(x);		/* print fixp  */			break;	case TYPE_STRINGP:			print_string(x);		/* print string */			break;	case TYPE_ONED_ARRAY :	case TYPE_GENERAL_ARRAY :			newstring=(NEWSTRINGP *)Addr68k_from_LADDR(x);			if(newstring->stringp){			  print_NEWstring(x);			  break; }	default: 		typen = GetTypeNumber(x);		dtd_base = (struct dtd *)GetDTD(typen);		printf("{");		if((typename = dtd_base->dtd_name) != 0)			print_atomname(typename);		else			printf("unknown");		printf("}0x");		printf("%x" , x);		/* print lispaddoress by hex */	}}LispPTR	print(x)LispPTR		x;{	Printdepth=0;	prindatum(x);	/* printf("\n"); */		/* print CR */	return (x);}print_string(x)LispPTR	x;{struct stringp	*string_point;DLword	st_length;DLbyte	*string_base;int		i;		string_point = (struct stringp *)Addr68k_from_LADDR(x);		st_length = string_point->length;		string_base = (DLbyte *)Addr68k_from_LADDR(string_point->base);		printf("%c" , DOUBLEQUOTE);	/* print %" */				for (i = 1 ; i <= st_length ; i++){			printf("%c" , *string_base);			string_base++;			}		printf("%c" , DOUBLEQUOTE);	/* print %" */}print_NEWstring(x)LispPTR	x;{NEWSTRINGP *string_point;DLword	st_length;DLbyte	*string_base;int		i;/* STRING type in LYRIC by takeshi */		string_point = (NEWSTRINGP *)Addr68k_from_LADDR(x);		st_length = string_point->totalsize;		string_base = (DLbyte *)Addr68k_from_LADDR(string_point->base);		string_base += string_point->offset ;		printf("%c" , DOUBLEQUOTE);	/* print %" */				for (i = 0 ; i <= st_length ; i++){			printf("%c" , *string_base);			string_base++;			}		printf("%c" , DOUBLEQUOTE);	/* print %" */}print_fixp(x)LispPTR	x;{int	*addr_fixp;	addr_fixp = (int *)Addr68k_from_LADDR(x);	printf("%d" , *addr_fixp);}			