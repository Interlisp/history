h37270s 00016/00008/00143d D 1.6 92/11/25 21:06:11 sybalsky 6 5c Fixing endif's with extra text => comment. \nes 00008/00003/00143d D 1.5 92/04/27 18:46:35 nilsson 5 4c es 00000/00000/00146d D 1.4 92/04/21 17:16:37 sybalsky 4 3c shortening file names for DOS \nes 00006/00000/00140d D 1.3 90/06/26 14:49:15 sybalsky 3 2c Incorporate AIX changeses 00011/00003/00129d D 1.2 90/04/20 01:40:22 sybalsky 2 1c ortening file names, bulk change.es 00132/00000/00000d D 1.1 90/04/19 23:19:33 sybalsky 1 0c date and time created 90/04/19 23:19:33 by sybalskyeuUf e 0tTI 1/* %Z% %M% Version %I% (%G%). copyright venue & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%	(venue & Fuji Xerox)";D 2/* %Z% %M% Version %I% (%G%). copyright envos & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%";/*** ADOPTED NEW VERSION ***/E 2I 2/************************************************************************//*									*//*	Copyright 1989, 1990 Venue, Fuji Xerox Co., Ltd, Xerox Corp.	*//*									*//*	This file is work-product resulting from the Xerox/Venue	*//*	Agreement dated 18-August-1989 for support of Medley.		*//*									*//************************************************************************/E 2/* *	Copyright (C) 1987 by Fuji Xerox Co., Ltd. All rights reserved. * *	Author	:	Osamu Nakamura */#include <stdio.h>#include <sys/time.h>#include <sys/types.h>#include <sys/file.h>I 3#ifndef XWINDOWE 3#include <sundev/kbd.h>#include <sundev/kbio.h>#include <sunwindow/window_hs.h>I 3D 6#endif XWINDOWE 6I 6#endif /* XWINDOW */E 6E 3I 6E 6#include "lispemul.h"/**************************************************** * *	KB_enable() entry of SUBRCALL 82 1 *			called from (\KB_enable X) * ****************************************************/I 3#ifndef XWINDOWE 3extern struct screen LispScreen;I 3D 6#endif XWINDOWE 6I 6#endif /* XWINDOW */E 6I 6E 6I 5#ifdef XWINDOW#include <X11/Xlib.h>extern Display *Xdisplay;#endif /* XWINDOW */E 5E 3extern int LispWindowFd,	   LispReadFds;extern int errno;KB_enable( args )LispPTR	*args;		/* args[0] :	ON/OFF flag			 *		T -- ON			 *		NIL -- OFF			 */{	if( args[0] == ATOM_T )#ifdef SUNDISPLAY		LispReadFds |= 1<< LispWindowFd;D 6#endif SUNDISPLAYE 6I 6#endif /* SUNDISPLAY */E 6#ifdef XWINDOWD 5		enable_Xkeyboard();E 5I 5		enable_Xkeyboard(Xdisplay);E 5D 6#endif XWINDOWE 6I 6#endif /* XWINDOW */E 6	else if( args[0] == NIL )#ifdef SUNDISPLAY		LispReadFds &= ~(1 << LispWindowFd);D 6#endif SUNDISPLAYE 6I 6#endif /* SUNDISPLAY */E 6#ifdef XWINDOWD 5		disable_Xkeyboard();E 5I 5		disable_Xkeyboard(Xdisplay);E 5D 6#endif XWINDOWE 6I 6#endif /* XWINDOW */E 6	else{		error("KB_enable: illegal arg \n");		printf("KB_enable: arg = %d\n", args[0] );	}}/**************************************************** * *	KB_beep() entry of SUBRCALL 80 2 *			called from (\KB_beep SW FREQ) * ****************************************************//*struct timeval belltime ={	0,100};*/extern int LispKbdFd;KB_beep( args )LispPTR	*args;		/* args[0] :	ON/OFF flag			 *		T -- ON			 *		NIL -- OFF			 * args[1] :	frequency			 */{	int keycommand;#ifdef SUNDISPLAY/*	belltime.tv_usec = args[1] & 0xffff;	win_bell(LispWindowFd, belltime, 0);*/	if( (LispKbdFd = open( LispScreen.scr_kbdname, O_RDWR)) == -1)		fprintf( stderr, "can't open %s, errno=%d\n",			LispScreen.scr_kbdname, errno);	if( args[0] == ATOM_T ){		keycommand = KBD_CMD_BELL;	/* Turn on the bell */		if(ioctl( LispKbdFd, KIOCCMD, &keycommand)== -1)			fprintf( stderr, "Error at ioctl errno =%d\n", errno);	}	else{		keycommand = KBD_CMD_NOBELL;	/* Turn off the bell */		if(ioctl( LispKbdFd, KIOCCMD, &keycommand)== -1)			fprintf( stderr, "Error at ioctl errno =%d\n", errno);	}	close( LispKbdFd );D 6#endif SUNDISPLAYE 6I 6#endif /* SUNDISPLAY */E 6I 6E 6#ifdef XWINDOW	if( args[0] == ATOM_T ) D 5		beep_Xkeyboard();E 5I 5		beep_Xkeyboard(Xdisplay);E 5D 6#endif XWINDOWE 6I 6#endif /* XWINDOW */E 6}/**************************************************** * *	KB_setmp() entry of SUBRCALL 81 1 *			called from (\KB_setMP MPCODE) * ****************************************************/KB_setmp( args )LispPTR	*args;		/* args[0] :	MPCODE	*/{#ifdef  DEBUG	printf("MP: %d\n", args[0] & 0xffff );#endif}E 1