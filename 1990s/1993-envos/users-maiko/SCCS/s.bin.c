h22121s 00004/00004/00060d D 2.6 92/04/21 17:04:44 sybalsky 11 10c shortening file names for DOS \nes 00000/00000/00064d D 2.5 90/04/20 01:21:29 sybalsky 10 9c AIX:  shortening file names, bulk change.es 00023/00016/00041d D 2.4 90/02/19 11:10:51 sybalsky 9 8c check for 386i, add commentses 00004/00058/00053d D 2.3 88/10/12 14:40:41 krivacic 8 7c new out-of-line interfacees 00008/00003/00103d D 2.2 88/05/31 16:03:38 masinter 7 6c make the old-style OP_bin in a C_ONLY ifdefes 00000/00000/00106d D 2.1 88/05/17 09:22:20 hayata 6 5c Version up to 2.1es 00003/00006/00103d D 1.5 88/04/26 17:33:15 shimizu 5 4c BINABLE never punt, and FIX N-I/F increment COFFSETes 00002/00002/00107d D 1.4 88/04/21 18:22:44 masinter 4 3c yes 00030/00000/00079d D 1.3 88/03/18 17:57:02 krivacic 3 2c Added N_OP_bines 00002/00002/00077d D 1.2 88/03/13 14:33:05 hayata 2 1c Add SCCS key id (%Z%)es 00079/00000/00000d D 1.1 88/02/24 16:55:48 hayata 1 0c date and time created 88/02/24 16:55:48 by hayataeuUtTI 1D 2/* This is G-file %M% Version %I% (%G%). copyright Xerox & Fuji Xerox  */static char *id = "%M%	%I% %G%";E 2I 2D 4/* This is G-file %Z% %M% Version %I% (%G%). copyright Xerox & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%";E 4I 4D 7/* This is G-file @(#) bin.c Version 1.3 (3/18/88). copyright Xerox & Fuji Xerox  */static char *id = "@(#) bin.c	1.3 3/18/88";E 7I 7D 9/* This is G-file %Z% %M% Version %I% (%G%). copyright Xerox & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%";E 7E 4E 2/* *	Copyright (C) 1987 by Fuji Xerox Co., Ltd. All rights reserved. *D 7 *	Auther :  Takeshi ShimizuE 7I 7 *	Author :  Takeshi ShimizuE 7 * */E 9I 9/* This is G-file @(#) bin.c Version 2.3 (10/12/88). copyright Xerox & Fuji Xerox  */static char *id = "@(#) bin.c	2.3 10/12/88";/************************************************************************//*									*//*	Copyright 1989, 1990 Venue, Fuji Xerox Co., Ltd, Xerox Corp.	*//*									*//*	This file is work-product resulting from the Xerox/Venue	*//*	Agreement dated 18-August-1989 for support of Medley.		*//*									*//************************************************************************/E 9/***********************************************************************//* 		File Name :	bin.c		Desc	:	  				Date :		Jul. 22, 1987 				Edited by :	Takeshi Shimizu				Changed :	 		Including :	OP_bin							*//**********************************************************************/#include "lispemul.h"#include "lispmap.h"D 11#include "emulglobal.h"#include "lispglobal.h"#include "lisptypes.h"E 11I 11#include "emlglob.h"#include "lspglob.h"#include "lsptypes.h"E 11#include "address.h"D 11#include "address68k.h"E 11I 11#include "adr68k.h"E 11#include "cell.h" #include "stream.h"  I 7D 8#ifdef C_ONLYE 7/**********************************************************************//*		Func name :	OP_bin			Date :		Jul. 22, 1987			Edited by :	Take			changed by :	HAYATA(Sep-01-87)*//**********************************************************************/OP_bin(){register Stream *stream68k; /* stream instance on TOS */register  char *buff68k;     /* pointer to BUFF */  if(GetTypeNumber(TopOfStack) == TYPE_STREAM)   {	stream68k=(Stream *) Addr68k_from_LADDR(TopOfStack);D 5	if(stream68k->BINABLE){E 5I 5	if(!stream68k->BINABLE){E 5		ufn(040);		return;	}	if(stream68k->COFFSET >= stream68k->CBUFSIZE){		/* end of stream */		ufn(040);		return;	}	/* get BUFFER instance */	buff68k =(char *)Addr68k_from_LADDR(stream68k->CBUFPTR);	/* get BYTE data and set it to TOS */	TopOfStack= S_POSITIVE | (Get_BYTE(buff68k + stream68k->COFFSET)) ;	stream68k->COFFSET++; /* increment offset */	PC++;   }  else  {	ufn(040);	return;  }}I 3I 7#elseE 7N_OP_bin(tos, error_addr)E 8I 8N_OP_bin(tos)E 8D 9	register int tos;D 8	int *error_addr;E 8{register Stream *stream68k; /* stream instance on TOS */register  char *buff68k;     /* pointer to BUFF */E 9I 9  register int tos;  {    register Stream *stream68k; /* stream instance on TOS */    register  char *buff68k;     /* pointer to BUFF */E 9D 9  if(GetTypeNumber(tos) == TYPE_STREAM)   {E 9I 9   if(GetTypeNumber(tos) == TYPE_STREAM)      {E 9	stream68k=(Stream *) Addr68k_from_LADDR(tos);D 5	if(stream68k->BINABLE) ERROR_EXIT(error_addr);E 5I 5D 8	if(!stream68k->BINABLE) ERROR_EXIT(error_addr);E 8I 8	if(!stream68k->BINABLE) ERROR_EXIT(tos);E 8E 5D 8	if(stream68k->COFFSET >= stream68k->CBUFSIZE) ERROR_EXIT(error_addr);E 8I 8	if(stream68k->COFFSET >= stream68k->CBUFSIZE) ERROR_EXIT(tos);E 8		/* get BUFFER instance */	buff68k =(char *)Addr68k_from_LADDR(stream68k->CBUFPTR);	/* get BYTE data and set it to TOS */D 5	return(S_POSITIVE | (Get_BYTE(buff68k + stream68k->COFFSET)) );	stream68k->COFFSET++; /* increment offset */E 5I 5	return(S_POSITIVE | (Get_BYTE(buff68k + (stream68k->COFFSET)++)) );E 5D 9   }D 8  else ERROR_EXIT(error_addr);E 8I 8  else ERROR_EXIT(tos);E 9I 9      }    else ERROR_EXIT(tos);E 9E 8  }D 8I 7#endifE 8E 7E 3E 1