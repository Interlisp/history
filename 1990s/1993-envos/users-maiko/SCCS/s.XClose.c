h56046s 00002/00001/00131d D 1.6 92/11/25 21:01:01 sybalsky 6 5c Fixing endif's with extra text => comment. \nes 00001/00001/00131d D 1.5 92/04/27 18:38:35 nilsson 5 4c Fix of Xdisplay deps.es 00002/00002/00130d D 1.4 92/04/21 16:57:26 sybalsky 4 3c shortening file names for DOS \nes 00086/00052/00046d D 1.3 92/01/16 12:28:56 sybalsky 3 2c es 00013/00002/00085d D 1.2 90/04/20 01:11:49 sybalsky 2 1c   shortening file names, bulk change.es 00087/00000/00000d D 1.1 90/04/19 23:18:26 sybalsky 1 0c date and time created 90/04/19 23:18:26 by sybalskyeuUf e 0tTI 1/* %Z% %M% Version %I% (%G%). copyright venue & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%	(venue & Fuji Xerox)";D 2/* %Z% %M% Version %I% (%G%). copyright venue & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%	(venue & Fuji Xerox)";E 2I 2/************************************************************************//*									*/D 3/*	Copyright 1989, 1990 Venue, Fuji Xerox Co., Ltd, Xerox Corp.	*/E 3I 3/*	(C) Copyright 1989, 1990, 1991 Venue. All Rights Reserved.	*//*	Manufactured in the United States of America.			*/E 3/*									*/D 3/*	This file is work-product resulting from the Xerox/Venue	*//*	Agreement dated 18-August-1989 for support of Medley.		*/E 3I 3/*	The contents of this file are proprietary information 		*//*	belonging to Venue, and are provided to you under license.	*//*	They may not be further distributed or disclosed to third	*//*	parties without the specific permission of Venue.		*/E 3/*									*//************************************************************************/E 2D 3/**** Copyright (C) 1988 by Fuji Xerox co.,Ltd. All rights reserved.**		Author: Mitsunori Matsuda*		Date  : August 18, 1988*/E 3I 3E 3#include <stdio.h>I 3#ifdef ISC#include <sys/bsdtypes.h>#include <stropts.h>#include <sys/ioctl.h>D 6#endif ISCE 6I 6#endif /* ISC */E 6E 3#include <X11/Xlib.h>#include <X11/Xutil.h>#include "XVersion.h"#include "MyWindow.h"I 3#include "dbprint.h"E 3#define FALSE 0#define TRUE  !FALSEextern Display *Xdisplay;extern MyWindow Lisp_Window	      , Display_Window	      , Vert_Scroll	      , Horiz_Scroll	      , Grav_Window[];extern int Lisp_Xinitialized;I 3extern int Xfd;E 3I 3/************************************************************************//*									*//*			l i s p _ X e x i t				*//*									*//*	Turn off the X window we've been using for display.		*//*									*//************************************************************************/E 3lisp_Xexit()D 3{#ifdef TRACE	printf( "TRACE: lisp_Xexit()\n" );#endifE 3I 3  {    TPRINT(( "TRACE: lisp_Xexit()\n" ));E 3D 3	XDestroySubwindows( Xdisplay, Lisp_Window.win );	XDestroyWindow( Xdisplay, Lisp_Window.win );	XCloseDisplay( Xdisplay );E 3I 3#ifdef ISC    ioctl(Xfd, I_SETSIG, 0); /* so no interrupts happen during */#endif ISC			/* the following code.... */    XDestroySubwindows( Xdisplay, Lisp_Window.win );    XDestroyWindow( Xdisplay, Lisp_Window.win );    XCloseDisplay( Xdisplay );E 3	D 3	Lisp_Xinitialized = FALSE;} /* end lisp_Xexit */E 3I 3    Lisp_Xinitialized = FALSE;  } /* end lisp_Xexit */E 3I 3/************************************************************************//*									*//*		    X e v e n t _ b e f o r e _ r a i d			*//*									*//*	Called before Medley enters URAID, to turn off events in	*//*	the X windows we use for Medley's display.			*//*									*//************************************************************************/E 3Xevent_before_raid()D 3{#ifdef TRACE	printf( "TRACE: Xevent_before_raid()\n" );#endifE 3I 3  {    TPRINT(( "TRACE: Xevent_before_raid()\n" ));E 3D 3	XSelectInput( Xdisplay, Lisp_Window.win,    NoEventMask );	XSelectInput( Xdisplay, Display_Window.win, NoEventMask );	XSelectInput( Xdisplay, Vert_Scroll.win,    NoEventMask );	XSelectInput( Xdisplay, Horiz_Scroll.win,  NoEventMask );	{ int i;	  for( i ; i<4 ; i++ ) {		XSelectInput( Xdisplay				, Grav_Window[i].win				,  NoEventMask );E 3I 3    XSelectInput( Xdisplay, Lisp_Window.win,    NoEventMask );    XSelectInput( Xdisplay, Display_Window.win, NoEventMask );    XSelectInput( Xdisplay, Vert_Scroll.win,    NoEventMask );    XSelectInput( Xdisplay, Horiz_Scroll.win,  NoEventMask );      { int i;D 4	for( i ; i<4 ; i++ )E 4I 4	for( i=0 ; i<4 ; i++ )E 4	  {	    XSelectInput( Xdisplay, Grav_Window[i].win,  NoEventMask );E 3	  }D 3	}	XFlush( Xdisplay );E 3I 3      }    XFlush( Xdisplay );E 3D 3} /* end Xevent_before_raid */E 3I 3  } /* end Xevent_before_raid */E 3I 3/************************************************************************//*									*//*		    X e v e n t _ a f t e r _ r a i d			*//*									*//*	Called after Medley returns from URAID, to re-enable events	*//*	from the X server in the windows we use for the display.	*//*									*//************************************************************************/E 3Xevent_after_raid()D 3{#ifdef TRACE	printf( "TRACE: Xevent_after_raid()\n" );#endifE 3I 3  {    TPRINT(( "TRACE: Xevent_after_raid()\n" ));E 3D 3	XSelectInput( Xdisplay, Lisp_Window.win,    Lisp_Window.event_mask );	XSelectInput( Xdisplay, Display_Window.win, Display_Window.event_mask );	XSelectInput( Xdisplay, Vert_Scroll.win,    Vert_Scroll.event_mask );	XSelectInput( Xdisplay, Horiz_Scroll.win,  Horiz_Scroll.event_mask );	{ int i;	  for( i ; i<4 ; i++ ) {	    XSelectInput( Xdisplay			, Grav_Window[i].winE 3I 3    XSelectInput( Xdisplay, Lisp_Window.win,    Lisp_Window.event_mask );    XSelectInput( Xdisplay, Display_Window.win, Display_Window.event_mask );    XSelectInput( Xdisplay, Vert_Scroll.win,    Vert_Scroll.event_mask );    XSelectInput( Xdisplay, Horiz_Scroll.win,  Horiz_Scroll.event_mask );      { int i;D 4	for( i ; i<4 ; i++ )E 4I 4	for( i=0 ; i<4 ; i++ )E 4	  {	    XSelectInput( Xdisplay, Grav_Window[i].winE 3			, Grav_Window[i].event_mask );	  }D 3	}	refresh_Xscreen();	XFlush( Xdisplay );E 3I 3      }D 5    refresh_Xscreen();E 5I 5    refresh_Xscreen( Xdisplay );E 5    XFlush( Xdisplay );E 3D 3} /* end Xevent_before_raid */E 3I 3  } /* end Xevent_before_raid */E 3E 1