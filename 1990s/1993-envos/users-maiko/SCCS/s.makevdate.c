h15550s 00004/00004/00061d D 1.10 91/07/05 17:45:10 sybalsky 10 9c Make RISCOS changes be generic for SYSV-only systemses 00025/00008/00040d D 1.9 91/05/01 18:15:36 sybalsky 9 8c Retrofit changes from MIPS porting center.es 00029/00014/00019d D 1.8 91/01/25 18:02:44 sybalsky 8 7c Clean up codees 00000/00000/00033d D 1.7 90/04/20 01:50:06 sybalsky 7 6c AIX:  shortening file names, bulk change.es 00001/00000/00032d D 1.6 88/11/21 13:25:06 sybalsky 6 5c add exit(0) to return status 0es 00007/00005/00025d D 1.5 88/11/09 14:40:56 shih 5 4c add lf to end (shuts up diff)es 00006/00011/00024d D 1.4 88/10/12 17:55:37 krivacic 4 3c new output filees 00004/00008/00031d D 1.3 88/06/15 22:16:01 bane 3 2c Added unlink and chmod so anyone can make and remove /tmp/vdate.ces 00002/00002/00037d D 1.2 88/06/15 19:22:44 bane 2 1c Added unlink for old version of vdate.ces 00039/00000/00000d D 1.1 88/06/15 09:48:01 shimizu 1 0c date and time created 88/06/15 09:48:01 by shimizueuUtTI 1D 2/* This is G-file %Z% %M% Version %I% (%G%). copyright Xerox & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%";E 2I 2D 4/* This is G-file @(#) makevdate.c Version 1.1 (6/15/88). copyright Xerox & Fuji Xerox  */E 4I 4D 5/* This is G-file %Z% %M% Version %I% (%G%). copyright Xerox & Fuji Xerox  */E 5I 5D 8/* %Z% %M% Version %I% (%G%). copyright Xerox & Fuji Xerox  */E 8I 8/* %Z% %M% Version %I% (%G%). copyright venue & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%	(venue & Fuji Xerox)";E 8E 5E 4D 8static char *id = "@(#) makevdate.c	1.1 6/15/88";E 8I 8/************************************************************************//*									*//*	Copyright 1987, 1990 Venue, Fuji Xerox Co., Ltd, Xerox Corp.	*//*									*//*	This file is work-product resulting from the Xerox/Venue	*//*	Agreement dated 18-August-1989 for support of Medley.		*//*									*//************************************************************************/E 8I 5E 5E 2D 8#include	<stdio.h>#include	<sys/time.h>/********************************************************************//*	File: makevdate.cE 8D 8	This file for making version date(GLOBAL MDate)	This will be called when make file makes new executable file.E 8I 8/************************************************************************//*									*//*			m a k e v d a t e . c 				*//*									*//*	Make the version number to place in the emulator.  That number	*//*	will be smashed into the running sysout at the field		*//*	InterfacePage->rversion.  The version number is the number	*//*	of whole days since 12:00 13-Oct-87 (Takeshi's birthday).	*//*									*//*	This program prints a single line:				*//*		long MDate = <the version number>			*//*									*//*	That output is redirected to create the file vdate.c, which	*//*	is then compiled as part of the emulator MAKE.			*//*									*//************************************************************************/E 8D 8	Version number will set to InterfacePage->rversion.	(Days from Oct-13-87 12:00,by masking 16 bit)E 8D 8	By Takeshi ShimizuE 8D 8*//********************************************************************/E 8I 8#include	<stdio.h>I 9D 10#ifdef RISCOSE 10I 10#ifdef SYSVONLYE 10#include	<time.h>#elseE 9#include	<sys/time.h>I 9D 10#endif RISCOSE 10I 10#endif SYSVONLYE 10E 9E 8I 9D 10#ifdef RISCOSE 10I 10#ifdef SYSVONLYE 10	/* RISCOS doesn't have the BSD time functions */E 9main()D 4{   extern  char *l64a ();FILE *f;D 3static char *contents="long MDate=";char *ptr; /*long dat=561150000;*/E 3struct timeval time;E 4I 4D 5{ E 5I 5D 9{E 5 struct timeval time;E 9I 9  {    int dtime;    time(&dtime);    fprintf(stderr, "Mdate :%d\n", dtime);    printf("long MDate= %d;\n", dtime);    exit(0);  }#else	/* Version for every other Unix */main()  {    struct timeval time;E 9E 4I 3E 3D 9 gettimeofday(&time, NULL);D 4 printf("Mdate :%d \n", time.tv_sec); printf("Version: %s\n",ctime(&time.tv_sec));E 4I 4D 5 fprintf(stderr, "Mdate :%d \n", time.tv_sec); fprintf(stderr, "Version: %s\n",ctime(&time.tv_sec));E 5I 5 fprintf(stderr, "Mdate :%d\n", time.tv_sec); fprintf(stderr, "Version: %s\n", ctime(&time.tv_sec));E 9I 9    gettimeofday(&time, NULL);    fprintf(stderr, "Mdate :%d\n", time.tv_sec);    fprintf(stderr, "Version: %s\n", ctime(&time.tv_sec));E 9E 5E 4I 3D 4 unlink("/tmp/vdate.c");E 3 f=fopen("/tmp/vdate.c","w");D 3 for(ptr=contents;*ptr != '\0'; ptr++) { 	putc(*ptr,f); }fprintf(f ,"%d ;",time.tv_sec);E 3I 3 fprintf(f ,"long MDate= %d ;",time.tv_sec);E 3 fclose(f);I 3 chmod("/tmp/vdate.c", 0666);E 4I 4D 5 printf("long MDate= %d ;",time.tv_sec);E 5I 5D 9 printf("long MDate= %d;\n", time.tv_sec);I 6 exit(0);E 9I 9    printf("long MDate= %d;\n", time.tv_sec);    exit(0);  }E 9E 6E 5E 4E 3D 9}E 9I 9D 10#endif RISCOSE 10I 10#endif SYSVONLYE 10E 9E 1