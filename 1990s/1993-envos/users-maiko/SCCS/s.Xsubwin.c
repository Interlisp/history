h64758s 00016/00015/00231d D 1.3 92/04/27 18:44:46 nilsson 3 2c Fix of Xdisplay deps.es 00001/00002/00245d D 1.2 92/04/23 16:35:13 nilsson 2 1c New short name regimen. Improved X commandline handling.es 00247/00000/00000d D 1.1 92/04/21 15:28:06 sybalsky 1 0c date and time created 92/04/21 15:28:06 by sybalskyeuUf e 0tTI 1/* %Z% %M% Version %I% (%G%). copyright venue & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%	(venue & Fuji Xerox)";D 2/* %Z% %M% Version %I% (%G%). copyright venue & Fuji Xerox  */static char *id = "%Z% %M%	%I% %G%	(venue & Fuji Xerox)";E 2I 2E 2/**** Copyright (C) 1988 by Fuji Xerox co.,Ltd. All rights reserved.**		Author: Mitsunori Matsuda*		Date  : August 11, 1988*/#include <stdio.h>#include <X11/Xlib.h>#include <X11/Xutil.h>#include "XVersion.h"#include "MyWindow.h"D 3extern Display *Xdisplay;E 3extern XAnyEvent report;extern Bool isXeventtype();extern unsigned long Black_Pixel		   , White_Pixel;extern int lisp_Xmotion()         , lisp_Xbutton()	 , mouse_Xcrossed()	 , lisp_Xexpose()	 , Do_Scroll()	 , Set_BitGravity()	 , Raise_LispWindow()	 , Before_CreateDisplay()	 , After_CreateDisplay()	 , Before_CreateScroll()	 , After_CreateScroll()	 , Before_CreateScrollbar()	 , After_CreateScrollbar()	 , Before_CreateGrav()	 , After_CreateGrav()	 , Before_ResizeDisplay()	 , After_ResizeDisplay()	 , Before_ResizeScroll()	 , After_ResizeScroll()	 , Before_ResizeScrollbar()	 , After_ResizeScrollbar()	 , Before_ResizeGrav()	 , After_ResizeGrav()	 , DispatchXhandler();MyEvent Display_Event[] = {                  { MotionNotify , lisp_Xmotion  , &Display_Event[1] }                , { ButtonPress  , lisp_Xbutton  , &Display_Event[2] }                , { ButtonRelease, lisp_Xbutton  , &Display_Event[3] }		   , { EnterNotify  , mouse_Xcrossed, &Display_Event[4] }		   , { LeaveNotify  , mouse_Xcrossed, &Display_Event[5] }                , { Expose       , lisp_Xexpose  , NULL              } }        , Scroll_Event[] = {                  { ButtonPress  , Do_Scroll   , &Scroll_Event[1] }                , { ButtonRelease, Do_Scroll   , &Scroll_Event[2] }		, { EnterNotify  , Raise_LispWindow, NULL           }		/* yet unimplemented                 , { Expose       , ??, NULL             } 		*/		}        , Grav_Event[] = {                  { ButtonPress  , Set_BitGravity, NULL }		/* yet umimplemented                 , { ButtonRelease, ??, &Grav_Event[2] }                , { Exopse       , ??, NULL           }		*/         	};MyWindow Display_Window = {                          NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL                        , ButtonPressMask|ButtonReleaseMask|PointerMotionMask                         |ExposureMask|EnterWindowMask|LeaveWindowMask                        , NULL                        , Before_CreateDisplay                        , After_CreateDisplay		        , Before_ResizeDisplay		        , After_ResizeDisplay                        , DispatchXhandler                        , &Display_Event[0]			, NULL                        , NULL          }        , Vert_Scroll = {                          NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL                        , ButtonPressMask|ButtonReleaseMask|EnterWindowMask                        , NULL			, Before_CreateScroll                        , After_CreateScroll			, Before_ResizeScroll                        , After_ResizeScroll                        , DispatchXhandler                        , &Scroll_Event[0]                        , NULL                        , NULL         }        , Vert_Scroll_Bar = {                          NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL                        , NoEventMask                        , NULL			, Before_CreateScrollbar                        , After_CreateScrollbar			, Before_ResizeScrollbar                        , After_ResizeScrollbar                        , DispatchXhandler                        , NULL                        , NULL                        , NULL         }        , Horiz_Scroll = {                          NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL                        , ButtonPressMask|ButtonReleaseMask|EnterWindowMask                        , NULL			, Before_CreateScroll                        , After_CreateScroll			, Before_ResizeScroll                        , After_ResizeScroll                        , DispatchXhandler                        , &Scroll_Event[0]                                , NULL                        , NULL       }        , Horiz_Scroll_Bar = {                          NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL                        , NoEventMask                        , NULL			, Before_CreateScrollbar                        , After_CreateScrollbar			, Before_ResizeScrollbar                        , After_ResizeScrollbar                        , DispatchXhandler                        , NULL                        , NULL                        , NULL         }        , Grav_Window[] = {                 {                          NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL                        , ButtonPressMask                        , NULL			, Before_CreateGrav			, After_CreateGrav			, Before_ResizeGrav			, After_ResizeGrav                        , DispatchXhandler                        , &Grav_Event[0]                         , NULL                        , NULL       }                ,{                          NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL                        , ButtonPressMask                        , NULL			, Before_CreateGrav			, After_CreateGrav			, Before_ResizeGrav			, After_ResizeGrav                        , DispatchXhandler                              , &Grav_Event[0]                                  , NULL                        , NULL       }                ,{                          NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL                        , ButtonPressMask                        , NULL			, Before_CreateGrav			, After_CreateGrav			, Before_ResizeGrav			, After_ResizeGrav                        , DispatchXhandler                        , &Grav_Event[0]                                   , NULL                        , NULL       }                ,{                          NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL                        , ButtonPressMask                        , NULL			, Before_CreateGrav			, After_CreateGrav			, Before_ResizeGrav			, After_ResizeGrav                        , DispatchXhandler                        , &Grav_Event[0]                                 , NULL                        , NULL                  }                                                 };D 3Create_Subwindows( parent )E 3I 3Create_Subwindows( display, parent )     Display *display;E 3MyWindow *parent;{#ifdef TRACE	printf( "TRACE: Create_Subwindows()\n" );#endif	/* Lisp Screen */D 3	CreateWindow( parent       , &Display_Window );E 3I 3	CreateWindow( display, parent       , &Display_Window );E 3	/* Scroll */D 3	CreateWindow( parent       , &Vert_Scroll );	CreateWindow( parent       , &Horiz_Scroll );E 3I 3	CreateWindow( display, parent       , &Vert_Scroll );	CreateWindow( display, parent       , &Horiz_Scroll );E 3D 3	CreateWindow( &Vert_Scroll , &Vert_Scroll_Bar );	CreateWindow( &Horiz_Scroll, &Horiz_Scroll_Bar );E 3I 3	CreateWindow( display, &Vert_Scroll , &Vert_Scroll_Bar );	CreateWindow( display, &Horiz_Scroll, &Horiz_Scroll_Bar );E 3	/* Bit Bravity */	{ int i;	  for( i=0; i<4; i++ ) {D 3		CreateWindow( parent, &Grav_Window[i] );E 3I 3		CreateWindow( display, parent, &Grav_Window[i] );E 3	  } /* end for(i) */	}#ifdef TRACE 	{	extern DisplayArea ScreenRegion;	printf( "Create_Subwindows(): ScreenRegion( %d, %d )-( %d, %d )\n"			, ScreenRegion.left_x			, ScreenRegion.top_y			, ScreenRegion.right_x				, ScreenRegion.bottom_y );	}#endif} /* end Create_Subwindows */D 3Resize_Subwindows()E 3I 3Resize_Subwindows(display)     Display *display;E 3{#ifdef TRACE	printf( "TRACE: Resize_Subwindows()\n " );#endif/*D 3	ResizeWindow( &Display_Window  );E 3I 3	ResizeWindow( display, &Display_Window  );E 3*/D 3	ResizeWindow( &Vert_Scroll     );	ResizeWindow( &Horiz_Scroll    );E 3I 3	ResizeWindow( display, &Vert_Scroll     );	ResizeWindow( display, &Horiz_Scroll    );E 3	{ int i;	  for( i=0; i<4; i++ ) D 3		ResizeWindow( &Grav_Window[i] );E 3I 3		ResizeWindow( display, &Grav_Window[i] );E 3	}D 3	ResizeWindow( &Display_Window  );E 3I 3	ResizeWindow( display, &Display_Window  );E 3D 3	Reconf_ScreenRegion();E 3I 3	Reconf_ScreenRegion(display);E 3} /* end Reconf_Subwindows */E 1