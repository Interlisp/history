(DEFINE-FILE-INFO PACKAGE "ROOMS" READTABLE "XCL" BASE 10)(IL:FILECREATED "17-Aug-90 13:01:27" IL:|{DSK}<usr>local>lde>SOURCES>notecards>system>MEDLEYROOMSPATCHES.;3| 5732         IL:|changes| IL:|to:|  (IL:VARS IL:MEDLEYROOMSPATCHESCOMS)      IL:|previous| IL:|date:| "27-Jul-90 09:14:48" IL:|{DSK}<usr>local>lde>SOURCES>notecards>system>MEDLEYROOMSPATCHES.;2|); Copyright (c) 1988, 1989, 1990 by Venue & Xerox Corporation.  All rights reserved.(IL:PRETTYCOMPRINT IL:MEDLEYROOMSPATCHESCOMS)(IL:RPAQQ IL:MEDLEYROOMSPATCHESCOMS (                                         (IL:* IL:|;;| "Patches so NoteCards can run with Rooms without leaving windows of closed notecard files in other rooms")                                         (IL:FNS IL:NEW-INTERACTIVE-CLOSE-WINDOW)                                         (IL:PROP (IL:MAKEFILE-ENVIRONMENT IL:MEDLEYROOMSPATCHES))                                         (IL:DECLARE\: IL:DONTEVAL@LOAD IL:DOEVAL@COMPILE IL:DONTCOPY                                                IL:COMPILERVARS (IL:ADDVARS (IL:NLAMA)                                                                       (IL:NLAML)                                                                       (IL:LAMA                                                                       IL:NEW-INTERACTIVE-CLOSE-WINDOW                                                                              )))))(IL:* IL:|;;| "Patches so NoteCards can run with Rooms without leaving windows of closed notecard files in other rooms")(IL:DEFINEQ(IL:NEW-INTERACTIVE-CLOSE-WINDOW  (LAMBDA (WINDOW &OPTIONAL (FROM-ROOM *CURRENT-ROOM*)                 (PLACEMENT-CHOICE NIL))            (IL:* IL:\; "Edited  5-Apr-89 21:04 by sye")         (BLOCK IL:NEW-INTERACTIVE-CLOSE-WINDOW             (LET ((MAIN-WINDOW (MAIN-WINDOW WINDOW))                   (WINDOW-TO-CLOSE WINDOW))                  (WHEN (AND (NOT (ICON? WINDOW))                             (NOT (EQ WINDOW MAIN-WINDOW)))                      (LET ((PASS-TO-MAIN-COMS (IL:WINDOWPROP WINDOW 'IL:PASSTOMAINCOMS)))                           (UNLESS (OR (EQ PASS-TO-MAIN-COMS T)                                       (MEMBER 'IL:CLOSEW PASS-TO-MAIN-COMS :TEST 'EQ))                               (CLOSE-WINDOW WINDOW)                               (RETURN-FROM IL:NEW-INTERACTIVE-CLOSE-WINDOW))                           (SETQ WINDOW-TO-CLOSE MAIN-WINDOW)))                  (LET ((ROOMS (FIND-ROOMS-CONTAINING MAIN-WINDOW)))                       (IF (NULL ROOMS)                           (CLOSE-WINDOW WINDOW-TO-CLOSE)                           (CASE (IF (AND (ENDP (REST ROOMS))                                          (FIND-PLACEMENT MAIN-WINDOW FROM-ROOM))                                     (IF (EQ FROM-ROOM (FIRST ROOMS))                                         :ALL                                         (IF (CONFIRM                     "This placement is in the included room ~S.~%Are you sure you want to delete it?"                                                    (ROOM-NAME (FIRST ROOMS)))                                             :ALL))                                     (OR PLACEMENT-CHOICE (MENU '(("All placements" :ALL)                                                                  ("Just this placement" :THIS))                                                                "Delete?"                                                    "This window has placements in more than one room"                                                                )))                               (:ALL (LET ((HIDDEN? (WINDOW-HIDDEN? MAIN-WINDOW)))                                          (WHEN HIDDEN? (UN-HIDE-WINDOW MAIN-WINDOW))                                          (CLOSE-WINDOW (IF (SHRUNKEN? MAIN-WINDOW)                                                            (WINDOW-ICON MAIN-WINDOW)                                                            MAIN-WINDOW))                                          (IF (AND HIDDEN? (OR (IL:OPENWP MAIN-WINDOW)                                                               (IL:OPENWP (WINDOW-ICON MAIN-WINDOW)))                                                   )                                              (HIDE-WINDOW MAIN-WINDOW)                                              (DOLIST (CL:ROOM ROOMS)                                                  (LET ((PLACEMENT (FIND-PLACEMENT-IN-ROOM                                                                           MAIN-WINDOW CL:ROOM)))                                                       (WHEN PLACEMENT (DELETE-PLACEMENT PLACEMENT                                                                               CL:ROOM)))))))                               (:THIS (MULTIPLE-VALUE-BIND (PLACEMENT IN-ROOM)                                             (FIND-PLACEMENT MAIN-WINDOW FROM-ROOM)                                             (WHEN PLACEMENT (DELETE-PLACEMENT PLACEMENT IN-ROOM))                                             (HIDE-WINDOW MAIN-WINDOW)                                             (SETQ PLACEMENT (FIND-PLACEMENT MAIN-WINDOW                                                                     *CURRENT-ROOM*))                                             (WHEN PLACEMENT (PLACE-PLACEMENT PLACEMENT))))))))))))(IL:DECLARE\: IL:DONTEVAL@LOAD IL:DOEVAL@COMPILE IL:DONTCOPY IL:COMPILERVARS (IL:ADDTOVAR IL:NLAMA )(IL:ADDTOVAR IL:NLAML )(IL:ADDTOVAR IL:LAMA IL:NEW-INTERACTIVE-CLOSE-WINDOW))(IL:PUTPROPS IL:MEDLEYROOMSPATCHES IL:COPYRIGHT ("Venue & Xerox Corporation" 1988 1989 1990))(IL:DECLARE\: IL:DONTCOPY  (IL:FILEMAP (NIL (1573 5412 (IL:NEW-INTERACTIVE-CLOSE-WINDOW 1586 . 5410)))))IL:STOP