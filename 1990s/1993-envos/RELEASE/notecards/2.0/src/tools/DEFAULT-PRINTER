(DEFINE-FILE-INFO READTABLE "XCL" PACKAGE "INTERLISP")(FILECREATED "12-Nov-90 16:05:14" |{DSK}<users>gadener>medley>notecards>tools>DEFAULT-PRINTER.;3| 23385        |changes| |to:|  (FNS ANNOUNCE-DEFAULT-PRINTER-AND-TYPE SHOW-DEFAULT-PRINTER)                       (VARS DEFAULT-PRINTERCOMS)      |previous| |date:| "12-Nov-90 14:52:08" |{DSK}<users>gadener>medley>notecards>tools>DEFAULT-PRINTER.;2|); Copyright (c) 1989, 1990 by Envos Corporation.  All rights reserved.(PRETTYCOMPRINT DEFAULT-PRINTERCOMS)(RPAQQ DEFAULT-PRINTERCOMS       (        (* |;;| "The Printer Stuff")        (FNS SET-DEFAULT-PRINTER ADD-DEFAULT-PRINTER SHOW-DEFAULT-PRINTER CHANGE-PRINTER-TYPE              ANNOUNCE-DEFAULT-PRINTER-AND-TYPE REMOVE-DEFAULT-PRINTER)                (* |;;| " The Menu Stuff")        (FNS FLASH-ERROR MAKE-DEFAULTS-MENU MAKE-PROMPT-WINDOW)                (* |;;| "The Font Stuff")        (FNS ADD-FONT-DIRECTORY REMOVE-FONT-DIRECTORY SHOW-FONT-DIRECTORIES ESTABLISH-REGION)        (FNS MAKE-DIRECTORY-GROUP-MENU DELETE-DIRECTORIES-WINDOW KILL-SHOW-DIRECTORIES)        (ADDVARS (|BackgroundMenuCommands| ("Set Default Printer"                                            '(SET-DEFAULT-PRINTER)                                                                                       "Makes one of the available printers the default printer."                                            (SUBITEMS ("Set Default Printer" '(SET-DEFAULT-PRINTER)                                                                                                        "Makes one of the available printers the default printer."                                                             )                                                   ("Add Default Printer" '(ADD-DEFAULT-PRINTER)                                                                                   "Adds a printer to the list of available printers and makes it the default."                                                          )                                                   ("Show Default Printer" '(SHOW-DEFAULT-PRINTER)                                                          "Shows the current default printer")                                                   ("Remove Default Printer" '(REMOVE-DEFAULT-PRINTER                                                                               )                                                                                                  "Removes an available printer from the default printer list."                                                          )                                                   ("Change Printer Type" '(CHANGE-PRINTER-TYPE)                                                                                                                "Change the Printer type of the chosen printer"                                                          )                                                   ("----------" NIL)                                                   ("Add Font Directory" '(ADD-FONT-DIRECTORY)                                                                                                                "Adds a default directory to search for fonts."                                                          (SUBITEMS ("Add Font Directory"                                                                     '(ADD-FONT-DIRECTORY)                                                                                                                           "Adds a default directory to search for fonts."                                                                     )                                                                 ("Show Font Directories"                                                                  '(SHOW-FONT-DIRECTORIES)                                                                                                                   "Shows the default directories to search for fonts."                                                                  )                                                                 ("Remove Font Directory"                                                                  '(REMOVE-FONT-DIRECTORY)                                                                                                                     "Removes a default directory to search for fonts."                                                                  )))))))        (P (SETQ |BackgroundMenu| NIL))))(* |;;| "The Printer Stuff")(DEFINEQ(SET-DEFAULT-PRINTER  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 10:07 by gadener")    (DECLARE (GLOBAL DEFAULTPRINTINGHOST PROMPTWINDOW))    (CLEARW PROMPTWINDOW)    (|if| DEFAULTPRINTINGHOST        |then| (LET ((DEFAULT-PRINTER (MAKE-DEFAULTS-MENU DEFAULTPRINTINGHOST                                                  " Choose Default Printer. "                                                  "No printers on default printer list.")))                        (|if| DEFAULT-PRINTER                            |then| (SETQ DEFAULTPRINTINGHOST (CONS DEFAULT-PRINTER                                                                       (REMOVE DEFAULT-PRINTER                                                                               DEFAULTPRINTINGHOST))))                        )              (ANNOUNCE-DEFAULT-PRINTER-AND-TYPE)      |else| (ADD-DEFAULT-PRINTER))))(ADD-DEFAULT-PRINTER  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 11:46 by gadener")    (DECLARE (GLOBAL PROMPTWINDOW DEFAULTPRINTINGHOST))    (CLEARW PROMPTWINDOW)    (LET* ((PROMPT-WINDOW (MAKE-PROMPT-WINDOW 300 400 "Add default printer: Tremor:mv:envos"))           (PRINTER (MKATOM (PROMPTFORWORD "New default printer: " (CAR DEFAULTPRINTINGHOST)                                   NIL PROMPT-WINDOW NIL T)))           PRINTER-TYPE)          (|if| PRINTER              |then| (|if| (NOT (MEMBER PRINTER DEFAULTPRINTINGHOST))                             |then| (|push| DEFAULTPRINTINGHOST PRINTER)                                   (|if| (SETQ PRINTER-TYPE (MENU (|create|                                                                       MENU                                                                       TITLE _ (CONCAT                                                                           " What type of Printer is "                                                                                      PRINTER "?  ")                                                                       ITEMS _ '(POSTSCRIPT                                                                                        INTERPRESS)                                                                       CENTERFLG _ T)                                                                      (CONS (IPLUS (DSPXPOSITION                                                                                    NIL PROMPT-WINDOW                                                                                    )                                                                                   300 25)                                                                            (IPLUS (DSPYPOSITION                                                                                    NIL PROMPT-WINDOW                                                                                    )                                                                                   400))))                                       |then| (PUTPROP PRINTER 'PRINTERTYPE PRINTER-TYPE))                           |else| (SETQ DEFAULTPRINTINGHOST (CONS PRINTER (REMOVE PRINTER                                                                                   DEFAULTPRINTINGHOST                                                                                     )))                                 (ANNOUNCE-DEFAULT-PRINTER-AND-TYPE))            |else| (ANNOUNCE-DEFAULT-PRINTER-AND-TYPE))          (CLOSEW PROMPT-WINDOW))))(SHOW-DEFAULT-PRINTER  (LAMBDA NIL    (DECLARE (GLOBAL DEFAULTPRINTINGHOST PROMPTWINDOW))                                                          (* \; "Edited 12-Nov-90 15:38 by gadener")    (|if| DEFAULTPRINTINGHOST        |then| (CLEARW PROMPTWINDOW)              (ANNOUNCE-DEFAULT-PRINTER-AND-TYPE))))(CHANGE-PRINTER-TYPE  (LAMBDA NIL    (DECLARE (GLOBAL PROMPTWINDOW))               (* \; "Edited 12-Nov-90 14:50 by gadener")    (CLEARW PROMPTWINDOW)    (LET* ((PRINTER (MAKE-DEFAULTS-MENU DEFAULTPRINTINGHOST " Choose Printer. "                            "No printers on default printer list."))           (OLD-PRINTER-TYPE (PRINTERTYPE PRINTER))           PRINTER-TYPE)          (|if| PRINTER              |then| (SETQ PRINTER-TYPE (MENU (|create| MENU                                                         TITLE _ (CONCAT " What type of Printer is "                                                                        PRINTER " ?  ")                                                         ITEMS _ '(POSTSCRIPT INTERPRESS)                                                         CENTERFLG _ T)))                    (COND                       ((NULL PRINTER-TYPE)                        (|if| (NULL OLD-PRINTER-TYPE)                            |then| (FLASH-ERROR (CONCAT "WARNING! Printer type for " PRINTER                                                               " is still undefined.")                                              PROMPTWINDOW)))                       ((EQL PRINTER-TYPE OLD-PRINTER-TYPE)                        (FLASH-ERROR (CONCAT "WARNING! Printer type for " PRINTER " unchanged.")                               PROMPTWINDOW))                       (T (PUTPROP PRINTER 'PRINTERTYPE PRINTER-TYPE)                          (PRINTOUT PROMPTWINDOW "New Printer Type for " PRINTER " is: " PRINTER-TYPE                                 T)))))))(ANNOUNCE-DEFAULT-PRINTER-AND-TYPE  (LAMBDA NIL                                         (* \; "Edited 12-Nov-90 16:02 by gadener")    (DECLARE (GLOBAL PROMPTWINDOW))    (LET* ((DEFAULT-PRINTER (CAR DEFAULTPRINTINGHOST))           (PRINTER-TYPE (PRINTERTYPE DEFAULT-PRINTER)))          (|if| DEFAULT-PRINTER              |then| (PRINTOUT PROMPTWINDOW "Default printer: " DEFAULT-PRINTER T)                    (|if| PRINTER-TYPE                        |then| (PRINTOUT PROMPTWINDOW "Printer type: " PRINTER-TYPE T)                      |else| (PRINTOUT PROMPTWINDOW "Printer type for " DEFAULT-PRINTER                                         " is undefined." T)                            (|if| (SETQ PRINTER-TYPE (MENU (|create| MENU                                                                      TITLE _ (CONCAT                                                                           " What type of Printer is "                                                                                     DEFAULT-PRINTER                                                                                     " ?  ")                                                                      ITEMS _ '(POSTSCRIPT INTERPRESS                                                                                      )                                                                      CENTERFLG _ T)))                                |then| (PUTPROP DEFAULT-PRINTER 'PRINTERTYPE PRINTER-TYPE)                                      (PRINTOUT PROMPTWINDOW "Printer type: " PRINTER-TYPE T)                              |else| (FLASH-ERROR (CONCAT "WARNING! Printer type for "                                                                  DEFAULT-PRINTER                                                                  " is still undefined.")                                                PROMPTWINDOW)))            |else| (FLASH-ERROR "No default printers specified." PROMPTWINDOW)))))(REMOVE-DEFAULT-PRINTER  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 10:04 by gadener")    (DECLARE (GLOBAL DEFAULTPRINTINGHOST PROMPTWINDOW))    (CLEARW PROMPTWINDOW)    (LET ((PRINTER (MAKE-DEFAULTS-MENU DEFAULTPRINTINGHOST " Choose Printer to Remove. "                           "No printers on default printer list.")))         (IF PRINTER             THEN (SETQ DEFAULTPRINTINGHOST (REMOVE PRINTER DEFAULTPRINTINGHOST)))         (ANNOUNCE-DEFAULT-PRINTER-AND-TYPE)))))(* |;;| " The Menu Stuff")(DEFINEQ(FLASH-ERROR  (LAMBDA (MESSAGE WHERE)    (DECLARE (GLOBAL PROMPTWINDOW))               (* \; "Edited  9-Nov-90 14:02 by gadener")    (LET ((FLASHW (OR WHERE PROMPTWINDOW)))         (PRINTOUT FLASHW T MESSAGE)         (FLASHWINDOW FLASHW 2))))(MAKE-DEFAULTS-MENU  (LAMBDA (MENU-LIST MENU-TITLE ERROR-MESSAGE CENTERED)    (DECLARE (GLOBAL PROMPTWINDOW))               (* \; "Edited  9-Nov-90 10:59 by gadener")    (|if| MENU-LIST        |then| (MENU (|create| MENU                                ITEMS _ MENU-LIST                                TITLE _ MENU-TITLE                                CENTERFLG _ CENTERED))      |else| (|if| ERROR-MESSAGE                     |then| (FLASH-ERROR ERROR-MESSAGE PROMPTWINDOW)))))(MAKE-PROMPT-WINDOW  (LAMBDA (LEFT BOTTOM TEST-STRING-FOR-WINDOW-WIDTH)  (* \; "Edited  9-Nov-90 11:01 by gadener")    (LET* ((BORDER 5)           (WINDOW-HEIGHT (HEIGHTIFWINDOW (FONTPROP DEFAULTFONT 'HEIGHT)                                 NIL BORDER))           (WINDOW-WIDTH (IPLUS 100 (STRINGWIDTH TEST-STRING-FOR-WINDOW-WIDTH DEFAULTFONT)))           (REGION (CREATEREGION LEFT BOTTOM WINDOW-WIDTH WINDOW-HEIGHT)))          (CREATEW REGION NIL BORDER)))))(* |;;| "The Font Stuff")(DEFINEQ(ADD-FONT-DIRECTORY  (LAMBDA NIL    (DECLARE (GLOBAL PROMPTWINDOW))               (* \; "Edited  9-Nov-90 11:50 by gadener")    (LET ((DIRECTORY-GROUP (CADR (MAKE-DIRECTORY-GROUP-MENU " Add to which directory group? ")))          PROMPT-WINDOW NEW-DIRECTORY DIRECTORY-GROUP)         (|if| DIRECTORY-GROUP             |then| (SETQ PROMPT-WINDOW (MAKE-PROMPT-WINDOW 300 400                              "Add font directory: {DSK}/usr/local/lde/fonts/interpress/presentation/"                                                   ))                   (SETQ NEW-DIRECTORY (PROMPTFORWORD "Add font directory: " (CAR (EVAL                                                                                       DIRECTORY-GROUP                                                                                        ))                                              NIL PROMPT-WINDOW NIL T))                   (|if| (AND NEW-DIRECTORY (DIRECTORYNAMEP NEW-DIRECTORY))                       |then| (|if| (NOT (MEMBER NEW-DIRECTORY (EVAL DIRECTORY-GROUP)))                                      |then| (SET DIRECTORY-GROUP (CONS NEW-DIRECTORY                                                                            (EVAL DIRECTORY-GROUP))))                     |else| (FLASH-ERROR (CONCAT "Not a valid directory, nothing added")                                       PROMPTWINDOW))                   (CLOSEW PROMPT-WINDOW)))))(REMOVE-FONT-DIRECTORY  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 11:53 by gadener")    (LET ((DIRECTORY-GROUP (CADR (MAKE-DIRECTORY-GROUP-MENU                                         " Remove from which directory group? ")))          REMOVE-DIRECTORY)         (|if| DIRECTORY-GROUP             |then| (|if| (SETQ REMOVE-DIRECTORY (MAKE-DEFAULTS-MENU (EVAL                                                                                       DIRECTORY-GROUP                                                                                       )                                                                " Remove which directory? "                                                                 "No directory to remove."))                            |then| (SET DIRECTORY-GROUP (REMOVE REMOVE-DIRECTORY (EVAL                                                                                       DIRECTORY-GROUP                                                                                           ))))))))(SHOW-FONT-DIRECTORIES  (LAMBDA NIL    (DECLARE (GLOBAL *DIRECTORIES-WINDOW* PROMPTWINDOW))                                                          (* \; "Edited  9-Nov-90 14:12 by gadener")    (LET ((DIRECTORY-GROUP (MAKE-DIRECTORY-GROUP-MENU " Show which directory group? "))          DIRECTORY-GROUP-NAME REMOVE-DIRECTORY WIDTH STRING-HEIGHT)         (|if| DIRECTORY-GROUP             |then| (SETQ DIRECTORY-GROUP-NAME (CAR DIRECTORY-GROUP))                   (SETQ DIRECTORY-GROUP (CADR DIRECTORY-GROUP))                   (|if| (AND (BOUNDP DIRECTORY-GROUP)                                  (EVAL DIRECTORY-GROUP))                       |then| (|if| (AND (BOUNDP '*DIRECTORIES-WINDOW*))                                      |then| (CLOSEW *DIRECTORIES-WINDOW*))                             (|if| (FIND.PROCESS 'DELETE-DIRECTORIES-WINDOW)                                 |then| (DEL.PROCESS 'DELETE-DIRECTORIES-WINDOW))                             (BLOCK)                             (SETQ *DIRECTORIES-WINDOW* (CREATEW (APPEND (LIST 300 300)                                                                        (ESTABLISH-REGION                                                                         DIRECTORY-GROUP-NAME                                                                         (EVAL DIRECTORY-GROUP)))                                                               DIRECTORY-GROUP-NAME))                             (WINDOWPROP *DIRECTORIES-WINDOW* 'CLOSEFN 'KILL-SHOW-DIRECTORIES)                             (|if| (EVAL DIRECTORY-GROUP)                                 |then| (|for| DIRECTORY |in| (EVAL DIRECTORY-GROUP)                                               |do| (PRINTOUT *DIRECTORIES-WINDOW* DIRECTORY T))                               |else| (PRINTOUT *DIRECTORIES-WINDOW* "No directories set." T))                             (ADD.PROCESS '(DELETE-DIRECTORIES-WINDOW))                     |else| (FLASH-ERROR (CONCAT "Font Directory : " DIRECTORY-GROUP                                                         " has not been set")                                       PROMPTWINDOW))))))(ESTABLISH-REGION  (LAMBDA (MIN-WIDTH-STRING OBJECTS)                  (* \; "Edited  9-Nov-90 14:07 by gadener")(* |;;;| "Returns the required width and height  to be able to display OBJECTS in a window. MIN-WIDTH-STRING will be the minimum-width required for the window if none of the OBJECTS contains a string longer than that. ")                                                      (* \; "Edited  9-Nov-90 13:41 by gadener")    (LET* ((FONT (DEFAULTFONT 'DISPLAY))           (MIN-HEIGHT (+ 20 (TIMES (LENGTH OBJECTS)                                    (FONTPROP FONT 'HEIGHT))))           (MIN-WIDTH (STRINGWIDTH MIN-WIDTH-STRING FONT))           WIDTH)          (|for| X |in| OBJECTS |do| (|if| (> (SETQ WIDTH (STRINGWIDTH X FONT))                                                              MIN-WIDTH)                                                     |then| (SETQ MIN-WIDTH WIDTH)))          (LIST (+ 10 MIN-WIDTH)                MIN-HEIGHT)))))(DEFINEQ(MAKE-DIRECTORY-GROUP-MENU  (LAMBDA (MENU-TITLE)                              (* \; "Edited 30-Mar-89 11:19 by Mountford")    (MENU (|create| MENU                 ITEMS _ '(("Display Font Directories" '("Display Font Directories"                                                                DISPLAYFONTDIRECTORIES))                           ("PostScript Font Directories" '("PostScript Font Directories"                                                                   POSTSCRIPTFONTDIRECTORIES))                           ("Interpress Font Directories" '("Interpress Font Directories"                                                                   INTERPRESSFONTDIRECTORIES)))                 TITLE _ MENU-TITLE                 CENTERFLG _ T))))(DELETE-DIRECTORIES-WINDOW  (LAMBDA NIL                                       (* \; "Edited 29-Mar-89 14:39 by Mountford")    (BLOCK 100000)    (KILL-SHOW-DIRECTORIES)))(KILL-SHOW-DIRECTORIES  (LAMBDA NIL    (DECLARE (GLOBAL *DIRECTORIES-WINDOW*))       (* \; "Edited  9-Nov-90 14:18 by gadener")    (WINDOWPROP *DIRECTORIES-WINDOW* 'CLOSEFN NIL)    (CLOSEW *DIRECTORIES-WINDOW*)    (|if| (FIND.PROCESS 'DELETE-DIRECTORIES-WINDOW)        |then| (DEL.PROCESS 'DELETE-DIRECTORIES-WINDOW)))))(ADDTOVAR |BackgroundMenuCommands|          ("Set Default Printer" '(SET-DEFAULT-PRINTER)                 "Makes one of the available printers the default printer."                 (SUBITEMS ("Set Default Printer" '(SET-DEFAULT-PRINTER)                                  "Makes one of the available printers the default printer.")                        ("Add Default Printer" '(ADD-DEFAULT-PRINTER)                                                        "Adds a printer to the list of available printers and makes it the default."                               )                        ("Show Default Printer" '(SHOW-DEFAULT-PRINTER)                               "Shows the current default printer")                        ("Remove Default Printer" '(REMOVE-DEFAULT-PRINTER)                               "Removes an available printer from the default printer list.")                        ("Change Printer Type" '(CHANGE-PRINTER-TYPE)                               "Change the Printer type of the chosen printer")                        ("----------" NIL)                        ("Add Font Directory" '(ADD-FONT-DIRECTORY)                               "Adds a default directory to search for fonts."                               (SUBITEMS ("Add Font Directory" '(ADD-FONT-DIRECTORY)                                                "Adds a default directory to search for fonts.")                                      ("Show Font Directories" '(SHOW-FONT-DIRECTORIES)                                             "Shows the default directories to search for fonts.")                                      ("Remove Font Directory" '(REMOVE-FONT-DIRECTORY)                                             "Removes a default directory to search for fonts."))))))(SETQ |BackgroundMenu| NIL)(PUTPROPS DEFAULT-PRINTER COPYRIGHT ("Envos Corporation" 1989 1990))(DECLARE\: DONTCOPY  (FILEMAP (NIL (4632 12927 (SET-DEFAULT-PRINTER 4642 . 5608) (ADD-DEFAULT-PRINTER 5610 . 8327) (SHOW-DEFAULT-PRINTER 8329 . 8669) (CHANGE-PRINTER-TYPE 8671 . 10319) (ANNOUNCE-DEFAULT-PRINTER-AND-TYPE 10321 . 12379) (REMOVE-DEFAULT-PRINTER 12381 . 12925)) (12963 14250 (FLASH-ERROR 12973 . 13236) (MAKE-DEFAULTS-MENU 13238 . 13768) (MAKE-PROMPT-WINDOW 13770 . 14248)) (14285 20146 (ADD-FONT-DIRECTORY 14295 . 15780) (REMOVE-FONT-DIRECTORY 15782 . 16881) (SHOW-FONT-DIRECTORIES 16883 . 19129) (ESTABLISH-REGION 19131 . 20144)) (20147 21479 (MAKE-DIRECTORY-GROUP-MENU 20157 . 20936) (DELETE-DIRECTORIES-WINDOW 20938 . 21126) (KILL-SHOW-DIRECTORIES 21128 . 21477)))))STOP