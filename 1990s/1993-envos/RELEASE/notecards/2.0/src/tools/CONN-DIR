(DEFINE-FILE-INFO PACKAGE "INTERLISP" READTABLE "XCL" BASE 10)(FILECREATED "13-Nov-90 18:40:11" |{DSK}<users>gadener>medley>notecards>tools>CONN-DIR.;1| 13761        |previous| |date:| " 9-Nov-90 16:53:45" |{DSK}<users>gadener>medley>notecards>tools>CONN-DIR.;1|); Copyright (c) 1989, 1990 by ENVOS Corporation.  All rights reserved.(PRETTYCOMPRINT CONN-DIRCOMS)(RPAQQ CONN-DIRCOMS       ((FNS CD-SETUP CD-KILL-PROCESS CD-FONT-FAMILY-MENU CD-FONT-SIZE-MENU CD-CHANGE-FONT)        (FNS CD-PERODICALLY-UPDATE)        (FNS CD-BUTTONEVENTFN CD-UPDATE-WINDOW CD-SIZE-WINDOW CD-CREATE-MENU CD-GET-NEW-DIR              CD-REMOVE-DIR CD-CLEAR-ALL CD-CONNECT CD-ORDER-ITEMS)        (APPENDVARS (|BackgroundMenuCommands| ("Directory Connector" (CD-SETUP)                                                                            "Creates a current-directory window which has change directory functionality."                                                     (SUBITEMS ("Change Font" (CD-CHANGE-FONT)                                                                                                                               "Changes the current-directory window font."                                                                      )))))        (P (SETQ |BackgroundMenu| NIL))))(DEFINEQ(CD-SETUP  (LAMBDA NIL    (DECLARE (GLOBAL LASTMOUSEX LASTMOUSEY *CD-CURRENT-DIR* *CD-DIRECTORIES* *CD-WINDOW-DIR-FONT*                        *CD-WINDOW-TITLE-FONT* *CD-WINDOW*))                                                          (* \; "Edited 13-Nov-90 18:38 by gadener")    (|if| (NOT (DIRECTORYNAMEP (DIRECTORYNAME T)))        |then| (CNDIR "{DSK}"))    (SETQ *CD-CURRENT-DIR* (DIRECTORYNAME T))    (|if| (BOUNDP '*CD-DIRECTORIES*)        |then| (SETQ *CD-DIRECTORIES* (UNION *CD-CURRENT-DIR* *CD-DIRECTORIES*))      |else| (SETQ *CD-DIRECTORIES* (LIST *CD-CURRENT-DIR*)))    (|if| (NOT (BOUNDP '*CD-WINDOW-DIR-FONT*))        |then| (SETQ *CD-WINDOW-DIR-FONT* (FONTCREATE 'HELVETICA 10)))    (|if| (NOT (BOUNDP '*CD-WINDOW-TITLE-FONT*))        |then| (SETQ *CD-WINDOW-TITLE-FONT* (FONTCREATE 'HELVETICA 10 'BRR)))    (|if| (BOUNDP '*CD-WINDOW*)        |then| (CLOSEW *CD-WINDOW*))    (SETQ *CD-WINDOW* (CREATEW (CREATEREGION LASTMOUSEX LASTMOUSEY 50 20)))    (CD-UPDATE-WINDOW)    (WINDOWPROP *CD-WINDOW* 'BUTTONEVENTFN 'CD-BUTTONEVENTFN)    (|if| (FIND.PROCESS "DIRECTORY CONNECTOR")        |then| (DEL.PROCESS "DIRECTORY CONNECTOR"))    (|if| (NOT (MEMBER "DIRECTORY CONNECTOR" IDLE.SUSPEND.PROCESS.NAMES))        |then| (|push| IDLE.SUSPEND.PROCESS.NAMES "DIRECTORY CONNECTOR"))    (WINDOWPROP *CD-WINDOW* 'CLOSEFN 'CD-KILL-PROCESS)    (BLOCK)    (ADD.PROCESS '(CD-PERODICALLY-UPDATE)           'NAME "DIRECTORY CONNECTOR" 'RESTARTABLE T)    NIL))(CD-KILL-PROCESS  (LAMBDA NIL                                       (* \; "Edited 17-Feb-89 11:07 by Mountford")    (|if| (FIND.PROCESS "DIRECTORY CONNECTOR")        |then| (DEL.PROCESS "DIRECTORY CONNECTOR"))))(CD-FONT-FAMILY-MENU  (LAMBDA NIL                                       (* \; "Edited 26-Jan-89 09:57 by Mountford")    (|if| (OR (NOT (BOUNDP '*CD-FONT-FAMILY-MENU*))                  (NULL *CD-FONT-FAMILY-MENU*))        |then| (SETQ *CD-FONT-FAMILY-MENU* (|create| MENU                                                      ITEMS _ '((|Titan| 'TITAN)                                                                (|Hippo| 'HIPPO)                                                                (|Gacha| 'GACHA)                                                                (|Classic| 'CLASSIC)                                                                (|BoldPS| 'BOLDPS)                                                                (|Modern| 'MODERN)                                                                (|Terminal| 'TERMINAL)                                                                (|Helvetica| 'HELVETICA)                                                                (|Helveticad| 'HELVETICAD)                                                                ("Old English" 'OLDENGLISH)                                                                ("Letter Gothic" 'LETTERGOTHIC)                                                                ("Times Roman" 'TIMESROMAN)                                                                ("Times Romand" 'TIMESROMAND))                                                      CENTERFLG _ T                                                      TITLE _ " Font ")))    (MENU *CD-FONT-FAMILY-MENU*)))(CD-FONT-SIZE-MENU  (LAMBDA NIL                                       (* \; "Edited 26-Jan-89 10:00 by Mountford")    (|if| (OR (NOT (BOUNDP '*CD-FONT-SIZE-MENU*))                  (NULL *CD-FONT-SIZE-MENU*))        |then| (SETQ *CD-FONT-SIZE-MENU*                    (|create| MENU                           ITEMS _                           '(6 7 8 9 10 11 12 14 16 18 24 26 30 36 72)                           MENUCOLUMNS _ 3                           TITLE _ " Size ")))    (MENU *CD-FONT-SIZE-MENU*)))(CD-CHANGE-FONT  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 14:54 by gadener")    (LET ((FAMILY (CD-FONT-FAMILY-MENU))          (SIZE (CD-FONT-SIZE-MENU))          DIR-FONT TITLE-FONT)         (|if| (NOT FAMILY)             |then| (SETQ FAMILY (FONTPROP *CD-WINDOW-DIR-FONT* 'FAMILY)))         (|if| (NOT SIZE)             |then| (SETQ SIZE (FONTPROP *CD-WINDOW-DIR-FONT* 'SIZE)))         (PROMPTPRINT "Fetching Font... ")         (SETQ DIR-FONT (FONTCREATE FAMILY SIZE 'MRR NIL NIL 'NOERRORFLG))         (SETQ TITLE-FONT (FONTCREATE FAMILY SIZE 'BRR NIL NIL 'NOERRORFLG))         (|if| (AND DIR-FONT TITLE-FONT)             |then| (SETQ *CD-WINDOW-DIR-FONT* DIR-FONT)                   (SETQ *CD-WINDOW-TITLE-FONT* TITLE-FONT)                   (PRINTOUT PROMPTWINDOW "Done." T)           |else| (PRINTOUT PROMPTWINDOW "Font Not Found." T))         (|if| (NOT (FIND.PROCESS "DIRECTORY CONNECTOR"))             |then| (CD-SETUP))         (CD-UPDATE-WINDOW)))))(DEFINEQ(CD-PERODICALLY-UPDATE  (LAMBDA NIL                                       (* \; "Edited 27-Mar-89 14:17 by Mountford")    (PROG NIL      TOP (|if| (NOT (STREQUAL *CD-CURRENT-DIR* (DIRECTORYNAME T)))              |then| (CD-CONNECT (DIRECTORYNAME T))                    (CD-UPDATE-WINDOW))          (BLOCK 10000)          (GO TOP)))))(DEFINEQ(CD-BUTTONEVENTFN  (LAMBDA (WINDOW)                                    (* \; "Edited  9-Nov-90 15:49 by gadener")    (TOTOPW *CD-WINDOW*)    (INVERTW *CD-WINDOW*)    (LET ((MOUSE-STATE (MOUSESTATE (OR LEFT MIDDLE)))          NEW-DIR)         (|until| (MOUSESTATE UP) |do| (BLOCK 100))         (INVERTW *CD-WINDOW*)         (|if| (EQ *CD-WINDOW* (WHICHW))             |then| (|if| (OR (KEYDOWNP 'RSHIFT)                                      (KEYDOWNP 'LSHIFT))                            |then| (BKSYSBUF (DIRECTORYNAME T))                          |else| (|if| MOUSE-STATE                                         |then| (SETQ NEW-DIR (CD-CREATE-MENU))                                               (COND                                                  ((EQ NEW-DIR '|Clear All|)                                                   (CD-CLEAR-ALL))                                                  ((EQ NEW-DIR '|Remove A Directory|)                                                   (CD-REMOVE-DIR))                                                  ((EQ NEW-DIR '| Connect to Other Directory |)                                                   (CD-GET-NEW-DIR))                                                  (NEW-DIR (CD-CONNECT NEW-DIR)))))                   (CD-UPDATE-WINDOW)))))(CD-UPDATE-WINDOW  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 15:41 by gadener")    (DSPFONT *CD-WINDOW-TITLE-FONT* *CD-WINDOW*)    (CD-SIZE-WINDOW)    (CLEARW *CD-WINDOW*)    (PRIN1 " Dir: " *CD-WINDOW*)    (DSPFONT *CD-WINDOW-DIR-FONT* *CD-WINDOW*)    (* |;;| "The following line is necessary to reposition the DSPXPOSITION at its current position.  If this isn't done, the next PRIN1 is placed on the following line even though there is enough room of the string.  I do not understand why this happens.")    (DSPXPOSITION (DSPXPOSITION NIL *CD-WINDOW*)           *CD-WINDOW*)    (PRIN1 (DIRECTORYNAME T)           *CD-WINDOW*)    NIL))(CD-SIZE-WINDOW  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 15:49 by gadener")    (LET ((LEFT (CAR (WINDOWPROP *CD-WINDOW* 'REGION)))          (BOTTOM (CADR (WINDOWPROP *CD-WINDOW* 'REGION)))          (WIDTH (WIDTHIFWINDOW (IPLUS (STRINGWIDTH (DIRECTORYNAME T)                                              *CD-WINDOW-DIR-FONT*)                                       (STRINGWIDTH "  Dir: " *CD-WINDOW-TITLE-FONT*))))          (HEIGHT (HEIGHTIFWINDOW (FONTPROP *CD-WINDOW-TITLE-FONT* 'HEIGHT))))         (WINDOWPROP *CD-WINDOW* 'RESHAPEFN NIL)         (SHAPEW *CD-WINDOW* (CREATEREGION LEFT BOTTOM WIDTH HEIGHT))         (WINDOWPROP *CD-WINDOW* 'RESHAPEFN 'DON\'T)         NIL)))(CD-CREATE-MENU  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 16:48 by gadener")    (MENU (|create| MENU                 TITLE _ "New Directory?"                 ITEMS _ (APPEND '(|Clear All| |Remove a Directory| | Connect to Other Directory |                                          ----------)                                *CD-DIRECTORIES*)                 CENTERFLG _ T))))(CD-GET-NEW-DIR  (LAMBDA NIL                                     (* \; "Edited 26-Jan-89 11:17 by KWMountford")    (LET ((WINDOW-WIDTH (WIDTHIFWINDOW (STRINGWIDTH (DIRECTORYNAME T)                                              DEFAULTFONT)))          (WINDOW-HEIGHT (HEIGHTIFWINDOW (FONTPROP DEFAULTFONT 'HEIGHT)                                T 5))          REGION WINDOW NEW-DIR)         (|if| (IGREATERP WINDOW-WIDTH 400)             |then| (SETQ WINDOW-WIDTH (IPLUS WINDOW-WIDTH 300))           |else| (SETQ WINDOW-WIDTH 600))         (SETQ REGION (CREATEREGION 200 400 WINDOW-WIDTH WINDOW-HEIGHT))         (SETQ WINDOW (SETQ WINDOW (CREATEW REGION "New Directory? " 5)))         (SETQ NEW-DIR (PROMPTFORWORD NIL (DIRECTORYNAME T)                              NIL WINDOW))         (CD-CONNECT NEW-DIR)         (CLOSEW WINDOW)         *CD-DIRECTORIES*)))(CD-REMOVE-DIR  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 14:43 by gadener")    (LET (REMOVE-DIR)         (|if| *CD-DIRECTORIES*             |then| (SETQ REMOVE-DIR                         (MENU (|create| MENU                                      TITLE _ " Remove Which Directory? "                                      ITEMS _ *CD-DIRECTORIES*                                      CENTERFLG _ T)))                   (SETQ *CD-DIRECTORIES* (REMOVE REMOVE-DIR *CD-DIRECTORIES*))           |else| (PRINTOUT PROMPTWINDOW T "There is nothing to remove!")                 (FLASHWINDOW PROMPTWINDOW 2)))))(CD-CLEAR-ALL  (LAMBDA NIL                                         (* \; "Edited  9-Nov-90 14:36 by gadener")    (FLASHWINDOW PROMPTWINDOW 2)    (|if| (MOUSECONFIRM "Are you sure you want to clear all your directories?" NIL PROMPTWINDOW                      NIL)        |then| (SETQ *CD-DIRECTORIES* NIL))))(CD-CONNECT  (LAMBDA (NEW-DIR)                                   (* \; "Edited  9-Nov-90 16:49 by gadener")    (LET ((DIR (DIRECTORYNAME NEW-DIR)))         (|if| DIR             |then| (SETQ *CD-DIRECTORIES* (CD-ORDER-ITEMS DIR *CD-DIRECTORIES*))                   (SETQ *CD-CURRENT-DIR* (MKSTRING (CNDIR NEW-DIR)))           |else| (PROMPTPRINT "Not a valid directory name.")                 (FLASHWINDOW PROMPTWINDOW 2)))))(CD-ORDER-ITEMS  (LAMBDA (NEW-DIR OLD-LIST)                          (* \; "Edited  9-Nov-90 16:47 by gadener")    (* |;;| " When we enter here, we can assume that OLD-LIST is already sorted according to length. ALso Dir is already a canonical string directory name.")    (LET ((COMPARE-DIR (CAR OLD-LIST)))         (COND            ((NULL OLD-LIST)             (LIST NEW-DIR))            ((STRING-EQUAL NEW-DIR COMPARE-DIR)             OLD-LIST)            ((LESSP (STRINGWIDTH DIR MENUFONT)                    (STRINGWIDTH COMPARE-DIR MENUFONT))             (CONS DIR OLD-LIST))            (T (CONS COMPARE-DIR (CD-ORDER-ITEMS NEW-DIR (CDR OLD-LIST)))))))))(APPENDTOVAR |BackgroundMenuCommands| ("Directory Connector" (CD-SETUP)                                                                        "Creates a current-directory window which has change directory functionality."                                                 (SUBITEMS ("Change Font" (CD-CHANGE-FONT)                                                                                                                           "Changes the current-directory window font."                                                                  ))))(SETQ |BackgroundMenu| NIL)(PUTPROPS CONN-DIR COPYRIGHT ("ENVOS Corporation" 1989 1990))(DECLARE\: DONTCOPY  (FILEMAP (NIL (1316 6373 (CD-SETUP 1326 . 2902) (CD-KILL-PROCESS 2904 . 3138) (CD-FONT-FAMILY-MENU 3140 . 4752) (CD-FONT-SIZE-MENU 4754 . 5294) (CD-CHANGE-FONT 5296 . 6371)) (6374 6753 (CD-PERODICALLY-UPDATE 6384 . 6751)) (6754 13087 (CD-BUTTONEVENTFN 6764 . 8142) (CD-UPDATE-WINDOW 8144 . 8849) (CD-SIZE-WINDOW 8851 . 9584) (CD-CREATE-MENU 9586 . 10019) (CD-GET-NEW-DIR 10021 . 10921) (CD-REMOVE-DIR 10923 . 11595) (CD-CLEAR-ALL 11597 . 11929) (CD-CONNECT 11931 . 12391) (CD-ORDER-ITEMS 12393 . 13085)))))STOP