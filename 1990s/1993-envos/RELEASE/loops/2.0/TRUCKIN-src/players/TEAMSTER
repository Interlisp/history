(DEFINE-FILE-INFO PACKAGE "IL" READTABLE "INTERLISP" BASE 10)(FILECREATED "12-Jul-88 21:53:43" |{POGO:AISNORTH:XEROX}<LOOPSCORE>TRUCKIN>PLAYERS>TEAMSTER.;2| 63851        changes to%:  (CLASSES Teamster)                    (METHODS Teamster.TakeTurn Teamster.SellGoods Teamster.RateSpotsNearAlices                            Teamster.RateProducers Teamster.RateConsumers Teamster.MaxPurchase                            Teamster.GoToStoppingPlace Teamster.FindStoppingPlace)                    (VARS TEAMSTERCOMS)      previous date%: "15-Sep-87 21:01:57" |{POGO:AISNORTH:XEROX}<LOOPSCORE>TRUCKIN>PLAYERS>TEAMSTER.;1|)(* "Copyright (c) 1987, 1988 by Xerox Corporation.  All rights reserved.")(PRETTYCOMPRINT TEAMSTERCOMS)(RPAQQ TEAMSTERCOMS ((DECLARE%: DONTCOPY (PROP MAKEFILE-ENVIRONMENT TEAMSTER))                     (CLASSES Teamster)                     (INSTANCES GetPriceRatio)                     (FNS GetPriceRatio TakeTurnBigMacRules Teamster.SelectPr)                     (METHODS Teamster.FindStoppingPlace Teamster.GoToStoppingPlace                             Teamster.MaxPurchase Teamster.RateConsumers Teamster.RateProducers                             Teamster.RateSpotsNearAlices Teamster.SellGoods Teamster.TakeTurn)))(DECLARE%: DONTCOPY (PUTPROPS TEAMSTER MAKEFILE-ENVIRONMENT (:PACKAGE "IL" :READTABLE "INTERLISP" :BASE 10)))(DEFCLASSES Teamster)(DEFCLASS Teamster   (MetaClass PlayerMeta Edited%:                            (* edited%: "15-JUL-83 10:46"))   (Supers Peddler)   (ClassVariables (CopyCV (Icon InitializeIVs))          (InitializeIVs #,NotSetValue)          (Icon #,NotSetValue))   (InstanceVariables (cashReserve 2000)))(METH NIL  NIL (roadStop)      NIL (method #,NotSetValue RuleSet #,($& RuleSet (LNS.0.5349.46.57775 . 117)) methodClass                  RuleSet UID (LNS.0.5349.46.57775 . 117))          (perspectiveNode #,($& RuleSetNode (LNS.0.5349.46.57775 . 154)))          (name #,($A GetPriceRatio NIL RememberName))          (compiledRules GetPriceRatio)          (workSpace Teamster)          (tempVars (priceRatio))          (taskVars NIL)          (debugVars NIL)          (numRules 1)          (controlStructure DOALL)          (whileCondition NIL)          (compilerOptions NIL)          (auditClass NIL)          (metaAssignments NIL)          (ruleClass NIL))(DEFINST RuleSetNode ((LNS.0.5349.46.57775 . 154))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LNS.0.5349.46.57775 . 117)) Source #,($& RuleSetSource (LNS.0.5349.46.57775 . 163))))(DEFINST RuleSetSource ((LNS.0.5349.46.57775 . 163))         (perspectiveNode #,($& RuleSetNode (LNS.0.5349.46.57775 . 154)))         (created "15-JUL-83 10:50:42")         (creator LOOPSCOURSE)         (edited "15-JUL-83 10:55:13")         (editor BENSON)         (ruleList (#,($& Rule (LNS.0.5349.46.57775 . 171))))         (indexedVars ((#,($& Rule (LNS.0.5349.46.57775 . 171))))))(DEFINST Rule ((LNS.0.5349.46.57775 . 171))         (source "(* Get the priceRatio from a roadstop)-> priceRatio _ roadStop:pr;")         (edited "15-JUL-83 10:55:13")         (editor BENSON)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LNS.0.5349.46.57775 . 117))))(DEFINEQ(GetPriceRatio  [LAMBDA (self roadStop)    (PROG (^value priceRatio)          [SETQ ^value (SETQ priceRatio (GetValue roadStop 'pr]      QUIT          (RETURN ^value])(TakeTurnBigMacRules  [LAMBDA (self)                                             (* edited%: "15-Sep-87 14:46")    (PROG (^auditRecord ^value temp)          [COND             ((NOT (GetValue self 'destination))              (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                         (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                               NewTemp))                                         (PutValue ^auditRecord 'rule (GetObjFromUID                                                                       '(LNS.0.5349.46.57775 . 40]                                  (PutAuditRec self 'destination (AnyRoadStop ($ AlicesRestaurant))                                         ^auditRecord)                                  (PutAuditRec self 'direction 'Forward ^auditRecord]          [COND             ((NOT (GetValue self 'nextDestination))              (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                         (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                               NewTemp))                                         (PutValue ^auditRecord 'rule (GetObjFromUID                                                                       '(LNS.0.5349.46.57775 . 41]                                  (PutAuditRec self 'nextDestination (AnyRoadStop ($ UnionHall))                                         ^auditRecord)                                  (SETQ temp 'Backward]          [COND             ((EQ (GetValue self 'stoppingPlace)                  (GetValue self 'destination))              (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                         (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                               NewTemp))                                         (PutValue ^auditRecord 'rule (GetObjFromUID                                                                       '(LNS.0.5349.46.57775 . 42]                                  (PutAuditRec self 'destination (GetValue self 'nextDestination)                                         ^auditRecord)                                  (PutAuditRec self 'direction temp ^auditRecord]          [COND             ((_ (GetValue (GetValue self 'truck)                        'location)                 InstOf                 ($ UnionHall))              (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                         (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                               NewTemp))                                         (PutValue ^auditRecord 'rule (GetObjFromUID                                                                       '(LNS.0.5349.46.57775 . 43]                                  (PutAuditRec self 'nextDestination (AnyRoadStop ($ AlicesRestaurant                                                                                     ))                                         ^auditRecord)                                  (SETQ temp 'Forward]          [COND             ((_ (GetValue (GetValue self 'truck)                        'location)                 InstOf                 ($ AlicesRestaurant))              (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                         (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                               NewTemp))                                         (PutValue ^auditRecord 'rule (GetObjFromUID                                                                       '(LNS.0.5349.46.57775 . 44]                                  (PutAuditRec self 'nextDestination (AnyRoadStop ($ UnionHall))                                         ^auditRecord)                                  (SETQ temp 'Backward]          (SETQ ^value (_ self GoToStoppingPlace))      QUIT          (RETURN ^value])(Teamster.SelectPr  [LAMBDA (self roadStop)                                    (* edited%: "15-JUL-83 10:39")                                                             (* Select a price ratio and return it)    (GetValue roadStop 'pr]))(\BatchMethodDefs)(METH Teamster  FindStoppingPlace NIL      "Method implementing a RuleSet" (method Teamster.FindStoppingPlace RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 1)) methodClass RuleSet UID (LLX0.%:F5.o28._zB . 1))            (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 22)))            (name #,($A Teamster.FindStoppingPlace NIL RememberName))            (compiledRules Teamster.FindStoppingPlace)            (workSpace Teamster)            (tempVars (wStation gasStation))            (taskVars NIL)            (debugVars NIL)            (numRules 5)            (controlStructure DO1)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH Teamster  GoToStoppingPlace NIL      "Method implementing a RuleSet" (method Teamster.GoToStoppingPlace RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 7)) methodClass RuleSet UID (LLX0.%:F5.o28._zB . 7))            (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 23)))            (name #,($A Teamster.GoToStoppingPlace NIL RememberName))            (compiledRules Teamster.GoToStoppingPlace)            (workSpace Teamster)            (tempVars (realLocation numBuy))            (taskVars NIL)            (debugVars NIL)            (numRules 7)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH Teamster  MaxPurchase (roadStop)      "Method implementing a RuleSet" (method Teamster.MaxPurchase RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 9)) methodClass RuleSet UID (LLX0.%:F5.o28._zB . 9))            (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 24)))            (name #,($A Teamster.MaxPurchase NIL RememberName))            (compiledRules Teamster.MaxPurchase)            (workSpace Teamster)            (tempVars (volumeCapacity weightCapacity volumeLimit weightLimit cashLimit producerLimit                              numBuy cashCapacity))            (taskVars NIL)            (debugVars NIL)            (numRules 3)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH Teamster  RateConsumers (roadStop)      "Method implementing a RuleSet" (method Teamster.RateConsumers RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10)) methodClass RuleSet UID (LLX0.%:F5.o28._zB . 10))            (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 25)))            (name #,($A Teamster.RateConsumers NIL RememberName))            (compiledRules Teamster.RateConsumers)            (workSpace Teamster)            (tempVars (rating cargo))            (taskVars NIL)            (debugVars NIL)            (numRules 8)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH Teamster  RateProducers (roadStop)      "Method implementing a RuleSet" (method Teamster.RateProducers RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11)) methodClass RuleSet UID (LLX0.%:F5.o28._zB . 11))            (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 26)))            (name #,($A Teamster.RateProducers NIL RememberName))            (compiledRules Teamster.RateProducers)            (workSpace Teamster)            (tempVars (rating maxBuy possibleConsumer expPr expProfit))            (taskVars NIL)            (debugVars (maxBuy rating expPr expProfit))            (numRules 8)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions NIL)            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH Teamster  RateSpotsNearAlices (roadStop)      "Method implementing a RuleSet" (method Teamster.RateSpotsNearAlices RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 12)) methodClass RuleSet UID (LLX0.%:F5.o28._zB . 12))            (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 27)))            (name #,($A Teamster.RateSpotsNearAlices NIL RememberName))            (compiledRules Teamster.RateSpotsNearAlices)            (workSpace Teamster)            (tempVars (rating cargo))            (taskVars NIL)            (debugVars NIL)            (numRules 6)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions NIL)            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH Teamster  SellGoods NIL      "Method implementing a RuleSet" (method Teamster.SellGoods RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 13)) methodClass RuleSet UID (LLX0.%:F5.o28._zB . 13))            (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 28)))            (name #,($A Teamster.SellGoods NIL RememberName))            (compiledRules Teamster.SellGoods)            (workSpace Teamster)            (tempVars (cargo sellQty))            (taskVars NIL)            (debugVars NIL)            (numRules 6)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(METH Teamster  TakeTurn NIL      "Method implementing a RuleSet" (method Teamster.TakeTurn RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14)) methodClass RuleSet UID (LLX0.%:F5.o28._zB . 14))            (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 29)))            (name #,($A Teamster.TakeTurn NIL RememberName))            (compiledRules Teamster.TakeTurn)            (workSpace Teamster)            (tempVars (possibleStops))            (taskVars NIL)            (debugVars NIL)            (numRules 8)            (controlStructure DOALL)            (whileCondition NIL)            (compilerOptions (A))            (auditClass NIL)            (metaAssignments NIL)            (ruleClass NIL))(DEFINST RuleSetNode ((LLX0.%:F5.o28._zB . 22))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 1)) Source #,($& RuleSetSource (LLX0.%:F5.o28._zB . 30))))(DEFINST RuleSetNode ((LLX0.%:F5.o28._zB . 23))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 7)) Source #,($& RuleSetSource (LLX0.%:F5.o28._zB . 31))))(DEFINST RuleSetNode ((LLX0.%:F5.o28._zB . 24))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 9)) Source #,($& RuleSetSource (LLX0.%:F5.o28._zB . 32))))(DEFINST RuleSetNode ((LLX0.%:F5.o28._zB . 25))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10)) Source #,($& RuleSetSource (LLX0.%:F5.o28._zB . 33))))(DEFINST RuleSetNode ((LLX0.%:F5.o28._zB . 26))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11)) Source #,($& RuleSetSource (LLX0.%:F5.o28._zB . 34))))(DEFINST RuleSetNode ((LLX0.%:F5.o28._zB . 27))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 12)) Source #,($& RuleSetSource (LLX0.%:F5.o28._zB . 35))))(DEFINST RuleSetNode ((LLX0.%:F5.o28._zB . 28))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 13)) Source #,($& RuleSetSource (LLX0.%:F5.o28._zB . 36))))(DEFINST RuleSetNode ((LLX0.%:F5.o28._zB . 29))         (perspectives #,NotSetValue RuleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14)) Source #,($& RuleSetSource (LLX0.%:F5.o28._zB . 37))))(DEFINST RuleSetSource ((LLX0.%:F5.o28._zB . 30))         (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 22)))         (created "12-Jul-88 21:23:13")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LLX0.%:F5.o28._zB . 38)) #,($& Rule (LLX0.%:F5.o28._zB . 39)) #,($& Rule (LLX0.%:F5.o28._zB . 40)) #,($& Rule (LLX0.%:F5.o28._zB . 41)) #,($& Rule (LLX0.%:F5.o28._zB . 42)))))(DEFINST RuleSetSource ((LLX0.%:F5.o28._zB . 31))         (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 23)))         (created "12-Jul-88 21:23:25")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LLX0.%:F5.o28._zB . 43)) #,($& Rule (LLX0.%:F5.o28._zB . 44)) #,($& Rule (LLX0.%:F5.o28._zB . 45)) #,($& Rule (LLX0.%:F5.o28._zB . 46)) #,($& Rule (LLX0.%:F5.o28._zB . 47)) #,($& Rule (LLX0.%:F5.o28._zB . 48)) #,($& Rule (LLX0.%:F5.o28._zB . 49)))))(DEFINST RuleSetSource ((LLX0.%:F5.o28._zB . 32))         (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 24)))         (created "12-Jul-88 21:23:28")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LLX0.%:F5.o28._zB . 50)) #,($& Rule (LLX0.%:F5.o28._zB . 51)) #,($& Rule (LLX0.%:F5.o28._zB . 52)))))(DEFINST RuleSetSource ((LLX0.%:F5.o28._zB . 33))         (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 25)))         (created "12-Jul-88 21:23:32")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LLX0.%:F5.o28._zB . 53)) #,($& Rule (LLX0.%:F5.o28._zB . 54)) #,($& Rule (LLX0.%:F5.o28._zB . 55)) #,($& Rule (LLX0.%:F5.o28._zB . 56)) #,($& Rule (LLX0.%:F5.o28._zB . 57)) #,($& Rule (LLX0.%:F5.o28._zB . 58)) #,($& Rule (LLX0.%:F5.o28._zB . 59)) #,($& Rule (LLX0.%:F5.o28._zB . 60)))))(DEFINST RuleSetSource ((LLX0.%:F5.o28._zB . 34))         (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 26)))         (created "12-Jul-88 21:23:43")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LLX0.%:F5.o28._zB . 61)) #,($& Rule (LLX0.%:F5.o28._zB . 62)) #,($& Rule (LLX0.%:F5.o28._zB . 63)) #,($& Rule (LLX0.%:F5.o28._zB . 64)) #,($& Rule (LLX0.%:F5.o28._zB . 65)) #,($& Rule (LLX0.%:F5.o28._zB . 66)) #,($& Rule (LLX0.%:F5.o28._zB . 67)) #,($& Rule (LLX0.%:F5.o28._zB . 68)))))(DEFINST RuleSetSource ((LLX0.%:F5.o28._zB . 35))         (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 27)))         (created "12-Jul-88 21:23:46")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LLX0.%:F5.o28._zB . 69)) #,($& Rule (LLX0.%:F5.o28._zB . 70)) #,($& Rule (LLX0.%:F5.o28._zB . 71)) #,($& Rule (LLX0.%:F5.o28._zB . 72)) #,($& Rule (LLX0.%:F5.o28._zB . 73)) #,($& Rule (LLX0.%:F5.o28._zB . 74)))))(DEFINST RuleSetSource ((LLX0.%:F5.o28._zB . 36))         (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 28)))         (created "12-Jul-88 21:23:49")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LLX0.%:F5.o28._zB . 75)) #,($& Rule (LLX0.%:F5.o28._zB . 76)) #,($& Rule (LLX0.%:F5.o28._zB . 77)) #,($& Rule (LLX0.%:F5.o28._zB . 78)) #,($& Rule (LLX0.%:F5.o28._zB . 79)) #,($& Rule (LLX0.%:F5.o28._zB . 80)))))(DEFINST RuleSetSource ((LLX0.%:F5.o28._zB . 37))         (perspectiveNode #,($& RuleSetNode (LLX0.%:F5.o28._zB . 29)))         (created "12-Jul-88 21:23:52")         (creator "BANE")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleList (#,($& Rule (LLX0.%:F5.o28._zB . 81)) #,($& Rule (LLX0.%:F5.o28._zB . 82)) #,($& Rule (LLX0.%:F5.o28._zB . 83)) #,($& Rule (LLX0.%:F5.o28._zB . 84)) #,($& Rule (LLX0.%:F5.o28._zB . 85)) #,($& Rule (LLX0.%:F5.o28._zB . 86)) #,($& Rule (LLX0.%:F5.o28._zB . 87)) #,($& Rule (LLX0.%:F5.o28._zB . 88)))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 38))         (source "(* Returns a stopping place en route to a destination.)IF truck:fuel=0THEN stoppingPlace_(AnyRoadStop $UnionHall);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 1))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 39))         (source "(* Dont run out of gas.)IF goal~='SitTight    truck:fuel < .25 * truck::MaxFuel   truck:cashBox>0   gasStation_(NearestRoadStop (RoadStops $GasStation .Range1                                             direction 'Room))THEN stoppingPlace_gasStation;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 1))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 40))         (source "(* Obey the law - stop at WeighStations.)IF wStation_(NearestRoadStop (RoadStops $WeighStation .Range1 direction 'Room))   (Distance wStation)<(Distance destination) THEN stoppingPlace_wStation;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 1))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 41))         (source        "IF (Distance destination)<=.Range1 (RoomToParkP destination)THEN stoppingPlace_destination;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 1))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 42))         (source "THEN stoppingPlace_(NthRoadStop  maxMove direction NIL 'Room);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 1))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 43))         (source "	-> direction_(DirectionOf destination);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 7))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 44))         (source "        -> realLocation_truck:location;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 7))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 45))         (source "	IF .FindStoppingPlace stoppingPlace~=truck:location          ~stoppingPlace.BanditP	THEN (_ \PlayerInterface Move self stoppingPlace)               realLocation_truck:location;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 7))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 46))         (source "        IF realLocation~=stoppingPlace 	THEN (WriteGameStatus %"Oh!! %" driver %" Didnt reach stoppingPlace%");")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 7))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 47))         (source "	IF (ISA realLocation $GasStation)	THEN .BuyGas;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 7))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 48))         (source "	IF (ISA realLocation $Producer) ~(ISA realLocation $GasStation)           goal='Peddle	   realLocation=destination            numBuy_(_ self MaxPurchase realLocation)           numBuy>=1  	THEN (_ \PlayerInterface Buy self numBuy);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 7))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 49))         (source "	IF (ISA realLocation $Consumer) truck:cargo	THEN .SellGoods;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 7))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 50))         (source "	(* Rules for deciding how much the Peddler could buy at a Producer.)(* Sale can be limited by volume, weight, cash, or availability.)-> volumeCapacity _ truck::MaxVolume-truck:volume   weightCapacity _ truck::MaxWeight-truck:weight   cashCapacity _ (MAX 0  truck:cashBox-cashReserve);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 9))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 51))         (source "   -> volumeLimit _ volumeCapacity / roadStop::Commodity::VolPerQty   weightLimit _ weightCapacity / roadStop::Commodity::WtPerQty   cashLimit _ cashCapacity / (PricePerUnit roadStop)   producerLimit _ roadStop:qty;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 9))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 52))         (source "-> numBuy _ (MIN volumeLimit weightLimit cashLimit producerLimit);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 9))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 53))         (source           "	(* Rate the suitability of a proposed Consumer.)-> cargo _ (CAR truck:cargo) rating_0;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 54))         (source "(* if spoiled go to CityDump)IF ~cargo:status (ISA roadStop $CityDump) THEN (STOP 5000 'CityDump 'LookNoMore);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 55))         (source "IF ~cargo:statusTHEN (STOP NIL 'SpoiltGoods 'CannotSell);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 56))         (source "(* Consumer must want current cargo.) IF ~(ISA cargo roadStop::Commodity)  THEN rating _ rating - 5000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 57))         (source               "(* Need to be able to park) IF ~(RoomToParkP roadStop)  THEN rating _ rating - 500;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 58))         (source "(* Exclude consumers that have full inventory.) IF roadStop:qty < 1  THEN rating _ rating - 1000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 59))         (source "(* Favor high price ratios.)  -> rating _ rating + 100 * roadStop:pr ;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 60))         (source    "(* Favor close places.)  -> rating _ rating - [truck::Gpm *(Distance roadStop truck:location)];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 8)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 10))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 61))         (source "	(* Rate the suitability of a proposed Producer.)-> rating _ 0;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 62))         (source "(* Need to be able to park)IF ~(RoomToParkP roadStop) THEN rating _ -500;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 63))         (source "(* Exclude perishables.) IF (SUBCLASS roadStop::Commodity $PerishableCommodity)  THEN rating _ -50000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 64))         (source "(* Exclude gas stations.) IF (ISA roadStop $GasStation)  THEN rating _ -100000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 65))         (source              "(* Exclude producers that are sold out.) IF roadStop:qty < 1  THEN rating _ -100000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 66))         (source "(* Exclude excessively fragile goods.) IF (SUBCLASS roadStop::Commodity $FragileCommodity)    THEN rating _ rating - [500 * roadStop::Commodity::FragilityLevel];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 67))         (source "(* Favor high expected profit)IF possibleConsumer_(NearestRoadStop                      (Buyers roadStop::Commodity))   maxBuy _ (_ self MaxPurchase roadStop)   expPr _ possibleConsumer:pr   expProfit _ [expPr - roadStop:pr] * roadStop::Commodity::AvgPrice * maxBuyTHEN rating _ rating + expProfit;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 68))         (source      "(* Favor close places)-> rating _ rating - [truck::Gpm * (Distance roadStop truck:location)];")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 8)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 11))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 69))         (source "(* Rating RuleSet for spots near Alices.  Returns a number for spots.)-> cargo _ (CAR truck:cargo);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 12))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 70))         (source             "   (* Favor places closer to Alices.)-> rating _ 100 - 4 * (Distance roadStop alices);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 12))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 71))         (source "IF ~(RoomToParkP roadStop) THEN rating _ -1000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 12))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 72))         (source "IF (ISA roadStop $UnionHall) THEN rating _ -1000;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 12))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 73))         (source "IF (ISA roadStop $AlicesRestaurant) THEN rating _ -500;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 12))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 74))         (source "IF cargo (ISA roadStop $Consumer) (ISA cargo roadStop::Commodity)   roadStop:qty>0 roadStop:pr>1 THEN rating _ rating + 20;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 12))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 75))         (source "	-> cargo_(CAR truck:cargo);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 13))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 76))         (source              "	IF ~(ISA cargo truck:location::Commodity)	THEN (STOP NIL 'NoSale 'WrongKindOfBuyer);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 13))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 77))         (source               "	IF truck:location:pr < 1.1 goal='Peddle 	THEN (STOP NIL 'NoSale 'AvoidCheapSkates);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 13))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 78))         (source "	IF truck:location:pr < 0 	THEN (STOP NIL 'NoSale 'NeverSellAtLoss);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 13))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 79))         (source "(* Make sale as limited by cargo and consumer.)IF ~cargo:status (ISA truck:location $CityDump)THEN sellQty_(MIN truck:location:qty cargo:qty)      (_ \PlayerInterface Sell self cargo sellQty)     (STOP T 'Sold 'AtCityDump);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 13))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 80))         (source "	IF cargo:status sellQty_(MIN truck:location:qty cargo:qty) sellQty>=1 	THEN (_ \PlayerInterface Sell self cargo sellQty);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 13))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 81))         (source "   (* Top-Level RuleSet for taking turns.  Sets goal and destination.) IF ~goal  THEN goal_'Peddle;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 1)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 82))         (source " IF truck:cargo goal='Peddle possibleStops_(RoadStops $Consumer)  THEN destination_(PickHiObj self 'RateConsumers possibleStops);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 2)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 83))         (source " IF ~truck:cargo goal='Peddle possibleStops_(RoadStops $Producer)  THEN destination_(PickHiObj self 'RateProducers possibleStops);")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 3)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 84))         (source "(* Don't move away from Alices during endgame.) IF goal='GoToAlices truck:location=alices  THEN goal_'SitTight;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 4)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 85))         (source "(* Except dont overstay at Alices.)IF truck:location=alices  .TimeAtStop > 25 goal='SitTight THEN alices_(NearestRoadStop (RoadStops $AlicesRestaurant))       destination_ (PickHiObj self 'RateSpotsNearAlices (RoadStops))       goal_'GetClose;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 5)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 86))         (source "(* Get near to Alices when time gets close)		 IF \Simulator:timeLeft < 50 ~[goal<<'(SitTight GetClose GoToAlices)]    THEN alices_(NearestRoadStop (RoadStops $AlicesRestaurant))       destination_ (PickHiObj self 'RateSpotsNearAlices (RoadStops))       goal_'GetClose;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 6)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 87))         (source "(* Go to Alices now that it is time) IF \Simulator:timeLeft < 30     ~(ISA truck:location $AlicesRestaurant)     THEN destination_ (NearestRoadStop (RoadStops $AlicesRestaurant))       goal_'GoToAlices ;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 7)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14))))(DEFINST Rule ((LLX0.%:F5.o28._zB . 88))         (source "IF ~(OR goal='SitTight        (AND goal='GetClose (Distance truck:location alices)<=3)) THEN .GoToStoppingPlace;")         (edited "11-Jul-88 21:48:50")         (editor BANE)         (ruleNumber 8)         (ruleSet #,($& RuleSet (LLX0.%:F5.o28._zB . 14))))(Method ((Teamster FindStoppingPlace) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value wStation gasStation)     ^firstRules         [COND            [(EQ (GetValue (GetValue self 'truck)                        'fuel)                 0)             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 2]                                 (PutAuditRec self 'stoppingPlace (AnyRoadStop ($ UnionHall))                                        ^auditRecord]            [[AND (NEQ (GetValue self 'goal)                       'SitTight)                  [LESSP (GetValue (GetValue self 'truck)                                'fuel)                         (TIMES 0.25 (GetClassValue (GetValue self 'truck)                                            'MaxFuel]                  (GREATERP (GetValue (GetValue self 'truck)                                   'cashBox)                         0)                  (SETQ gasStation (NearestRoadStop (RoadStops ($ GasStation)                                                           (_ self Range1)                                                           (GetValue self 'direction)                                                           'Room]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 3]                                 (PutAuditRec self 'stoppingPlace gasStation ^auditRecord]            [[AND [SETQ wStation (NearestRoadStop (RoadStops ($ WeighStation)                                                         (_ self Range1)                                                         (GetValue self 'direction)                                                         'Room]                  (LESSP (Distance wStation)                         (Distance (GetValue self 'destination]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 4]                                 (PutAuditRec self 'stoppingPlace wStation ^auditRecord]            [[AND (LEQ (Distance (GetValue self 'destination))                       (_ self Range1))                  (RoomToParkP (GetValue self 'destination]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 5]                                 (PutAuditRec self 'stoppingPlace (GetValue self 'destination)                                        ^auditRecord]            (T (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                          (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                                New))                                          (PutValue ^auditRecord 'rule (GetObjFromUID                                                                        '(LLX0.%:F5.o28._zB . 6]                                   (PutAuditRec self 'stoppingPlace (NthRoadStop (GetValue                                                                                  self                                                                                  'maxMove)                                                                           (GetValue self                                                                                  'direction)                                                                           NIL                                                                           'Room)                                          ^auditRecord]     QUIT     ^lastRules         (RETURN ^value)))(Method ((Teamster GoToStoppingPlace) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value realLocation numBuy)     ^firstRules         (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                    (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                          New))                                    (PutValue ^auditRecord 'rule (GetObjFromUID '(LLX0.%:F5.o28._zB . 8                                                                                  ]                             (PutAuditRec self 'direction (DirectionOf (GetValue self 'destination))                                    ^auditRecord)))         [SETQ ^value (SETQ realLocation (GetValue (GetValue self 'truck)                                                'location]         [COND            ((AND (_ self FindStoppingPlace)                  (NEQ (GetValue self 'stoppingPlace)                       (GetValue (GetValue self 'truck)                              'location))                  (NOT (_ (GetValue self 'stoppingPlace)                          BanditP)))             (SETQ ^value (PROGN (_ PlayerInterface Move self (GetValue self 'stoppingPlace))                                 (SETQ realLocation (GetValue (GetValue self 'truck)                                                           'location]         [COND            ((NEQ realLocation (GetValue self 'stoppingPlace))             (SETQ ^value (WriteGameStatus "Oh!! " (GetValue self 'driver)                                 " Didnt reach stoppingPlace"]         [COND            ((ISA realLocation ($ GasStation))             (SETQ ^value (_ self BuyGas)]         [COND            ((AND (ISA realLocation ($ Producer))                  (NOT (ISA realLocation ($ GasStation)))                  (EQ (GetValue self 'goal)                      'Peddle)                  (EQ realLocation (GetValue self 'destination))                  (SETQ numBuy (_ self MaxPurchase realLocation))                  (GEQ numBuy 1))             (SETQ ^value (_ PlayerInterface Buy self numBuy)]         [COND            ((AND (ISA realLocation ($ Consumer))                  (GetValue (GetValue self 'truck)                         'cargo))             (SETQ ^value (_ self SellGoods)]     QUIT     ^lastRules         (RETURN ^value)))(Method ((Teamster MaxPurchase) self roadStop) "Method implementing a RuleSet"   (PROG (^auditRecord ^value volumeCapacity weightCapacity volumeLimit weightLimit cashLimit                 producerLimit numBuy cashCapacity)     ^firstRules         [SETQ ^value (PROGN [SETQ volumeCapacity (DIFFERENCE (GetClassValue (GetValue self                                                                                    'truck)                                                                     'MaxVolume)                                                         (GetValue (GetValue self 'truck)                                                                'volume]                             [SETQ weightCapacity (DIFFERENCE (GetClassValue (GetValue self                                                                                    'truck)                                                                     'MaxWeight)                                                         (GetValue (GetValue self 'truck)                                                                'weight]                             (SETQ cashCapacity (MAX 0 (DIFFERENCE (GetValue (GetValue self                                                                                    'truck)                                                                          'cashBox)                                                              (GetValue self 'cashReserve]         [SETQ ^value (PROGN [SETQ volumeLimit (QUOTIENT volumeCapacity (GetClassValue                                                                         (GetClassValue roadStop                                                                                'Commodity)                                                                         'VolPerQty]                             [SETQ weightLimit (QUOTIENT weightCapacity (GetClassValue                                                                         (GetClassValue roadStop                                                                                'Commodity)                                                                         'WtPerQty]                             (SETQ cashLimit (QUOTIENT cashCapacity (PricePerUnit roadStop)))                             (SETQ producerLimit (GetValue roadStop 'qty]         (SETQ ^value (SETQ numBuy (MIN volumeLimit weightLimit cashLimit producerLimit)))     QUIT     ^lastRules         (RETURN ^value)))(Method ((Teamster RateConsumers) self roadStop) "Method implementing a RuleSet"   (PROG (^auditRecord ^value rating cargo)     ^firstRules         (SETQ ^value (PROGN [SETQ cargo (CAR (GetValue (GetValue self 'truck)                                                     'cargo]                             (SETQ rating 0)))         [COND            ((AND (NOT (GetValue cargo 'status))                  (ISA roadStop ($ CityDump)))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop 5000 'CityDump 'LookNoMore)                                 (GO QUIT]         [COND            ((NOT (GetValue cargo 'status))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop NIL 'SpoiltGoods 'CannotSell)                                 (GO QUIT]         [COND            ([NOT (ISA cargo (GetClassValue roadStop 'Commodity]             (SETQ ^value (SETQ rating (DIFFERENCE rating 5000]         [COND            ((NOT (RoomToParkP roadStop))             (SETQ ^value (SETQ rating (DIFFERENCE rating 500]         [COND            ((LESSP (GetValue roadStop 'qty)                    1)             (SETQ ^value (SETQ rating (DIFFERENCE rating 1000]         [SETQ ^value (SETQ rating (PLUS rating (TIMES 100 (GetValue roadStop 'pr]         [SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES (GetClassValue (GetValue self                                                                                   'truck)                                                                    'Gpm)                                                             (Distance roadStop                                                                    (GetValue (GetValue self                                                                                     'truck)                                                                           'location]     QUIT     ^lastRules         (RETURN ^value)))(Method ((Teamster RateProducers) self roadStop) "Method implementing a RuleSet"   (PROG (^value rating maxBuy possibleConsumer expPr expProfit)     ^firstRules         (SETQ ^value (SETQ rating 0))         [COND            ((NOT (RoomToParkP roadStop))             (SETQ ^value (SETQ rating (MINUS 500]         [COND            ((SUBCLASS (GetClassValue roadStop 'Commodity)                    ($ PerishableCommodity))             (SETQ ^value (SETQ rating (MINUS 50000]         [COND            ((ISA roadStop ($ GasStation))             (SETQ ^value (SETQ rating (MINUS 100000]         [COND            ((LESSP (GetValue roadStop 'qty)                    1)             (SETQ ^value (SETQ rating (MINUS 100000]         [COND            ((SUBCLASS (GetClassValue roadStop 'Commodity)                    ($ FragileCommodity))             (SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES 500 (GetClassValue                                                                      (GetClassValue roadStop                                                                             'Commodity)                                                                      'FragilityLevel]         [COND            ((AND [SETQ possibleConsumer (NearestRoadStop (Buyers (GetClassValue roadStop                                                                         'Commodity]                  (SETQ maxBuy (_ self MaxPurchase roadStop))                  (SETQ expPr (GetValue possibleConsumer 'pr))                  (SETQ expProfit (TIMES (TIMES (DIFFERENCE expPr (GetValue roadStop 'pr))                                                (GetClassValue (GetClassValue roadStop 'Commodity)                                                       'AvgPrice))                                         maxBuy)))             (SETQ ^value (SETQ rating (PLUS rating expProfit]         [SETQ ^value (SETQ rating (DIFFERENCE rating (TIMES (GetClassValue (GetValue self                                                                                   'truck)                                                                    'Gpm)                                                             (Distance roadStop                                                                    (GetValue (GetValue self                                                                                     'truck)                                                                           'location]     QUIT     ^lastRules         (RETURN ^value)))(Method ((Teamster RateSpotsNearAlices) self roadStop) "Method implementing a RuleSet"   (PROG (^value rating cargo)     ^firstRules         [SETQ ^value (SETQ cargo (CAR (GetValue (GetValue self 'truck)                                              'cargo]         [SETQ ^value (SETQ rating (DIFFERENCE 100 (TIMES 4 (Distance roadStop (GetValue self                                                                                      'alices]         [COND            ((NOT (RoomToParkP roadStop))             (SETQ ^value (SETQ rating (MINUS 1000]         [COND            ((ISA roadStop ($ UnionHall))             (SETQ ^value (SETQ rating (MINUS 1000]         [COND            ((ISA roadStop ($ AlicesRestaurant))             (SETQ ^value (SETQ rating (MINUS 500]         [COND            ((AND cargo (ISA roadStop ($ Consumer))                  (ISA cargo (GetClassValue roadStop 'Commodity))                  (GREATERP (GetValue roadStop 'qty)                         0)                  (GREATERP (GetValue roadStop 'pr)                         1))             (SETQ ^value (SETQ rating (PLUS rating 20]     QUIT     ^lastRules         (RETURN ^value)))(Method ((Teamster SellGoods) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value cargo sellQty)     ^firstRules         [SETQ ^value (SETQ cargo (CAR (GetValue (GetValue self 'truck)                                              'cargo]         [COND            ([NOT (ISA cargo (GetClassValue (GetValue (GetValue self 'truck)                                                   'location)                                    'Commodity]             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop NIL 'NoSale 'WrongKindOfBuyer)                                 (GO QUIT]         [COND            ((AND (LESSP (GetValue (GetValue (GetValue self 'truck)                                          'location)                                'pr)                         1.1)                  (EQ (GetValue self 'goal)                      'Peddle))             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop NIL 'NoSale 'AvoidCheapSkates)                                 (GO QUIT]         [COND            ((LESSP (GetValue (GetValue (GetValue self 'truck)                                     'location)                           'pr)                    0)             (SETQ ^value (PROGN                             (* ^value set by RuleSetStop)                                 (RuleSetStop NIL 'NoSale 'NeverSellAtLoss)                                 (GO QUIT]         [COND            ((AND (NOT (GetValue cargo 'status))                  (ISA (GetValue (GetValue self 'truck)                              'location)                       ($ CityDump)))             (SETQ ^value (PROGN [SETQ sellQty (MIN (GetValue (GetValue (GetValue self 'truck)                                                                     'location)                                                           'qty)                                                    (GetValue cargo 'qty]                                 (_ PlayerInterface Sell self cargo sellQty)                                 (PROGN                      (* ^value set by RuleSetStop)                                        (RuleSetStop T 'Sold 'AtCityDump)                                        (GO QUIT]         [COND            ((AND (GetValue cargo 'status)                  [SETQ sellQty (MIN (GetValue (GetValue (GetValue self 'truck)                                                      'location)                                            'qty)                                     (GetValue cargo 'qty]                  (GEQ sellQty 1))             (SETQ ^value (_ PlayerInterface Sell self cargo sellQty)]     QUIT     ^lastRules         (RETURN ^value)))(Method ((Teamster TakeTurn) self) "Method implementing a RuleSet"   (PROG (^auditRecord ^value possibleStops)     ^firstRules         [COND            ((NOT (GetValue self 'goal))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 15]                                 (PutAuditRec self 'goal 'Peddle ^auditRecord]         [COND            ([AND (GetValue (GetValue self 'truck)                         'cargo)                  (EQ (GetValue self 'goal)                      'Peddle)                  (SETQ possibleStops (RoadStops ($ Consumer]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 16]                                 (PutAuditRec self 'destination (PickHiObj self 'RateConsumers                                                                        possibleStops)                                        ^auditRecord]         [COND            ([AND (NOT (GetValue (GetValue self 'truck)                              'cargo))                  (EQ (GetValue self 'goal)                      'Peddle)                  (SETQ possibleStops (RoadStops ($ Producer]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 17]                                 (PutAuditRec self 'destination (PickHiObj self 'RateProducers                                                                        possibleStops)                                        ^auditRecord]         [COND            ([AND (EQ (GetValue self 'goal)                      'GoToAlices)                  (EQ (GetValue (GetValue self 'truck)                             'location)                      (GetValue self 'alices]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 18]                                 (PutAuditRec self 'goal 'SitTight ^auditRecord]         [COND            ((AND (EQ (GetValue (GetValue self 'truck)                             'location)                      (GetValue self 'alices))                  (GREATERP (_ self TimeAtStop)                         25)                  (EQ (GetValue self 'goal)                      'SitTight))             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 19]                                 (PutAuditRec self 'alices (NearestRoadStop (RoadStops ($                                                                                      AlicesRestaurant                                                                                          )))                                        ^auditRecord)                                 (PutAuditRec self 'destination (PickHiObj self 'RateSpotsNearAlices                                                                       (RoadStops))                                        ^auditRecord)                                 (PutAuditRec self 'goal 'GetClose ^auditRecord]         [COND            ([AND (LESSP (GetValue Simulator 'timeLeft)                         50)                  (NOT (FMEMB (GetValue self 'goal)                              '(SitTight GetClose GoToAlices]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 20]                                 (PutAuditRec self 'alices (NearestRoadStop (RoadStops ($                                                                                      AlicesRestaurant                                                                                          )))                                        ^auditRecord)                                 (PutAuditRec self 'destination (PickHiObj self 'RateSpotsNearAlices                                                                       (RoadStops))                                        ^auditRecord)                                 (PutAuditRec self 'goal 'GetClose ^auditRecord]         [COND            ([AND (LESSP (GetValue Simulator 'timeLeft)                         30)                  (NOT (ISA (GetValue (GetValue self 'truck)                                   'location)                            ($ AlicesRestaurant]             (SETQ ^value (PROGN [PROGN                     (* Make an audit record for this rule and set its audit values.)                                        (SETQ ^auditRecord (_ ($ StandardAuditRecord)                                                              New))                                        (PutValue ^auditRecord 'rule (GetObjFromUID                                                                      '(LLX0.%:F5.o28._zB . 21]                                 (PutAuditRec self 'destination (NearestRoadStop (RoadStops                                                                                  ($ AlicesRestaurant                                                                                     )))                                        ^auditRecord)                                 (PutAuditRec self 'goal 'GoToAlices ^auditRecord]         [COND            ([NOT (OR (EQ (GetValue self 'goal)                          'SitTight)                      (AND (EQ (GetValue self 'goal)                               'GetClose)                           (LEQ (Distance (GetValue (GetValue self 'truck)                                                 'location)                                       (GetValue self 'alices))                                3]             (SETQ ^value (_ self GoToStoppingPlace)]     QUIT     ^lastRules         (RETURN ^value)))(\UnbatchMethodDefs)(PUTPROPS TEAMSTER COPYRIGHT ("Xerox Corporation" 1987 1988))(DECLARE%: DONTCOPY  (FILEMAP (NIL (3293 8135 (GetPriceRatio 3303 . 3479) (TakeTurnBigMacRules 3481 . 7876) (Teamster.SelectPr 7878 . 8133)))))STOP