(DEFINE-FILE-INFO PACKAGE "INTERLISP" READTABLE "XCL" BASE 10)(FILECREATED "28-Oct-87 12:35:04" {ERIS}<PROLOGCORE>QP2.0>LISP>SECURITY.\;11 7210         |previous| |date:| "15-Oct-87 13:56:18" {ERIS}<PROLOGCORE>QP2.0>LISP>SECURITY.\;10); Copyright (c) 1985, 1987 by Xerox Corporation.  All rights reserved.(PRETTYCOMPRINT SECURITYCOMS)(RPAQQ SECURITYCOMS ((P (SETQ |\\SmashAtom.NameCount| 0))                     (FNS |\\MachineID| |\\SmashAtom| |\\UnSmashAtom|)                     (FNS |\\SmashAtom.old| |\\UnSmashAtom.old|)                     (PROP FILETYPE SECURITY)))(SETQ |\\SmashAtom.NameCount| 0)(DEFINEQ(|\\MachineID|  (LAMBDA NIL                                                (* |hdj| "21-Nov-85 15:58")    (LIST (|fetch| (IFPAGE |NSHost0|) |of| |\\InterfacePage|)          (|fetch| (IFPAGE |NSHost1|) |of| |\\InterfacePage|)          (|fetch| (IFPAGE |NSHost2|) |of| |\\InterfacePage|))))(|\\SmashAtom|  (LAMBDA (SYMBOL DESTPKG)                                   (* \; "Edited  6-Oct-87 17:01 by FS")                    (* |;;| " Return atom number.  Remove the symbol from current pkg (to prevent conflict) and intern into the XQP package.")    (DECLARE (GLOBALVARS |\\SmashAtom.NameCount|))    (|if| (NOT (LITATOM SYMBOL))        |then| (\\ILLEGAL.ARG SYMBOL)      |else| (LET (BASE FATPNAME? LENGTH NEWNAME NEWLENGTH)                  (|if| (NULL DESTPKG)                      |then| (SETQ DESTPKG (CL:FIND-PACKAGE "XQP")))                  (SETQ BASE (|fetch| (LITATOM PNAMEBASE) |of| SYMBOL))                  (SETQ LENGTH (|fetch| (LITATOM PNAMELENGTH) |of| SYMBOL))                  (SETQ FATPNAME? (|fetch| (LITATOM FATPNAMEP) |of| SYMBOL))                  (SETQ NEWNAME (CL:FORMAT NIL "\\~D" |\\SmashAtom.NameCount|))                  (IF (CL:FIND-SYMBOL NEWNAME DESTPKG)                      THEN (ERROR "SYMBOL WITH NAME ALREADY EXISTS IN DESTPKG"))                  (SETQ NEWLENGTH (NCHARS NEWNAME))                  (SETQ |\\SmashAtom.NameCount| (ADD1 |\\SmashAtom.NameCount|))                  (|if| (< LENGTH NEWLENGTH)                      |then| (ERROR "NEWNAME TOO LONG" SYMBOL)                    |else| (LET NIL                     (* |;;| "Remove from owning package.  What about other places it is accessible?")                                (CL:UNINTERN SYMBOL (CL:SYMBOL-PACKAGE SYMBOL))                                (|for| POS |from| 1 |to| NEWLENGTH                                   |do| (\\PUTBASECHAR FATPNAME? BASE POS (NTHCHARCODE NEWNAME POS)))                    (* |;;| "Pad out with spaces if necessary")                                (|for| POS |from| (ADD1 NEWLENGTH) |to| LENGTH                                   |do| (\\PUTBASECHAR FATPNAME? BASE POS (CHARCODE " ")))                    (* |;;| "Shorten atom name")                                (|replace| (LITATOM PNAMELENGTH) |of| SYMBOL |with| NEWLENGTH)                                (IMPORT SYMBOL DESTPKG)))                    (* |;;| "Return atom number")                  (\\LOLOC SYMBOL)))))(|\\UnSmashAtom|  (LAMBDA (SYMBOLNUMBER STRING DESTPKG)                      (* \; "Edited 15-Oct-87 13:56 by FS")                    (* |;;| "No attempt made to guarantee STRING is sufficiently short.")    (LET (SYMBOL BASE FATPNAME? PNAMELENGTH)         (IF (CL:FIND-SYMBOL STRING DESTPKG)             THEN (ERROR "SYMBOL WITH NAME ALREADY EXISTS IN DESTPKG"))         (SETQ SYMBOL (\\VAG2 0 SYMBOLNUMBER))         (SETQ BASE (|fetch| (LITATOM PNAMEBASE) |of| SYMBOL))         (SETQ FATPNAME? (|fetch| (LITATOM FATPNAMEP) |of| SYMBOL))         (SETQ PNAMELENGTH (NCHARS STRING))         (|for| X |from| 1 |to| PNAMELENGTH |do| (\\PUTBASECHAR FATPNAME? BASE X                                                        (CHCON1 (SUBSTRING STRING X X))))         (|replace| (LITATOM PNAMELENGTH) |of| SYMBOL |with| PNAMELENGTH)                    (* |;;| "Remove from owning package.  What about other places it is accessible?")         (CL:UNINTERN SYMBOL (CL:SYMBOL-PACKAGE SYMBOL))         (IMPORT SYMBOL DESTPKG)))))(DEFINEQ(|\\SmashAtom.old|  (LAMBDA (|Atom|)                                           (* \; "Edited 28-Sep-87 18:59 by FS")                                                             (* |if| (NOT (LITATOM |Atom|)) |then|                                                             (\\ILLEGAL.ARG |Atom|) |else|                                                             (LET ((BASE (|fetch|                                                             (LITATOM PNAMEBASE) |of| |Atom|))                                                             (FATPNAME? (|fetch| (LITATOM FATPNAMEP)                                                              |of| |Atom|)) (PNAMELENGTH                                                             (|fetch| (LITATOM PNAMELENGTH) |of|                                                              |Atom|))) (PROG1 (LIST                                                             (\\LOLOC |Atom|) (\\GETBASESTRING BASE                                                             (COND (FATPNAME? 2) (T 1)) PNAMELENGTH                                                              FATPNAME?)) (|for| X |from| 1 |to|                                                              PNAMELENGTH |do| (\\PUTBASECHAR                                                              FATPNAME? BASE X (CHARCODE X))))))    NIL))(|\\UnSmashAtom.old|  (LAMBDA (|AtomNum| |String|)                               (* \; "Edited 28-Sep-87 19:00 by FS")                                                             (* LET* ((|AtomToFix|                                                             (\\VAG2 0 |AtomNum|))                                                             (BASE (|fetch| (LITATOM PNAMEBASE)                                                              |of| |AtomToFix|)) (FATPNAME?                                                             (|fetch| (LITATOM FATPNAMEP) |of|                                                              |AtomToFix|)) (PNAMELENGTH                                                             (|fetch| (LITATOM PNAMELENGTH) |of|                                                              |AtomToFix|))) (|for| X |from| 1 |to|                                                              PNAMELENGTH |do| (\\PUTBASECHAR                                                              FATPNAME? BASE X (CHCON1                                                             (SUBSTRING |String| X X))))                                                              |AtomToFix|)    NIL)))(PUTPROPS SECURITY FILETYPE :COMPILE-FILE)(PUTPROPS SECURITY COPYRIGHT ("Xerox Corporation" 1985 1987))(DECLARE\: DONTCOPY  (FILEMAP (NIL (632 4375 (|\\MachineID| 642 . 970) (|\\SmashAtom| 972 . 3266) (|\\UnSmashAtom| 3268 . 4373)) (4376 7077 (|\\SmashAtom.old| 4386 . 5804) (|\\UnSmashAtom.old| 5806 . 7075)))))STOP