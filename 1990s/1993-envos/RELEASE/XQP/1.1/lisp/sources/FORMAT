(DEFINE-FILE-INFO PACKAGE "INTERLISP" READTABLE "XCL" BASE 10)(FILECREATED "25-Jun-87 16:54:02" {ERIS}<PROLOGCORE>LYRIC>LISP>FORMAT.\;5 7082         |previous| |date:| "25-Jun-87 09:43:24" {ERIS}<PROLOGCORE>LYRIC>LISP>FORMAT.\;4); Copyright (c) 1987 by Quintus Computer Systems, Inc.  All rights reserved.(PRETTYCOMPRINT FORMATCOMS)(RPAQQ FORMATCOMS ((* |;;;| "This file was generated from {ERIS}<PROLOGCORE>LISPNEW>FORMAT.LSP;1, loaded 16-Jun-87 18:32:47")                                       (* |;;| "@(#)FORMAT.LSP	1.3                             11/17/85 FORMAT.LSP BAK		 ; --------------------------------------------------------; ; WARNING: This material is CONFIDENTIAL and proprietary ; to Quintus Computer Systems Inc.		 ; ; ; Copyright (C) 1985,  Quintus Computer Systems, Inc.   ; All rights reserved.					 ; ; --------------------------------------------------------; ;")                                       (* |;;| "---------------------------------------------------------------------- The ILisp PRINTNUM routine takes a *LIST* of format arguments rather than just taking format arguments. This is unfortunate because it requires CONSing a list every time a number is printed! Instead, we are employing the tried-and-true technique of using one such list that we RPLACA with the necessary arguments. ----------------------------------------------------------------------")                   (VARIABLES XQP::FLOAT.FORMAT.SPEC)                   (FUNCTIONS XQP::INIT.FLOAT.FORMAT.SPEC XQP::SET.DEC.PART XQP::SET.EXP.PART)                                       (* |;;| "----------------------------------------------------------------------")                   (FUNCTIONS XQP::FLOAT.FORMAT.PRINT XQP::CPRINT XQP::QP.LEN)                   (P (XQP::INIT.FLOAT.FORMAT.SPEC))                   (PROP MAKEFILE-ENVIRONMENT)))(* |;;;| "This file was generated from {ERIS}<PROLOGCORE>LISPNEW>FORMAT.LSP;1, loaded 16-Jun-87 18:32:47")(* |;;| "@(#)FORMAT.LSP	1.3                             11/17/85 FORMAT.LSP BAK		 ; --------------------------------------------------------; ; WARNING: This material is CONFIDENTIAL and proprietary ; to Quintus Computer Systems Inc.		 ; ; ; Copyright (C) 1985,  Quintus Computer Systems, Inc.   ; All rights reserved.					 ; ; --------------------------------------------------------; ;")(* |;;| "---------------------------------------------------------------------- The ILisp PRINTNUM routine takes a *LIST* of format arguments rather than just taking format arguments. This is unfortunate because it requires CONSing a list every time a number is printed! Instead, we are employing the tried-and-true technique of using one such list that we RPLACA with the necessary arguments. ----------------------------------------------------------------------")(XQP::|def.global| XQP::FLOAT.FORMAT.SPEC )(XQP::DEFUNC XQP::INIT.FLOAT.FORMAT.SPEC NIL (SETQ XQP::FLOAT.FORMAT.SPEC                                              (LIST 'FLOAT NIL 5 4 NIL NIL)))(XQP::DEFMACROC XQP::SET.DEC.PART (VALUE) `(RPLACA (NTH XQP::FLOAT.FORMAT.SPEC 3)                                                  ,VALUE))(XQP::DEFMACROC XQP::SET.EXP.PART (VALUE) `(RPLACA (NTH XQP::FLOAT.FORMAT.SPEC 4)                                                  ,VALUE))(* |;;| "----------------------------------------------------------------------")(XQP::DEFUNC XQP::FLOAT.FORMAT.PRINT (FLOAT TYPE XQP::PRECISION STREAM)   (LET ((XQP::USE.EXPONENTIAL.FORMAT NIL))        (COND           ((OR (EQ TYPE (CHARCODE E))                (EQ TYPE (CHARCODE \e)))            (SETQ XQP::USE.EXPONENTIAL.FORMAT T))           ((AND (OR (EQ TYPE (CHARCODE G))                     (EQ TYPE (CHARCODE \g)))                 (OR (GREATERP FLOAT 100000.0)                     (LESSP FLOAT 1.0E-5)))                  (* \; "If the float is between these two numbers, then it is short enough to be printed in a non-exponential manner.")            (SETQ XQP::USE.EXPONENTIAL.FORMAT T)))        (LET ((XQP::EXPPART (COND                               (XQP::USE.EXPONENTIAL.FORMAT 4)                               (T NIL)))              (XQP::DECPART XQP::PRECISION))             (XQP::SET.DEC.PART XQP::DECPART)             (XQP::SET.EXP.PART XQP::EXPPART)             (PRINTNUM XQP::FLOAT.FORMAT.SPEC FLOAT STREAM))))(XQP::DEFUNC XQP::CPRINT (FLOAT TYPE XQP::PRECISION) (LET* ((STREAM (XQP::QIO.STREAM                                                                            XQP::CURRENT.OUTPUT))                                                            (XQP::START.POSIT (POSITION STREAM)))                                                           (XQP::FLOAT.FORMAT.PRINT FLOAT TYPE                                                                   XQP::PRECISION STREAM)                                                           (LET ((XQP::NUMCHARS (IDIFFERENCE                                                                                 (POSITION STREAM)                                                                                 XQP::START.POSIT)))                                                                (XQP::INCF (XQP::QIO.CHARPOS                                                                                   XQP::CURRENT.OUTPUT                                                                                  )                                                                       XQP::NUMCHARS)                                                                (XQP::INCF (XQP::QIO.LINEPOS                                                                                   XQP::CURRENT.OUTPUT                                                                                  )                                                                       XQP::NUMCHARS))))(XQP::DEFUNC XQP::QP.LEN (FLOAT TYPE XQP::PRECISION) (LET* ((STREAM (OPENFILE '                                                                           XQP::{CORE}QUINTUS.SCR1\;1                                                                           'OUTPUT))                                                            (XQP::START.POSIT (POSITION STREAM)))                                                           (XQP::FLOAT.FORMAT.PRINT FLOAT TYPE                                                                   XQP::PRECISION STREAM)                                                           (LET ((RESULT (IDIFFERENCE (POSITION                                                                                       STREAM)                                                                                XQP::START.POSIT)))                                                                (CLOSEF STREAM)                                                                RESULT)))(XQP::INIT.FLOAT.FORMAT.SPEC)(PUTPROPS FORMAT COPYRIGHT ("Quintus Computer Systems, Inc" 1987))(DECLARE\: DONTCOPY  (FILEMAP (NIL)))STOP