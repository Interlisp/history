(DEFINE-FILE-INFO §READTABLE "INTERLISP" §PACKAGE "INTERLISP")(FILECREATED "23-Oct-86 18:09:17" {DSK}<LISPFILES>TEX2TEDIT.;26 57014        changes to%:  (FUNCTIONS DO.BACKSLASH CK.EOL)      previous date%: "21-Oct-86 15:34:07" {DSK}<LISPFILES>TEX2TEDIT.;24)(* "Copyright (c) 1986 by Xerox Corporation.  All rights reserved.")(PRETTYCOMPRINT TEX2TEDITCOMS)(RPAQQ TEX2TEDITCOMS        ((FUNCTIONS CK.EOL DO.1UPARROW DO.2UPARROW DO.CHAPTER DO.CONVERSION DO.DEFAULTPARA DO.DEFUN                DO.DF DO.DOLLAR DO.FIRSTPARA DO.ITALIC DO.MDASH DO.MNDASH DO.PAGELAYOUT DO.TAB                DO.UPARROW DO.LABEL DO.LIST DO.LEVEL1HEAD DO.LEVEL2HEAD DO.LEVEL3HEAD DO.SCREEN                DO.SECTION DO.SEMICOLON DO.SUBSECTION DO.BACKSLASH DO.BEGINCOM DO.BOLDFACE                DO.BOLDITALIC DO.BULLET DO.LCURLY DO.RCURLY DO.RUNNINGHEADS DO.EXCLAIM DO.OUTPUT                TEX2TEDIT)        (VARIABLES *INDENT-FLG* *ISTREAM* *NEW-FACE* *NEW-FONT* *OSTREAM* *R-CURLY-FLG*                *CURRENT-FONT-FACE* *CURRENT-FONT* *CURRENT-LINE* *CURRENT-LINE-INDEX* *GROUP-LIST*                *TEXTOBJ* *TEX2TEDIT-WINDOW* *SCREEN-FONT-FLG* *SEL* *CHNUM* *CHLIM*)))(CL:DEFUN CK.EOL NIL (CL:IF (>= *CURRENT-LINE-INDEX* (CL:LENGTH *CURRENT-LINE*))                            (SETQ *CURRENT-LINE* (CL:CONCATENATE 'STRING *CURRENT-LINE* " "                                                        (CL:READ-LINE *ISTREAM*)))))(CL:DEFUN DO.1UPARROW NIL (LET ((IMOBJ (IM.INDEX.CREATEOBJ)                                       INAME))                               (CL:DO NIL ((CL:POSITION #\} (CL:SUBSEQ *CURRENT-LINE*                                                                    *CURRENT-LINE-INDEX*)))                                      (SETQ *CURRENT-LINE* (CL:CONCATENATE 'STRING *CURRENT-LINE* " "                                                                  (CL:READ-LINE *ISTREAM*))))                               (SETQ IMNAME (CL:SUBSEQ *CURRENT-LINE* (+ *CURRENT-LINE-INDEX* 2)                                                   (+ *CURRENT-LINE-INDEX* (CL:POSITION #\}                                                                                  (CL:SUBSEQ                                                                                        *CURRENT-LINE*                                                                                  *CURRENT-LINE-INDEX*                                                                                         )))))                               (REPLACE NAME OF (FETCH OBJECTDATUM OF IMOBJ) WITH IMNAME)                               (TEDIT.INSERT.OBJECT IMOBJ *OSTREAM*)))(CL:DEFUN DO.2UPARROW NIL (LET (ARROW-NUM-FLG IMOBJ IMNAME LINE INDEX)                               (add *CURRENT-LINE-INDEX* 3)                               (SETQ ARROW-NUM-FLG (CL:DIGIT-CHAR-P (CHAR *CURRENT-LINE* (CL:1-                                                                                                                                                                           *CURRENT-LINE-INDEX*                                                                                          ))))                               (CL:IF ARROW-NUM-FLG (add *CURRENT-LINE-INDEX* 1)                                      (SETQ ARROW-NUM-FLG 1))                               (CL:DO ((N ARROW-NUM-FLG (CL:1- N))                                       (NX 0))                                      ((ZEROP N))                                      (PROGN (SETQ IMOBJ (IM.INDEX.CREATEOBJ))                                             (CL:DO NIL ((CL:POSITION #\} (CL:SUBSEQ *CURRENT-LINE*                                                                                  *CURRENT-LINE-INDEX*                                                                                 )))                                                    (SETQ *CURRENT-LINE* (CL:CONCATENATE 'STRING                                                                                 *CURRENT-LINE* " "                                                                                (CL:READ-LINE                                                                                        *ISTREAM*))))                                             (SETQ IMNAME (CL:SUBSEQ *CURRENT-LINE*                                                                  *CURRENT-LINE-INDEX*                                                                 (SETQ NX                                                                  (+ *CURRENT-LINE-INDEX*                                                                     (CL:POSITION #\}                                                                            (CL:SUBSEQ *CURRENT-LINE*                                                                                  *CURRENT-LINE-INDEX*                                                                                   ))))))                                             (replace NAME of (fetch OBJECTDATUM of IMOBJ)                                                with IMNAME)                                             (TEDIT.INSERT.OBJECT IMOBJ *OSTREAM*)                                             (SETQ *CURRENT-LINE-INDEX* (+ NX 2))))                               (SETQ *CURRENT-LINE-INDEX* (- *CURRENT-LINE-INDEX* 2))                               (TEDIT.INSERT *OSTREAM* " ")))(CL:DEFUN DO.CHAPTER NIL (LET (CHAPTER-NUM CHAPTER-NAME POS)                              (SETQ *CURRENT-LINE* (CL:READ-LINE *ISTREAM*))                              (SETQ CHAPTER-NUM (CL:SUBSEQ *CURRENT-LINE* 0 (SETQ POS                                                                             (CL:POSITION #\{                                                                                     *CURRENT-LINE*)))                               )                              (SETQ CHAPTER-NAME (CL:SUBSEQ *CURRENT-LINE* (CL:1+ POS)                                                        (CL:POSITION #\} *CURRENT-LINE*)))                              (TERPRI *OSTREAM*)                              (TERPRI *OSTREAM*)                              (SETQ *SEL* (FETCH SEL OF *TEXTOBJ*))                              (REPLACE CH# OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                              (FORMAT *OSTREAM* "Chapter ~A                ~A ~%%" CHAPTER-NUM                                      CHAPTER-NAME)                              (REPLACE CHLIM OF *SEL* WITH (FETCH TEXTLEN OF *TEXTOBJ*))                              (REPLACE DCH OF *SEL* WITH (CL:1+ (- (FETCH CHLIM OF *SEL*)                                                                   (FETCH CH# OF *SEL*))))                              (REPLACE HASCARET OF *SEL* WITH NIL)                              (REPLACE POINT OF *SEL* WITH 'LEFT)                              (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                              (DO.LEVEL1HEAD *OSTREAM* *TEXTOBJ* *SEL*)                              (REPLACE CH# OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                              (REPLACE CHLIM OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                              (REPLACE DCH OF *SEL* WITH 0)                              (REPLACE POINT OF *SEL* WITH 'RIGHT)                              (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                              (DO.RUNNINGHEADS *OSTREAM* *TEXTOBJ* *SEL*)                              (REPLACE CH# OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                              (REPLACE CHLIM OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                              (REPLACE DCH OF *SEL* WITH 0)                              (REPLACE POINT OF *SEL* WITH 'RIGHT)                              (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                              (DO.DEFAULTPARA *OSTREAM* *TEXTOBJ* *SEL*)                              (SETQ *CURRENT-LINE-INDEX* 20000)))(CL:DEFUN DO.CONVERSION NIL (CL:DO (CR-FLG)                                   ((EOFP *ISTREAM*))                                   (SETQ *CURRENT-LINE* (CL:READ-LINE *ISTREAM*))                                   (CL:DO NIL ((> (CL:LENGTH *CURRENT-LINE*)                                                  1)                                               (SETQ CR-FLG NIL))                                          (PROGN (CL:IF (NOT CR-FLG)                                                        (PROGN (TEDIT.INSERT *OSTREAM* "")                                                               (DO.DEFAULTPARA *OSTREAM* *TEXTOBJ*                                                                       *SEL*)                                                               (SETQ CR-FLG T)))                                                 (SETQ *CURRENT-LINE* (CL:READ-LINE *ISTREAM*))))                                   (SETQ *CURRENT-LINE-INDEX* 0)                                   (CL:IF (CL:/= (CL:LENGTH *CURRENT-LINE*)                                                 0)                                          (PROGN (CASE (CHAR *CURRENT-LINE* 0)                                                       (#\\ (DO.BACKSLASH))                                                       (#\! (DO.EXCLAIM))                                                       (#\; (DO.SEMICOLON))                                                       (#\{ (DO.LCURLY))                                                       (#\} (DO.RCURLY))                                                       (#\^ (DO.UPARROW))                                                       (#\$ (DO.DOLLAR))                                                       (#\& (DO.TAB))                                                       (T (DO.OUTPUT)))                                                 (CL:DO NIL ((>= *CURRENT-LINE-INDEX*                                                                 (CL:1- (CL:LENGTH *CURRENT-LINE*))))                                                        (SETQ *CURRENT-LINE-INDEX* (CL:1+                                                                                  *CURRENT-LINE-INDEX*                                                                                          ))                                                        (CASE (CHAR *CURRENT-LINE*                                                                     *CURRENT-LINE-INDEX*)                                                              (#\\ (DO.BACKSLASH))                                                              (#\{ (DO.LCURLY))                                                              (#\} (DO.RCURLY))                                                              (#\^ (DO.UPARROW))                                                              (#\$ (DO.DOLLAR))                                                              (#\& (DO.TAB))                                                              (T (DO.OUTPUT))))                                                 (CL:IF *SCREEN-FONT-FLG* (TEDIT.INSERT *OSTREAM* "")                                                        (TEDIT.INSERT *OSTREAM* " "))))))(CL:DEFUN DO.DEFAULTPARA (TEXTSTREAM TEXTOBJ SEL)            (* jds "20-Nov-85 15:23")                    (* Impose the style for a level-2 head in the lisp-library doc%: 14pt bold           Modern Upper/lower head, flush left under a 2pt rule, over a 1/2pt rule.          57pt base-to-base leading on the 2pt rule, snug the rest together.)                                                             (* XPS.COVER.PARA TEXTOBJ SEL)                                                             (* Make sure the whole paragraph is                                                              selected.)   (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))           (CH# (fetch CH# of SEL))           (CHLIM (fetch CHLIM of SEL)))          (TEDIT.PARALOOKS TEXTOBJ                 '(QUAD JUSTIFIED PARALEADING 7 LINELEADING 0 1STLEFTMARGIN 204 LEFTMARGIN 204                         RIGHTMARGIN 504 HEADINGKEEP OFF BASETOBASE NIL PAGEHEADING NIL TABS                        (28 (232 . LEFT))) CH# (fetch DCH of SEL))          (TEDIT.LOOKS TEXTOBJ '(FAMILY MODERN SIZE 10))))(CL:DEFUN DO.DEFUN NIL                                       (* Output one char to the textstream)                       (TEDIT.INSERT *OSTREAM* (SUBSTRING *CURRENT-LINE* (+ *CURRENT-LINE-INDEX* 6)))                       (SETQ *CURRENT-LINE-INDEX* 20000))(CL:DEFUN DO.DF NIL (SETQ *NEW-FACE* T)                    (SETQ *NEW-FONT* T)                    (TEDIT.LOOKS *OSTREAM* '(FAMILY CLASSIC SIZE 10 WEIGHT BOLD SLOPE REGULAR))                    (add *CURRENT-LINE-INDEX* 2)                    (CK.EOL))(CL:DEFUN DO.DOLLAR NIL (CASE (CHAR *CURRENT-LINE* (CL:1+ *CURRENT-LINE-INDEX*))                              (#\Space NIL)                              (T (DO.OUTPUT))))(CL:DEFUN DO.FIRSTPARA (TEXTSTREAM TEXTOBJ SEL)              (* jds "20-Nov-85 15:24")                    (* Impose the style for a level-2 head in the lisp-library doc%: 14pt bold           Modern Upper/lower head, flush left under a 2pt rule, over a 1/2pt rule.          57pt base-to-base leading on the 2pt rule, snug the rest together.)                                                             (* XPS.COVER.PARA TEXTOBJ SEL)                                                             (* Make sure the whole paragraph is                                                              selected.)   (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))           (CH# (fetch CH# of SEL))           (CHLIM (fetch CHLIM of SEL)))          (TEDIT.LOOKS TEXTOBJ '(FAMILY MODERN SIZE 10))          (TEDIT.PARALOOKS TEXTOBJ                 '(QUAD JUSTIFIED PARALEADING 11 LINELEADING 0 1STLEFTMARGIN 204 LEFTMARGIN 204                         RIGHTMARGIN 504 HEADINGKEEP OFF BASETOBASE NIL PAGEHEADING NIL) CH#                 (fetch DCH of SEL))))(CL:DEFUN DO.ITALIC NIL (SETQ *NEW-FACE* T)                        (TEDIT.LOOKS *OSTREAM* '(FACE MIR))                        (add *CURRENT-LINE-INDEX* 2)                        (CK.EOL))(CL:DEFUN DO.MDASH NIL (TEDIT.INSERT *OSTREAM* "")                       (TEDIT.PARALOOKS *TEXTOBJ*                              '(QUAD JUSTIFIED PARALEADING 7 LINELEADING 0 1STLEFTMARGIN 204                                      LEFTMARGIN 232 RIGHTMARGIN 504 HEADINGKEEP OFF BASETOBASE NIL                                      PAGEHEADING NIL TABS (28 (232 . LEFT))) *SEL*)                       (TEDIT.LOOKS *OSTREAM* '(FONT MODERN 14 MRR))                       (TEDIT.INSERT *OSTREAM* 61221)                       (TEDIT.INSERT *OSTREAM* (CHARCODE TAB))                       (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT*)                       (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT-FACE*)                       (ADD *CURRENT-LINE-INDEX* 12))(CL:DEFUN DO.MNDASH NIL (TEDIT.INSERT *OSTREAM* "")                        (TEDIT.PARALOOKS *TEXTOBJ*                               '(QUAD JUSTIFIED PARALEADING 7 LINELEADING 0 1STLEFTMARGIN 232                                       LEFTMARGIN 260 RIGHTMARGIN 504 HEADINGKEEP OFF BASETOBASE NIL                                       PAGEHEADING NIL TABS (28 (260 . LEFT))) *SEL*)                        (TEDIT.LOOKS *OSTREAM* '(FONT MODERN 14 MRR))                        (TEDIT.INSERT *OSTREAM* 61221)                        (TEDIT.INSERT *OSTREAM* 61220)                        (TEDIT.INSERT *OSTREAM* (CHARCODE TAB))                        (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT*)                        (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT-FACE*)                        (ADD *CURRENT-LINE-INDEX* 17))(CL:DEFUN DO.PAGELAYOUT (TEXTSTREAM TEXTOBJ SEL) (PROG ((PAGENUM.FONT (FONTCREATE 'MODERN 10                                                                             'MRR 0 'DISPLAY))                                                        PAGENUM)                                                       (SETQ PAGENUM "1")                                                       (TEDIT.PAGEFORMAT                                                        TEXTSTREAM                                                        (LIST (TEDIT.SINGLE.PAGEFORMAT                                                               T 46.5 1.25 PAGENUM.FONT 'RIGHT 4.5                                                                4.5 1.25 4.5 1 42.0 NIL                                                               '((FOOTINGR 4.5 2.25))                                                               'PICAS                                                               (LIST 'STARTINGPAGE# (COND                                                                                       ((NUMBERP                                                                                         PAGENUM)                                                                                        PAGENUM)                                                                                       (T 1))))                                                              (TEDIT.SINGLE.PAGEFORMAT                                                               T 4.5 1.25 PAGENUM.FONT 'LEFT 4.5 4.5                                                                4.5 4.5 1 42.0 NIL                                                               '((FOOTINGV 4.5 2.25)                                                                 (VERSOHEAD 4.5 63.5))                                                               'PICAS)                                                              (TEDIT.SINGLE.PAGEFORMAT                                                               T 46.5 1.25 PAGENUM.FONT 'RIGHT 4.5                                                                4.5 4.5 4.5 1 42.0 NIL                                                               '((FOOTINGR 4.5 2.25)                                                                 (RECTOHEAD 4.5 63.5))                                                               'PICAS)))))(CL:DEFUN DO.TAB NIL (TEDIT.INSERT *OSTREAM* (CL:CHAR-CODE #\Tab)))(CL:DEFUN DO.UPARROW NIL (CASE (CHAR *CURRENT-LINE* (CL:1+ *CURRENT-LINE-INDEX*))                               (#\^ (DO.2UPARROW))                               (#\{ (DO.1UPARROW))                               (T (DO.OUTPUT)))                         (REPLACE CH# OF *SEL* WITH (FETCH TEXTLEN OF *TEXTOBJ*))                         (REPLACE CHLIM OF *SEL* WITH (FETCH TEXTLEN OF *TEXTOBJ*))                         (REPLACE DCH OF *SEL* WITH 0)                         (REPLACE POINT OF *SEL* WITH 'LEFT)                         (\FIXSEL *SEL* *TEXTOBJ*))(CL:DEFUN DO.LABEL NIL (LET (LABEL (POS (add *CURRENT-LINE-INDEX* 6)))                            (SETQ LABEL (SUBSTRING *CURRENT-LINE* (CL:1+ POS)                                               (CL:LENGTH *CURRENT-LINE*)))                            (TEDIT.INSERT *OSTREAM* "")                            (TEDIT.PARALOOKS *TEXTOBJ*                                   '(QUAD JUSTIFIED PARALEADING 7 LINELEADING 0 1STLEFTMARGIN 100                                           LEFTMARGIN 204 RIGHTMARGIN 504 HEADINGKEEP OFF BASETOBASE                                           NIL PAGEHEADING NIL TABS (28 (204 . LEFT))) *SEL*)                            (TEDIT.LOOKS *OSTREAM* '(FACE BRR))                            (TEDIT.INSERT *OSTREAM* LABEL)                            (TEDIT.LOOKS *OSTREAM* '(FACE MRR))                            (TEDIT.INSERT *OSTREAM* (CHARCODE TAB))                            (SETQ *CURRENT-LINE-INDEX* 20000)))(CL:DEFUN DO.LIST NIL (SETQ *CURRENT-LINE-INDEX* 20000))(CL:DEFUN DO.LEVEL1HEAD (TEXTSTREAM TEXTOBJ SEL)             (* AJB "16-Sep-86 10:25")                    (* * Impose the styling for a Level-1 heading in the lisp-library           documentation%: 18-point Modern bold, all-upper-case, set flush right over a           6pt rule.)                                                             (* XPS.COVER.PARA TEXTOBJ SEL)                                                             (* Make sure the whole paragraph is                                                              selected.)   (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))           (CH# (fetch CH# of SEL))           (CHLIM (fetch CHLIM of SEL)))          (\TEDIT.UCASE.SEL TEXTSTREAM TEXTOBJ SEL)          (* Make the heading be Helvetica 14                                                              bold)          (TEDIT.LOOKS TEXTSTREAM '(FAMILY MODERN SIZE 18 WEIGHT BOLD SLOPE REGULAR) SEL)          (TEDIT.PARALOOKS TEXTOBJ                 '(QUAD RIGHT PARALEADING 0 LINELEADING 0 1STLEFTMARGIN 204 LEFTMARGIN 204                         RIGHTMARGIN 504 HEADINGKEEP ON BASETOBASE NIL) CH# 1)          (TEDIT.INSERT.OBJECT (HRULE.CREATE 6)                 TEXTSTREAM                 (SUB1 CHLIM))          (TEDIT.INSERT TEXTSTREAM (CHARCODE CR)                 (SUB1 CHLIM))          (TEDIT.PARALOOKS TEXTOBJ                 '(QUAD LEFT 1STLEFTMARGIN 204 LEFTMARGIN 204 RIGHTMARGIN 504 HEADINGKEEP ON                         PARALEADING 0 BASETOBASE NIL LINELEADING 0) CHLIM 1)))(CL:DEFUN DO.LEVEL2HEAD (TEXTSTREAM TEXTOBJ SEL)             (* jds "20-Nov-85 15:22")                    (* Impose the style for a level-2 head in the lisp-library doc%: 14pt bold           Modern Upper/lower head, flush left under a 2pt rule, over a 1/2pt rule.          57pt base-to-base leading on the 2pt rule, snug the rest together.)                                                             (* XPS.COVER.PARA TEXTOBJ SEL)                                                             (* Make sure the whole paragraph is                                                              selected.)   (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))           (CH# (fetch CH# of SEL))           (CHLIM (fetch CHLIM of SEL)))          (TEDIT.LOOKS TEXTSTREAM '(FAMILY MODERN SIZE 14 WEIGHT BOLD SLOPE REGULAR) SEL)                                                             (* Make the heading be Helvetica 14                                                              bold)          (TEDIT.PARALOOKS TEXTOBJ                 '(QUAD LEFT PARALEADING 0 1STLEFTMARGIN 0 LEFTMARGIN 0 RIGHTMARGIN 504 HEADINGKEEP                         ON BASETOBASE NIL LINELEADING 0) CH# 1)          (TEDIT.INSERT.OBJECT (HRULE.CREATE 1)                 TEXTSTREAM                 (SUB1 CHLIM))          (TEDIT.INSERT TEXTSTREAM (CHARCODE CR)                 (SUB1 CHLIM))          (TEDIT.PARALOOKS TEXTOBJ                 '(QUAD LEFT 1STLEFTMARGIN 0 LEFTMARGIN 0 RIGHTMARGIN 504 HEADINGKEEP ON PARALEADING                         0 LINELEADING 0) CHLIM 1)          (TEDIT.INSERT.OBJECT (HRULE.CREATE 2)                 TEXTSTREAM CH#)          (TEDIT.INSERT TEXTSTREAM (CHARCODE CR)                 (ADD1 CH#))          (TEDIT.PARALOOKS TEXTOBJ                 '(QUAD LEFT 1STLEFTMARGIN 0 LEFTMARGIN 0 RIGHTMARGIN 504 PARALEADING 50 HEADINGKEEP                         ON LINELEADING 0) CH# 1)))(CL:DEFUN DO.LEVEL3HEAD (TEXTSTREAM TEXTOBJ SEL)             (* jds "20-Nov-85 15:22")                    (* Impose the style for a level-2 head in the lisp-library doc%: 14pt bold           Modern Upper/lower head, flush left under a 2pt rule, over a 1/2pt rule.          57pt base-to-base leading on the 2pt rule, snug the rest together.)                                                             (* XPS.COVER.PARA TEXTOBJ SEL)                                                             (* Make sure the whole paragraph is                                                              selected.)   (PROG* ((TEXTOBJ (TEXTOBJ TEXTSTREAM))           (CH# (fetch CH# of SEL))           (CHLIM (fetch CHLIM of SEL)))          (TEDIT.LOOKS TEXTSTREAM '(FAMILY MODERN SIZE 12 WEIGHT BOLD SLOPE REGULAR) SEL)                                                             (* Make the heading be Helvetica 12                                                              bold)          (TEDIT.PARALOOKS TEXTOBJ                 '(QUAD LEFT PARALEADING 14 LINELEADING 0 1STLEFTMARGIN 0 LEFTMARGIN 0 RIGHTMARGIN                         504 HEADINGKEEP ON BASETOBASE NIL) CH# 1)          (TEDIT.INSERT.OBJECT (HRULE.CREATE 1)                 TEXTSTREAM                 (SUB1 CHLIM))          (TEDIT.INSERT TEXTSTREAM (CHARCODE CR)                 (SUB1 CHLIM))          (TEDIT.PARALOOKS TEXTOBJ                 '(QUAD LEFT 1STLEFTMARGIN 0 LEFTMARGIN 0 RIGHTMARGIN 504 HEADINGKEEP ON PARALEADING                         0 BASETOBASE NIL LINELEADING 0) CHLIM 1)))(CL:DEFUN DO.SCREEN NIL                                      (* reset the font/face TO A SCREEN                                                              FONT)                        (TEDIT.INSERT *OSTREAM* "")                        (TEDIT.LOOKS *TEXTOBJ* '(FAMILY TERMINAL SIZE 10 WEIGHT BOLD)                               (fetch TEXTLEN of *TEXTOBJ*)                               1)                        (SETQ *SCREEN-FONT-FLG* T)                        (SETQ *CURRENT-LINE-INDEX* 20000)                        (TEDIT.PARALOOKS *TEXTOBJ*                               '(QUAD JUSTIFIED PARALEADING 7 LINELEADING 0 1STLEFTMARGIN 204                                       LEFTMARGIN 204 RIGHTMARGIN 504 HEADINGKEEP OFF BASETOBASE NIL                                       PAGEHEADING NIL TABS (28 (232 . LEFT)))))(CL:DEFUN DO.SECTION NIL (LET (SECTION-NAME POS)                              (SETQ POS (CL:POSITION #\{ *CURRENT-LINE*))                              (SETQ SECTION-NAME (CL:SUBSEQ *CURRENT-LINE* (CL:1+ POS)                                                        (CL:POSITION #\} *CURRENT-LINE*)))                              (TEDIT.INSERT *OSTREAM* "")                              (SETQ *SEL* (FETCH SEL OF *TEXTOBJ*))                              (REPLACE CH# OF *SEL* WITH (FETCH TEXTLEN OF *TEXTOBJ*))                              (REPLACE CHLIM OF *SEL* WITH (FETCH TEXTLEN OF *TEXTOBJ*))                              (REPLACE DCH OF *SEL* WITH 0)                              (REPLACE POINT OF *SEL* WITH 'RIGHT)                              (REPLACE HASCARET OF *SEL* WITH NIL)                              (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                              (REPLACE CH# OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                              (FORMAT *OSTREAM* " ~A ~%%" SECTION-NAME)                              (REPLACE CHLIM OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                              (REPLACE DCH OF *SEL* WITH (- (FETCH CHLIM OF *SEL*)                                                            (FETCH CH# OF *SEL*)))                              (REPLACE POINT OF *SEL* WITH 'RIGHT)                              (REPLACE HASCARET OF *SEL* WITH NIL)                              (REPLACE SELKIND OF *SEL* WITH 'LINE)                              (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                              (DO.LEVEL2HEAD *OSTREAM* *TEXTOBJ* *SEL*)                              (REPLACE CH# OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                              (REPLACE CHLIM OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                              (REPLACE DCH OF *SEL* WITH 0)                              (REPLACE POINT OF *SEL* WITH 'RIGHT)                              (REPLACE HASCARET OF *SEL* WITH NIL)                              (REPLACE SELOBJ OF *SEL* WITH NIL)                              (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                              (SETFILEPTR *OSTREAM* (GETEOFPTR *OSTREAM*))                              (TEDIT.INSERT *OSTREAM* "a")                              (REPLACE CH# OF *SEL* WITH (CL:1- (fetch TEXTLEN of *TEXTOBJ*)))                              (replace CHLIM of *SEL* with (fetch TEXTLEN of *TEXTOBJ*))                              (replace DCH of *SEL* with 2)                              (replace POINT of *SEL* with 'RIGHT)                              (replace HASCARET of *SEL* with NIL)                              (replace SELOBJ of *SEL* with NIL)                              (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                              (DO.DEFAULTPARA *OSTREAM* *TEXTOBJ* *SEL*)                              (REPLACE CH# OF *SEL* WITH (CL:1- (fetch TEXTLEN of *TEXTOBJ*)))                              (replace CHLIM of *SEL* with (fetch TEXTLEN of *TEXTOBJ*))                              (replace DCH of *SEL* with 1)                              (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                              (\TEDIT.CHARDELETE *TEXTOBJ* "" *SEL*)                              (REPLACE \INSERTPCVALID OF *TEXTOBJ* WITH T)                              (REPLACE CARETLOOKS OF *TEXTOBJ* WITH (FETCH PLOOKS                                                                       OF (FETCH \INSERTPC                                                                             OF *TEXTOBJ*)))                              (TEDIT.LOOKS *OSTREAM* '(WEIGHT MEDIUM))                              (SETQ *CURRENT-LINE-INDEX* 20000)))(CL:DEFUN DO.SEMICOLON NIL                                   (* ; "This code handles ; commands")                           (SETQ *CURRENT-LINE-INDEX* 20000) (* ; "ignore the line")                           )(CL:DEFUN DO.SUBSECTION NIL (LET (SECTION-NAME POS)                                 (SETQ POS (CL:POSITION #\{ *CURRENT-LINE*))                                 (SETQ SECTION-NAME (CL:SUBSEQ *CURRENT-LINE* (CL:1+ POS)                                                           (CL:POSITION #\} *CURRENT-LINE*)))                                 (SETQ *SEL* (FETCH SEL OF *TEXTOBJ*))                                 (REPLACE CH# OF *SEL* WITH (FETCH TEXTLEN OF *TEXTOBJ*))                                 (REPLACE CHLIM OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                                 (REPLACE DCH OF *SEL* WITH 1)                                 (REPLACE POINT OF *SEL* WITH 'RIGHT)                                 (REPLACE HASCARET OF *SEL* WITH NIL)                                 (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                                 (TEDIT.INSERT *OSTREAM* "")                                 (REPLACE CH# OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                                 (FORMAT *OSTREAM* " ~A ~%%" SECTION-NAME)                                 (REPLACE CHLIM OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                                 (REPLACE DCH OF *SEL* WITH (- (FETCH CHLIM OF *SEL*)                                                               (FETCH CH# OF *SEL*)))                                 (REPLACE POINT OF *SEL* WITH 'RIGHT)                                 (REPLACE HASCARET OF *SEL* WITH NIL)                                 (REPLACE SELKIND OF *SEL* WITH 'LINE)                                 (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                                 (DO.LEVEL3HEAD *OSTREAM* *TEXTOBJ* *SEL*)                                 (REPLACE CH# OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                                 (REPLACE CHLIM OF *SEL* WITH (CL:1+ (FETCH TEXTLEN OF *TEXTOBJ*)))                                 (REPLACE DCH OF *SEL* WITH 0)                                 (REPLACE POINT OF *SEL* WITH 'RIGHT)                                 (REPLACE HASCARET OF *SEL* WITH NIL)                                 (REPLACE SELOBJ OF *SEL* WITH NIL)                                 (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                                 (TEDIT.INSERT *OSTREAM* "a")                                 (REPLACE CH# OF *SEL* WITH (CL:1- (fetch TEXTLEN of *TEXTOBJ*)))                                 (replace CHLIM of *SEL* with (fetch TEXTLEN of *TEXTOBJ*))                                 (replace DCH of *SEL* with 2)                                 (replace POINT of *SEL* with 'RIGHT)                                 (replace HASCARET of *SEL* with NIL)                                 (replace SELOBJ of *SEL* with NIL)                                 (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                                 (DO.DEFAULTPARA *OSTREAM* *TEXTOBJ* *SEL*)                                 (REPLACE CH# OF *SEL* WITH (CL:1- (fetch TEXTLEN of *TEXTOBJ*)))                                 (replace CHLIM of *SEL* with (fetch TEXTLEN of *TEXTOBJ*))                                 (replace DCH of *SEL* with 1)                                 (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                                 (\TEDIT.CHARDELETE *TEXTOBJ* "" *SEL*)                                 (REPLACE \INSERTPCVALID OF *TEXTOBJ* WITH T)                                 (REPLACE CARETLOOKS OF *TEXTOBJ* WITH (FETCH PLOOKS                                                                          OF (FETCH \INSERTPC                                                                                OF *TEXTOBJ*)))                                 (TEDIT.LOOKS *OSTREAM* '(WEIGHT MEDIUM))                                 (SETQ *CURRENT-LINE-INDEX* 20000)))(CL:DEFUN DO.BACKSLASH NIL (IGNORE-ERRORS (COND                                             ((CL:STRING= *CURRENT-LINE* "\/" :START1                                                      *CURRENT-LINE-INDEX* :END1 (+                                                                                  *CURRENT-LINE-INDEX*                                                                                    2))                                              (TEDIT.INSERT *OSTREAM* " ")                                              (add *CURRENT-LINE-INDEX* 1))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "\TT" :START1 *CURRENT-LINE-INDEX* :END1                                                     (+ *CURRENT-LINE-INDEX* 3))                                              (DO.BOLDFACE))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "\BF" :START1 *CURRENT-LINE-INDEX* :END1                                                     (+ *CURRENT-LINE-INDEX* 3))                                              (DO.BOLDFACE))                                             ((COND                                                 ((>= (CL:LENGTH *CURRENT-LINE*)                                                      (+ *CURRENT-LINE-INDEX* 18))                                                  (COND                                                     ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                             "\ITEMITEMITEM{---}" :START1                                                              *CURRENT-LINE-INDEX* :END1                                                             (+ *CURRENT-LINE-INDEX* 18))                                                      (DO.MNDASH)                                                      T)))))                                             ((COND                                                 ((>= (CL:LENGTH *CURRENT-LINE*)                                                      (+ *CURRENT-LINE-INDEX* 13))                                                  (COND                                                     ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                             "\ITEMITEM{--}" :START1                                                              *CURRENT-LINE-INDEX* :END1                                                             (+ *CURRENT-LINE-INDEX* 13))                                                      (DO.MDASH)                                                      T)))))                                             ((COND                                                 ((>= (CL:LENGTH *CURRENT-LINE*)                                                      (+ *CURRENT-LINE-INDEX* 12))                                                  (COND                                                     ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                             "\ITEM{\BULL}" :START1                                                              *CURRENT-LINE-INDEX* :END1                                                             (+ *CURRENT-LINE-INDEX* 12))                                                      (DO.BULLET)                                                      T)))))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "\IT" :START1 *CURRENT-LINE-INDEX* :END1                                                     (+ *CURRENT-LINE-INDEX* 3))                                              (DO.ITALIC))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "\DF" :START1 *CURRENT-LINE-INDEX* :END1                                                     (+ *CURRENT-LINE-INDEX* 3))                                              (DO.DF))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "\BIT" :START1 *CURRENT-LINE-INDEX* :END1                                                     (+ *CURRENT-LINE-INDEX* 4))                                              (DO.BOLDITALIC))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "\SCREEN!" :START1 *CURRENT-LINE-INDEX* :END1                                                     (+ *CURRENT-LINE-INDEX* 8))                                              (DO.SCREEN))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "\ENDSCREEN!" :START1 *CURRENT-LINE-INDEX* :END1                                                     (+ *CURRENT-LINE-INDEX* 11))                                              (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT*)                                              (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT-FACE*)                                              (SETQ *SCREEN-FONT-FLG* NIL)                                              (SETQ *CURRENT-LINE-INDEX* 20000))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "\VBAR" :START1 *CURRENT-LINE-INDEX* :END1                                                     (+ *CURRENT-LINE-INDEX* 5))                                              (TEDIT.INSERT *OSTREAM* "|")                                              (add *CURRENT-LINE-INDEX* 4))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "CURLY" :START1 (CL:1+ *CURRENT-LINE-INDEX*)                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 6))                                              (CL:IF *R-CURLY-FLG* (PROGN (TEDIT.INSERT *OSTREAM* "}"                                                                                 )                                                                          (SETQ *R-CURLY-FLG* NIL))                                                     (PROGN (TEDIT.INSERT *OSTREAM* "{")                                                            (SETQ *R-CURLY-FLG* T)))                                              (add *CURRENT-LINE-INDEX* 5))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "TILDE" :START1 (CL:1+ *CURRENT-LINE-INDEX*)                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 6))                                              (TEDIT.INSERT *OSTREAM* "~")                                              (add *CURRENT-LINE-INDEX* 5))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "\LABEL" :START1 *CURRENT-LINE-INDEX* :END1                                                     (+ *CURRENT-LINE-INDEX* 6))                                              (DO.LABEL))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "UPARROW" :START1 (CL:1+ *CURRENT-LINE-INDEX*)                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 8))                                              (TEDIT.INSERT *OSTREAM* "^")                                              (add *CURRENT-LINE-INDEX* 7))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "BEGINCOM" :START1 (CL:1+ *CURRENT-LINE-INDEX*)                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 9))                                              (DO.BEGINCOM))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "ENDCOM" :START1 (CL:1+ *CURRENT-LINE-INDEX*)                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 7))                                              (DO.DEFAULTPARA *OSTREAM* *TEXTOBJ* *SEL*)                                              (SETQ *CURRENT-LINE-INDEX* 20000))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "BEGINLIST" :START1 (CL:1+ *CURRENT-LINE-INDEX*)                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 10))                                              (DO.LIST))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "DOUBLEQUOTE" :START1 (CL:1+                                                                                  *CURRENT-LINE-INDEX*                                                                                  )                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 12))                                              (TEDIT.INSERT *OSTREAM* "%"")                                              (add *CURRENT-LINE-INDEX* 11))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "BEGINCHAPTER" :START1 (CL:1+                                                                                  *CURRENT-LINE-INDEX*                                                                                   )                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 13))                                              (DO.CHAPTER))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "BEGINSECTION" :START1 (CL:1+                                                                                  *CURRENT-LINE-INDEX*                                                                                   )                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 13))                                              (DO.SECTION))                                             ((CL:STRING= (CL:STRING-UPCASE *CURRENT-LINE*)                                                     "BEGINSUBSECTION" :START1 (CL:1+                                                                                  *CURRENT-LINE-INDEX*                                                                                      )                                                     :END1                                                     (+ *CURRENT-LINE-INDEX* 16))                                              (DO.SUBSECTION))                                             (T (TEDIT.INSERT *OSTREAM* (SUBSTRING *CURRENT-LINE*                                                                               (CL:1+                                                                                  *CURRENT-LINE-INDEX*                                                                                      )))                                                (TEDIT.INSERT *OSTREAM* "")                                                (SETQ *CURRENT-LINE-INDEX* 20000)))))(CL:DEFUN DO.BEGINCOM NIL (LET (SECTION-NAME POS)                               (SETQ POS (CL:POSITION #\{ *CURRENT-LINE*))                               (SETQ SECTION-NAME (CL:SUBSEQ *CURRENT-LINE* (CL:1+ POS)                                                         (CL:POSITION #\} *CURRENT-LINE*)))                               (TEDIT.INSERT *OSTREAM* "")                               (SETQ *SEL* (fetch SEL of *TEXTOBJ*))                               (replace CH# of *SEL* with (fetch TEXTLEN of *TEXTOBJ*))                               (replace CHLIM of *SEL* with (fetch TEXTLEN of *TEXTOBJ*))                               (replace DCH of *SEL* with 0)                               (replace POINT of *SEL* with 'RIGHT)                               (replace HASCARET of *SEL* with NIL)                               (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                               (replace CH# of *SEL* with (CL:1+ (fetch TEXTLEN of *TEXTOBJ*)))                               (FORMAT *OSTREAM* " ~A ~%%" SECTION-NAME)                               (replace CHLIM of *SEL* with (CL:1+ (fetch TEXTLEN of *TEXTOBJ*)))                               (replace DCH of *SEL* with (- (fetch CHLIM of *SEL*)                                                             (fetch CH# of *SEL*)))                               (replace POINT of *SEL* with 'RIGHT)                               (replace HASCARET of *SEL* with NIL)                               (replace SELKIND of *SEL* with 'LINE)                               (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                               (DO.LEVEL2HEAD *OSTREAM* *TEXTOBJ* *SEL*)                               (replace CH# of *SEL* with (CL:1+ (fetch TEXTLEN of *TEXTOBJ*)))                               (replace CHLIM of *SEL* with (CL:1+ (fetch TEXTLEN of *TEXTOBJ*)))                               (replace DCH of *SEL* with 0)                               (replace POINT of *SEL* with 'RIGHT)                               (replace HASCARET of *SEL* with NIL)                               (replace SELOBJ of *SEL* with NIL)                               (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                               (SETFILEPTR *OSTREAM* (GETEOFPTR *OSTREAM*))                               (TEDIT.INSERT *OSTREAM* "a")                               (replace CH# of *SEL* with (CL:1- (fetch TEXTLEN of *TEXTOBJ*)))                               (replace CHLIM of *SEL* with (fetch TEXTLEN of *TEXTOBJ*))                               (replace DCH of *SEL* with 2)                               (replace POINT of *SEL* with 'RIGHT)                               (replace HASCARET of *SEL* with NIL)                               (replace SELOBJ of *SEL* with NIL)                               (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                               (DO.DEFAULTPARA *OSTREAM* *TEXTOBJ* *SEL*)                               (replace CH# of *SEL* with (CL:1- (fetch TEXTLEN of *TEXTOBJ*)))                               (replace CHLIM of *SEL* with (fetch TEXTLEN of *TEXTOBJ*))                               (replace DCH of *SEL* with 1)                               (\FIXSEL *SEL* *TEXTOBJ* *TEX2TEDIT-WINDOW*)                               (\TEDIT.CHARDELETE *TEXTOBJ* "" *SEL*)                               (replace \INSERTPCVALID of *TEXTOBJ* with T)                               (replace CARETLOOKS of *TEXTOBJ* with (fetch PLOOKS                                                                        of (fetch \INSERTPC                                                                              of *TEXTOBJ*)))                               (TEDIT.LOOKS *OSTREAM* '(WEIGHT MEDIUM))                               (SETQ *CURRENT-LINE-INDEX* 20000)))(CL:DEFUN DO.BOLDFACE NIL (SETQ *NEW-FACE* T)                          (TEDIT.LOOKS *OSTREAM* '(FACE BRR))                          (add *CURRENT-LINE-INDEX* 2)                          (CK.EOL))(CL:DEFUN DO.BOLDITALIC NIL (SETQ *NEW-FACE* T)                            (TEDIT.LOOKS *OSTREAM* '(FACE BIR))                            (add *CURRENT-LINE-INDEX* 3)                            (CK.EOL))(CL:DEFUN DO.BULLET NIL (TEDIT.INSERT *OSTREAM* "")                        (TEDIT.PARALOOKS *TEXTOBJ*                               '(QUAD JUSTIFIED PARALEADING 7 LINELEADING 0 1STLEFTMARGIN 204                                       LEFTMARGIN 232 RIGHTMARGIN 504 HEADINGKEEP OFF BASETOBASE NIL                                       PAGEHEADING NIL TABS (28 (232 . LEFT))) *SEL*)                        (TEDIT.LOOKS *OSTREAM* '(FONT MODERN 14 MRR))                        (TEDIT.INSERT *OSTREAM* 61286)                        (TEDIT.INSERT *OSTREAM* (CHARCODE TAB))                        (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT*)                        (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT-FACE*)                        (ADD *CURRENT-LINE-INDEX* 11))(CL:DEFUN DO.LCURLY NIL)(CL:DEFUN DO.RCURLY NIL                                      (* reset the font/face if necessary)                        (CL:IF *NEW-FONT* (PROGN (SETQ *NEW-FONT* NIL)                                                 (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT*)))                        (CL:IF *NEW-FACE* (PROGN (SETQ *NEW-FACE* NIL)                                                 (TEDIT.LOOKS *OSTREAM* *CURRENT-FONT-FACE*))))(CL:DEFUN DO.RUNNINGHEADS (TEXTSTREAM TEXTOBJ SEL)           (* jds " 2-Oct-85 15:13")   (TEDIT.SETSEL TEXTSTREAM 1 0 'LEFT NIL NIL 'NORMAL)       (* Set the selection to the front of                                                              the document)   (TEDIT.INCLUDE TEXTSTREAM '{ERIS}<DOC>UTILITIES>XPS-LARGE-FORMAT-RUNNING-HEAD-TEMPLATE.TEDIT))(CL:DEFUN DO.EXCLAIM NIL                                     (* ; "This code handles ! commands")                         (SETQ *CURRENT-LINE-INDEX* 20000)   (* ; "ignore the line")                         )(CL:DEFUN DO.OUTPUT NIL                                      (* Output one char to the textstream)                        (CL:IF (SUBSTRING *CURRENT-LINE* (CL:1+ *CURRENT-LINE-INDEX*)                                      (CL:1+ *CURRENT-LINE-INDEX*))                               (TEDIT.INSERT *OSTREAM* (SUBSTRING *CURRENT-LINE* (CL:1+                                                                                  *CURRENT-LINE-INDEX*                                                                                        )                                                              (CL:1+ *CURRENT-LINE-INDEX*)))))(CL:DEFUN TEX2TEDIT (IFILE OFILE &OPTIONAL WINDOW) (SETQ *ISTREAM* (OPENSTREAM IFILE 'INPUT))                                                   (SETQ *OSTREAM*                                                    (OPENTEXTSTREAM NIL (SETQ *TEX2TEDIT-WINDOW*                                                                         (OR WINDOW                                                                              *TEX2TEDIT-WINDOW*                                                                             (CREATEW)))                                                           NIL NIL '(FONT (HELVETICA 14 MRR))))                                                   (TEDIT.PROMPTPRINT *OSTREAM* "" T)                                                   (SETQ *TEXTOBJ* (TEXTOBJ *OSTREAM*))                                                   (SETQ *SEL* (fetch SEL of *TEXTOBJ*))                                                   (SETQ *INDENT-FLG* NIL)                                                   (SETQ *NEW-FACE* NIL)                                                   (SETQ *R-CURLY-FLG* NIL)                                                   (SETQ *SCREEN-FONT-FLG* NIL)                                                   (DO.PAGELAYOUT *OSTREAM* *TEXTOBJ* *SEL*)                                                   (DO.CONVERSION)                                                   (TEDIT.PUT *OSTREAM* OFILE)                                                   (CLOSEF *ISTREAM*)                                                   (CLOSEF *OSTREAM*))(CL:DEFVAR *INDENT-FLG* NIL)(CL:DEFVAR *ISTREAM* NIL)(CL:DEFVAR *NEW-FACE* NIL)(CL:DEFVAR *NEW-FONT* NIL)(CL:DEFVAR *OSTREAM* NIL)(CL:DEFVAR *R-CURLY-FLG* NIL)(CL:DEFVAR *CURRENT-FONT-FACE* '(FACE MRR) )(CL:DEFVAR *CURRENT-FONT* '(FAMILY MODERN SIZE 10) )(CL:DEFVAR *CURRENT-LINE* "" )(CL:DEFVAR *CURRENT-LINE-INDEX* 0)(CL:DEFVAR *GROUP-LIST* NIL)(CL:DEFVAR *TEXTOBJ* NIL)(CL:DEFVAR *TEX2TEDIT-WINDOW* (CREATEW (LIST (- SCREENWIDTH 570)                                             0 571 SCREENHEIGHT)) )(CL:DEFVAR *SCREEN-FONT-FLG* NIL)(CL:DEFVAR *SEL* NIL)(CL:DEFVAR *CHNUM* NIL)(CL:DEFVAR *CHLIM* NIL)(PUTPROPS TEX2TEDIT COPYRIGHT ("Xerox Corporation" 1986))(DECLARE%: DONTCOPY  (FILEMAP (NIL)))STOP