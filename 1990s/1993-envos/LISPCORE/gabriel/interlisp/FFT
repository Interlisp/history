(FILECREATED "15-Nov-85 17:41:43" {QV}<PEDERSEN>BENCHMARKS>FFT.;3 4803         changes to:  (FNS FFT)		   (VARS FFTCOMS)      previous date: " 8-Nov-85 17:37:57" {QV}<PEDERSEN>BENCHMARKS>FFT.;1)(* Copyright (c) 1983, 1985 by JonL. All rights reserved.)(PRETTYCOMPRINT FFTCOMS)(RPAQQ FFTCOMS ((FNS FFT FFT-BENCH)		  [VARS (RE (MAKE-ARRAY 1025 (QUOTE :ELEMENT-TYPE)					(QUOTE FLOAT)))			(IM (MAKE-ARRAY 1025 (QUOTE :ELEMENT-TYPE)					(QUOTE FLOAT]		  (MACROS IEXPT)		  (* * CALL (FFT-BENCH))		  (DECLARE: DONTEVAL@LOAD DONTCOPY DOEVAL@COMPILE (LOCALVARS . T))))(DEFINEQ(FFT  [LAMBDA (AREAL AIMAG)                                      (* JonL "21-OCT-83 20:47")                                                             (* Fast Fourier Transform AREAL = real part AIMAG = 							     imaginary part)          (* *)    (PROG (AR AI PI I J K M N LE LE1 IP NV2 NM1 UR UI WR WI TR TI)	    (SETQ AR AREAL)                                (* Initialize)	    (SETQ AI AIMAG)	    (SETQ PI 3.141593)	    (SETQ N (ARRAY-DIMENSION AR 0))	    (add N -1)	    (SETQ NV2 (LRSH N 1))	    (SETQ NM1 (SUB1 N))	    (SETQ M 0)	    (SETQ I 1)	L1  (until (NOT (ILESSP I N))	       do                                          (* Compute M = log (N))		    (add M 1)		    (add I I))                             (* Note that Interlisp could do this by merely setting							     M = (SUB1 (INTEGERLENGTH N)) and testing 							     (POWEROFTWOP N))	    (if (NOT (IEQP N (IEXPT 2 M)))		then (ERROR "Array size not a power of two" N))	    (SETQ J 1)                                     (* ;Interchange elements)	    (SETQ I 1)                                     (* ;in bit-reversed order)	L3  (repeatuntil (NOT (ILESSP I N))	       do (if (ILESSP I J)			then (SETQ TR (LAREF AR J))			       (SETQ TI (LAREF AI J))			       (LASET (LAREF AR I)				      AR J)			       (LASET (LAREF AI I)				      AI J)			       (LASET TR AR I)			       (LASET TI AI I))		    (SETQ K NV2)		    L6		    (until (NOT (ILESSP K J))		       do (SETQ J (IDIFFERENCE J K))			    (SETQ K (LRSH K 1)))		    (SETQ J (IPLUS J K))		    (add I 1))	    (for L to M	       do                                          (* ;Loop thru stages)		    (SETQ LE (IEXPT 2 L))		    (SETQ LE1 (LRSH LE 1))		    (SETQ UR 1.0)		    (SETQ UI 0.0)		    [SETQ WR (COS (FQUOTIENT PI (FLOAT LE1]		    [SETQ WI (SIN (FQUOTIENT PI (FLOAT LE1]		    (for J to LE1		       do                                  (* ;Loop thru butterflies)			    (for I from J by LE until (IGREATERP I N)			       do                          (* ;Do a butterfly)				    (SETQ IP (IPLUS I LE1))				    (SETQ TR (FDIFFERENCE (FTIMES (LAREF AR IP)									UR)							      (FTIMES (LAREF AI IP)									UI)))				    (SETQ TI (FPLUS (FTIMES (LAREF AR IP)								  UI)							(FTIMES (LAREF AI IP)								  UR)))				    (LASET (FDIFFERENCE (LAREF AR I)							  TR)					   AR IP)				    (LASET (FDIFFERENCE (LAREF AI I)							  TI)					   AI IP)				    (LASET (FPLUS (LAREF AR I)						    TR)					   AR I)				    (LASET (FPLUS (LAREF AI I)						    TI)					   AI I))			    (SETQ TR (FDIFFERENCE (FTIMES UR WR)						      (FTIMES UI WI)))			    (SETQ TI (FPLUS (FTIMES UR WI)						(FTIMES UI WR)))			    (SETQ UR TR)			    (SETQ UI TI)))	    (RETURN T])(FFT-BENCH  [LAMBDA NIL                                                (* jop: " 8-Nov-85 17:36")    (DECLARE (SPECVARS RE IM))    (for I from 1 to 10 do (FFT RE IM]))(RPAQ RE (MAKE-ARRAY 1025 (QUOTE :ELEMENT-TYPE)		       (QUOTE FLOAT)))(RPAQ IM (MAKE-ARRAY 1025 (QUOTE :ELEMENT-TYPE)		       (QUOTE FLOAT)))(DECLARE: EVAL@COMPILE [PUTPROPS IEXPT MACRO (X (PROG ([N (CAR (CONSTANTEXPRESSIONP (CAR X]				(E (CADR X)))			       (RETURN (if (AND (FIXP N)						(POWEROFTWOP N))					   then					   [if (NEQ 2 N)					       then					       (SETQ E (BQUOTE (ITIMES , (SUB1 (INTEGERLENGTH N))								       ,E]					   (BQUOTE (MASK.1'S , E 1))					   else					   (BQUOTE (EXPT (IPLUS 0 , (CAR X))							 (IPLUS 0 , (CADR X])(* * CALL (FFT-BENCH))(DECLARE: DONTEVAL@LOAD DONTCOPY DOEVAL@COMPILE (DECLARE: DOEVAL@COMPILE DONTCOPY(LOCALVARS . T)))(PUTPROPS FFT COPYRIGHT ("JonL" 1983 1985))(DECLARE: DONTCOPY  (FILEMAP (NIL (590 4025 (FFT 600 . 3816) (FFT-BENCH 3818 . 4023)))))STOP