(FILECREATED "19-Nov-85 22:24:40" {QV}<PEDERSEN>BENCHMARKS>TRAVERSE.;7 6905         changes to:  (VARS TRAVERSECOMS)		   (FNS RUN-TRAVERSE INIT-TRAVERSE CREATE-STRUCTURE SNB SEED RANDOM TREMOVE TRAVERSE 			RANDOM-TRAVERSE SEED-TRAVERSE FIND-ROOT TADD TRAVERS TSELECT)      previous date: " 9-Jan-84 17:55:36" {PHYLUM}<GABRIEL>TRAVERSE.;10)(PRETTYCOMPRINT TRAVERSECOMS)(RPAQQ TRAVERSECOMS ((RECORDS NODE)		       (FNS INIT-TRAVERSE SNB SEED-TRAVERSE RANDOM-TRAVERSE RUN-TRAVERSE TREMOVE 			    TSELECT TADD CREATE-STRUCTURE FIND-ROOT TRAVERS TRAVERSE)		       (* * Call (INIT-TRAVERSE)			  then			  (RUN-TRAVERSE))		       (DECLARE: DONTCOPY DONTEVAL@LOAD DOEVAL@COMPILE (LOCALVARS . T))))[DECLARE: EVAL@COMPILE (DATATYPE NODE ((PARENTS POINTER)		  (SONS POINTER)		  (SN WORD)		  (ENTRY1 FLAG)		  (ENTRY2 FLAG)		  (ENTRY3 FLAG)		  (ENTRY4 FLAG)		  (ENTRY5 FLAG)		  (ENTRY6 FLAG)		  (MARK FLAG))		 SN _(SNB))](/DECLAREDATATYPE (QUOTE NODE)		  (QUOTE (POINTER POINTER WORD FLAG FLAG FLAG FLAG FLAG FLAG FLAG))		  [QUOTE ((NODE 0 POINTER)			  (NODE 2 POINTER)			  (NODE 4 (BITS . 15))			  (NODE 2 (FLAGBITS . 0))			  (NODE 2 (FLAGBITS . 16))			  (NODE 2 (FLAGBITS . 32))			  (NODE 2 (FLAGBITS . 48))			  (NODE 2 (FLAGBITS . 64))			  (NODE 2 (FLAGBITS . 80))			  (NODE 2 (FLAGBITS . 96]		  (QUOTE 6))(DEFINEQ(INIT-TRAVERSE  [LAMBDA NIL                                                (* jop: "19-Nov-85 22:14")    (DECLARE (GLOBALVARS ROOT SN MARKER))    (SETQ SN 0)    (SETQ MARKER NIL)    (SEED-TRAVERSE)    (SETQ ROOT (CREATE-STRUCTURE 100])(SNB  [LAMBDA NIL                                                (* jop: "19-Nov-85 22:01")    (DECLARE (GLOBALVARS SN))    (SETQ SN (ADD1 SN])(SEED-TRAVERSE  [LAMBDA NIL                                                (* jop: "19-Nov-85 22:11")    (DECLARE (GLOBALVARS RAND-TRAVERSE))    (SETQ RAND-TRAVERSE 21])(RANDOM-TRAVERSE  [LAMBDA NIL                                                (* jop: "19-Nov-85 22:10")    (DECLARE (GLOBALVARS RAND-TRAVERSE))    (SETQ RAND-TRAVERSE (IREMAINDER (ITIMES RAND-TRAVERSE 17)					251])(RUN-TRAVERSE  [LAMBDA NIL                                                (* jop: "19-Nov-85 21:59")    (DECLARE (GLOBALVARS ROOT))    (for I from 1 to 50       do (TRAVERSE ROOT)	    (TRAVERSE ROOT)	    (TRAVERSE ROOT)	    (TRAVERSE ROOT)	    (TRAVERSE ROOT])(TREMOVE  [LAMBDA (N Q)                                              (* jop: "19-Nov-85 22:04")    (COND      ((EQ (CDR (CAR Q))	     (CAR Q))	(PROG2 NIL (CAAR Q)		 (RPLACA Q NIL)))      [(ZEROP N)	(PROG2 NIL (CAAR Q)		 (bind (P _(CAR Q)) until (EQ (CDR P)						      (CAR Q))		    do (pop P) finally (RETURN (RPLACA Q (RPLACD P (CDR (CAR Q]      (T (for N (Q _(CAR Q))		(P _(CDR (CAR Q))) from N by -1 until (ZEROP N)	    do (pop Q)		 (pop P)	    finally (RETURN (PROG2 NIL (CAR Q)					 (RPLACD Q P])(TSELECT  [LAMBDA (N Q)                                              (* JonL " 5-JUL-83 13:37")    (for N (Q _(CAR Q)) from N by -1 until (ZEROP N) do (pop Q)       finally (RETURN (CAR Q])(TADD  [LAMBDA (A Q)                                              (* JonL " 5-JUL-83 15:50")    (COND      [(NULL Q)	(PROG ((X (LIST A)))	        (RPLACD X X)	        (RETURN (LIST X]      [(NULL (CAR Q))	(PROG ((X (LIST A)))	        (RPLACD X X)	        (RETURN (RPLACA Q X]      (T (RPLACA Q (RPLACD (CAR Q)			       (CONS A (CDR (CAR Q])(CREATE-STRUCTURE  [LAMBDA (N)                                                (* jop: "19-Nov-85 22:09")    (PROG [(A (LIST (create NODE]	    (RETURN (for M (P _ A) from (SUB1 N) by -1 until (ZEROP M)			 do (push A (create NODE))			 finally (PROGN (SETQ A (LIST (RPLACD P A)))					    (RETURN (bind (UNUSED _ A)							      (USED _(TADD (TREMOVE 0 A)									     NIL))							      X Y until (NULL (CAR UNUSED))							 do (SETQ X (TREMOVE (IMOD (										  RANDOM-TRAVERSE)											   N)										   UNUSED))							      (SETQ Y (TSELECT (IMOD (										  RANDOM-TRAVERSE)											   N)										   USED))							      (TADD X USED)							      (push (fetch SONS of Y)								      X)							      (push (fetch PARENTS of X)								      Y)							 finally (RETURN (FIND-ROOT									       (TSELECT 0 USED)									       N])(FIND-ROOT  [LAMBDA (NODE N)                                           (* JonL " 9-Jan-84 17:52")    (for old N from N by -1 until (ZEROP N) do [if (NULL (ffetch PARENTS									      of NODE))								 then (RETURN NODE)							       else (SETQ NODE									(CAR (ffetch PARENTS										  of NODE]       finally (RETURN NODE])(TRAVERS  [LAMBDA (NODE MARK)                                        (* JonL " 9-Jan-84 17:53")    (DECLARE (SPECVARS COUNT))    (if (EQ (ffetch MARK of NODE)		MARK)	then NIL      else (freplace MARK of NODE with MARK)	     (add COUNT 1)	     (freplace ENTRY1 of NODE with (NOT (ffetch ENTRY1 of NODE)))	     (freplace ENTRY2 of NODE with (NOT (ffetch ENTRY2 of NODE)))	     (freplace ENTRY3 of NODE with (NOT (ffetch ENTRY3 of NODE)))	     (freplace ENTRY4 of NODE with (NOT (ffetch ENTRY4 of NODE)))	     (freplace ENTRY5 of NODE with (NOT (ffetch ENTRY5 of NODE)))	     (freplace ENTRY6 of NODE with (NOT (ffetch ENTRY6 of NODE)))	     (for SONS on (ffetch SONS of NODE) do (TRAVERS (CAR SONS)									MARK])(TRAVERSE  [LAMBDA (ROOT1)                                            (* jop: "19-Nov-85 22:06")    (DECLARE (GLOBALVARS MARKER)	       (SPECVARS COUNT))    (PROG ((COUNT 0))	    (TRAVERS ROOT1 (SETQ MARKER (NOT MARKER)))	    (RETURN COUNT]))(* * Call (INIT-TRAVERSE) then (RUN-TRAVERSE))(DECLARE: DONTCOPY DONTEVAL@LOAD DOEVAL@COMPILE (DECLARE: DOEVAL@COMPILE DONTCOPY(LOCALVARS . T)))(PUTPROPS TRAVERSE COPYRIGHT (NONE))(DECLARE: DONTCOPY  (FILEMAP (NIL (1358 6689 (INIT-TRAVERSE 1368 . 1645) (SNB 1647 . 1817) (SEED-TRAVERSE 1819 . 2011) (RANDOM-TRAVERSE 2013 . 2259) (RUN-TRAVERSE 2261 . 2581) (TREMOVE 2583 . 3273) (TSELECT 3275 . 3519) (TADD 3521 . 3961) (CREATE-STRUCTURE 3963 . 5013) (FIND-ROOT 5015 . 5438) (TRAVERS 5440 . 6394) (TRAVERSE 6396 . 6687)))))STOP