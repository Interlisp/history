(FILECREATED "12-Nov-85 17:21:33" {QV}<PEDERSEN>BENCHMARKS>PUZZLE.;5 6119         changes to:  (FNS FRESHPUZZLES START DEFINEPIECE TRIAL REMOVE! PLACE FIT)		   (VARS PUZZLECOMS)      previous date: " 2-OCT-83 15:53:02" {PHYLUM}<GABRIEL>PUZZLE.;7)(* Copyright (c) 1982, 1983, 1985 by Xerox Corporation. All rights reserved.)(PRETTYCOMPRINT PUZZLECOMS)(RPAQQ PUZZLECOMS ((CONSTANTS SIZE TYPEMAX D CLASSMAX)		     (FNS FIT PLACE REMOVE! TRIAL DEFINEPIECE START FRESHPUZZLES)		     (* * First Call (FRESHPUZZLES)			then			(START))		     (DECLARE: DONTEVAL@LOAD DONTCOPY DOEVAL@COMPILE (LOCALVARS . T))))(DECLARE: EVAL@COMPILE (RPAQQ SIZE 511)(RPAQQ TYPEMAX 12)(RPAQQ D 8)(RPAQQ CLASSMAX 3)(CONSTANTS SIZE TYPEMAX D CLASSMAX))(DEFINEQ(FIT  [LAMBDA (I J)                                              (* jop: "11-Nov-85 17:11")    (DECLARE (GLOBALVARS CLASS PIECEMAX PUZZLE P-PUZZLE PIECECOUNT III PUZZLETRACEFLG))    (NOT (find K from 0 to (16AREF PIECEMAX I) suchthat (AND (PAREF P-PUZZLE I K)									 (PAREF PUZZLE										(IPLUS J K])(PLACE  [LAMBDA (I J)                                              (* jop: "11-Nov-85 17:11")    (DECLARE (GLOBALVARS CLASS PIECEMAX PUZZLE P-PUZZLE PIECECOUNT III PUZZLETRACEFLG))    [for K from 0 to (16AREF PIECEMAX I) do (if (PAREF P-PUZZLE I K)							then (PASET T PUZZLE (IPLUS J K]    (16ASET (SUB1 (16AREF PIECECOUNT (16AREF CLASS I)))	    PIECECOUNT	    (16AREF CLASS I))    (OR (find K from J to SIZE suchthat (NOT (PAREF PUZZLE K)))	  0])(REMOVE!  [LAMBDA (I J)                                              (* jop: "11-Nov-85 17:11")    (DECLARE (GLOBALVARS CLASS PIECEMAX PUZZLE P-PUZZLE PIECECOUNT III PUZZLETRACEFLG))    [for K from 0 to (16AREF PIECEMAX I) do (if (PAREF P-PUZZLE I K)							then (PASET NIL PUZZLE (IPLUS J K]    (16ASET (ADD1 (16AREF PIECECOUNT (16AREF CLASS I)))	    PIECECOUNT	    (16AREF CLASS I])(TRIAL  [LAMBDA (J)                                                (* jop: "11-Nov-85 17:10")    (DECLARE (GLOBALVARS CLASS PIECEMAX PUZZLE P-PUZZLE PIECECOUNT III PUZZLETRACEFLG)	       (SPECVARS KOUNT))    (bind (K _ 0) for I from 0 to TYPEMAX       do (if (AND (NEQ 0 (16AREF PIECECOUNT (16AREF CLASS I)))			 (FIT I J))		then (SETQ K (PLACE I J))		       (if (OR (TRIAL K)				   (ZEROP K))			   then (AND PUZZLETRACEFLG (printout NIL T "Piece at " (ADD1 K)))				  (add KOUNT 1)				  (RETURN T)			 else (REMOVE! I J)))       finally (PROGN (add KOUNT 1)			  NIL])(DEFINEPIECE  [LAMBDA (ICLASS II JJ KK)                                  (* jop: "11-Nov-85 17:10")    (DECLARE (GLOBALVARS CLASS PIECEMAX PUZZLE P-PUZZLE PIECECOUNT III PUZZLETRACEFLG))    (PROG ((INDEX 0))	    [for I from 0 to II do (for J from 0 to JJ					      do (for K from 0 to KK						      do [SETQ INDEX							     (IPLUS I								      (ITIMES D										(IPLUS										  J										  (ITIMES D K]							   (PASET T P-PUZZLE III INDEX]	    (16ASET ICLASS CLASS III)	    (16ASET INDEX PIECEMAX III)	    (if (NEQ III TYPEMAX)		then (add III 1])(START  [LAMBDA NIL                                                (* jop: "11-Nov-85 17:23")          (* *)    (DECLARE (GLOBALVARS CLASS PIECEMAX PUZZLE P-PUZZLE PIECECOUNT III PUZZLETRACEFLG)	       (SPECVARS KOUNT))    (for M from 0 to SIZE do (PASET T PUZZLE M))    [for I from 1 to 5 do (for J from 1 to 5				     do (for K from 1 to 5					     do (PASET NIL PUZZLE							 (IPLUS I (ITIMES D									      (IPLUS J										       (ITIMES											 D K]    (for I from 0 to TYPEMAX do (for M from 0 to SIZE					   do (PASET NIL P-PUZZLE I M)))    (SETQ III 0)    (DEFINEPIECE 0 3 1 0)    (DEFINEPIECE 0 1 0 3)    (DEFINEPIECE 0 0 3 1)    (DEFINEPIECE 0 1 3 0)    (DEFINEPIECE 0 3 0 1)    (DEFINEPIECE 0 0 1 3)    (DEFINEPIECE 1 2 0 0)    (DEFINEPIECE 1 0 2 0)    (DEFINEPIECE 1 0 0 2)    (DEFINEPIECE 2 1 1 0)    (DEFINEPIECE 2 1 0 1)    (DEFINEPIECE 2 0 1 1)    (DEFINEPIECE 3 1 1 1)    (16ASET 13 PIECECOUNT 0)    (16ASET 3 PIECECOUNT 1)    (16ASET 1 PIECECOUNT 2)    (16ASET 1 PIECECOUNT 3)    (PROG ([M (IPLUS 1 (ITIMES D (IPLUS 1 D]	     (N 0)	     (KOUNT 0))	    (if (FIT 0 M)		then (SETQ N (PLACE 0 M))	      else (printout NIL T "Error"))	    (if (TRIAL N)		then (printout NIL T "Success in " KOUNT " trials.")	      else (printout NIL T "Failure."))	    (TERPRI])(FRESHPUZZLES  [LAMBDA NIL                                                (* jop: "11-Nov-85 17:29")    (DECLARE (GLOBALVARS CLASS PIECEMAX PUZZLE P-PUZZLE PIECECOUNT III PUZZLETRACEFLG))    (SETQ III 0)    (SETQ PUZZLETRACEFLG NIL)    [SETQ CLASS (MAKE-ARRAY (ADD1 TYPEMAX)				(QUOTE :ELEMENT-TYPE)				(QUOTE (UNSIGNED-BYTE 16]    [SETQ PIECEMAX (MAKE-ARRAY (ADD1 TYPEMAX)				   (QUOTE :ELEMENT-TYPE)				   (QUOTE (UNSIGNED-BYTE 16]    (SETQ PUZZLE (MAKE-ARRAY (IPLUS SIZE 2)))    [SETQ P-PUZZLE (MAKE-ARRAY (LIST (ADD1 TYPEMAX)					   (ADD1 SIZE]    [SETQ PIECECOUNT (MAKE-ARRAY (ADD1 CLASSMAX)				     (QUOTE :ELEMENT-TYPE)				     (QUOTE (UNSIGNED-BYTE 16]    NIL]))(* * First Call (FRESHPUZZLES) then (START))(DECLARE: DONTEVAL@LOAD DONTCOPY DOEVAL@COMPILE (DECLARE: DOEVAL@COMPILE DONTCOPY(LOCALVARS . T)))(PUTPROPS PUZZLE COPYRIGHT ("Xerox Corporation" 1982 1983 1985))(DECLARE: DONTCOPY  (FILEMAP (NIL (777 5877 (FIT 787 . 1140) (PLACE 1142 . 1671) (REMOVE! 1673 . 2111) (TRIAL 2113 . 2817) (DEFINEPIECE 2819 . 3493) (START 3495 . 5071) (FRESHPUZZLES 5073 . 5875)))))STOP