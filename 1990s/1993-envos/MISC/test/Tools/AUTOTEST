(FILECREATED "16-Jul-85 15:52:21" {DANTE}<SVERNON>AUTOTEST.;7 67003        changes to:  (FNS AT.SHOW.STARTTIME AUTOTESTER AT.MAKETIMEWINDOW AT.SHOW.ENDTIME AT.SHOW.TESTID 			AT.SHOW.TESTSUITE AT.REPAINT.TIMEW AT.TESTCOMMAND AT.UPDATEAUTOTESTERITEMS 			AT.SINGLE-TEST SINGLE-TEST AT.ABORTCOMMAND AT.RESUMECOMMAND AT.CLOSEFN 			AT.PAUSECOMMAND TEST-MESSAGE AT.COMMANDDISPATCH AT.HARDCOPYFN AT.PRINTCOMMAND 			AT.PRINTHEADINGSON AT.PRINTANDGETREGION GETPRINTFILE AT.GETPRINTDESTINATION)		   (VARS AUTOTESTCOMS ATICON)      previous date: "20-Jun-85 17:12:30" {DANTE}<SVERNON>AUTOTEST.;22)(* Copyright (c) 1985 by XEROX Corporation. All rights reserved.)(PRETTYCOMPRINT AUTOTESTCOMS)(RPAQQ AUTOTESTCOMS [(FILES ATTACHEDWINDOW ICONW)	[VARS [ATMENUITEMS (QUOTE ((TEST TEST 			       "Tests the selected files; middle button to also redirect output.")				   (ABORT ABORT "Aborts testing of the selected files.")				   (PAUSE PAUSE 					  "Temporarily pauses in the testing of selected files.")				   (RESUME RESUME "Resumes PAUSEd testing.")				   (DIRECTORY DIRECTORY 		     "Does a directory of files in order to create a new set of tests to select.")				   (PRINT PRINT "Prints the results of testing of the selected files; middle button to also select printing destination."					  )				   (SUMMARIZE SUMMARIZE 			 "Prints the results of testing of failed tests from the selected files.")				   (QUIT QUIT "Quits testing."]	      (ATNOARGITEMS (QUOTE (DIRECTORY QUIT)))	      (ATBUSYOKITEMS (QUOTE (ABORT PAUSE RESUME QUIT]	(INITVARS (ATICONFONT (FONTCREATE (QUOTE HELVETICA)					  8					  (QUOTE MRR)))		  (DEFAULTAUTOTESTFONT (FONTCREATE (QUOTE GACHA)						   10						   (QUOTE MRR)))		  (ATTIMEWINDOWFONT (FONTCREATE (QUOTE GACHA)						8						(QUOTE MRR)))		  (ATPROMPTFONT (FONTCREATE (QUOTE GACHA)					    8					    (QUOTE MRR)))		  (AUTOTESTMENUFONT (FONTCREATE (QUOTE HELVETICA)						10						(QUOTE MRR)))		  (ATBORDERWIDTH 2)		  [ATINFOLISTINGWIDTHS (QUOTE (RESULT (Result . 70)						      NAME						      (Name . 180)						      FILE						      (File . 1800]		  (ATINFOSHADE 16920)		  (ATITEMUNSELECTEDSHADE 0)		  (ATITEMSELECTEDSHADE 43605))	(BITMAPS ATICON ATICONMASK)	(CURSORS AT.RIGHTARROWCURSOR)	(* * Main autotester fns)	(FNS AT AUTOTESTER SINGLE-TEST TEST-MESSAGE)	(COMS (* * commands and major subfunctions)	      (FNS AT.TESTCOMMAND AT.ABORTCOMMAND AT.PAUSECOMMAND AT.RESUMECOMMAND 		   AT.DIRECTORYCOMMAND AT.PRINTCOMMAND AT.QUITCOMMAND)	      (FNS AT.COMMANDDISPATCH AT.SELECT AT.UPDATEAUTOTESTERITEMS AT.SINGLE-TEST))	(* * lower-level window mungers)	(FNS AT.MAKERIGIDWINDOW AT.CLRPROMPTW AT.PRINTHEADINGSON AT.PRINTANDGETREGION 	     AT.MAKEHEADINGWINDOW AT.MAKECOUNTERWINDOW AT.MAKETIMEWINDOW AT.PROMPTWPRINT 	     AT.PROMPTWTERPRI AT.SELECTFILE AT.UNSELECTFILE AT.CHANGECOMPLETEMARK 	     AT.SHOW.NUMCOMPLETED AT.SHOW.NUMFILES AT.SHOW.NUMSELECTED AT.SHOW.NUMSUCCESSFUL 	     AT.SHOW.ENDTIME AT.SHOW.STARTTIME AT.SHOW.TESTID AT.SHOW.TESTSUITE)	(* * window functions)	(FNS AT.HEADINGWREDISPLAYFN AT.REPAINT.COUNTERW AT.REPAINT.TIMEW AT.ICONFN AT.BUTTONEVENTFN 	     AT.CURSORMOVEDFN AT.CURSOROUTFN AT.REPAINTFN AT.SCROLLFN AT.RIGHTBUTTONFN 	     AT.MENU.WHENSELECTEDFN AT.CLOSEFN AT.HARDCOPYFN)	(* * odds and ends)	(FNS AT.FETCHFILENAME AT.STARTOFNAME AT.STARTUP AT.CREATEPRINTSPEC AT.FINDTESTBUCKET 	     AT.PROMPTFORINPUT AT.GETALLFILEINFO AT.GETPRINTDESTINATION AT.\ItemWithTag)	(DECLARE: EVAL@COMPILE DONTCOPY (CONSTANTS (AT.MARKXPOS 16))		  (RECORDS ATPRINTSPEC TESTBUCKET))	(ADDVARS (BackgroundMenuCommands ("AutomatedTester" (AT)							    					"Opens an automated tester window; prompts for directory")))	(VARS (BackgroundMenu))	(DECLARE: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS (ADDVARS (NLAMA AT)									      (NLAML)									      (LAMA AT.PROMPTWPRINT])(FILESLOAD ATTACHEDWINDOW ICONW)(RPAQQ ATMENUITEMS ((TEST TEST "Tests the selected files; middle button to also redirect output.")		    (ABORT ABORT "Aborts testing of the selected files.")		    (PAUSE PAUSE "Temporarily pauses in the testing of selected files.")		    (RESUME RESUME "Resumes PAUSEd testing.")		    (DIRECTORY DIRECTORY 		     "Does a directory of files in order to create a new set of tests to select.")		    (PRINT PRINT "Prints the results of testing of the selected files; middle button to also select printing destination."			   )		    (SUMMARIZE SUMMARIZE 			 "Prints the results of testing of failed tests from the selected files.")		    (QUIT QUIT "Quits testing.")))(RPAQQ ATNOARGITEMS (DIRECTORY QUIT))(RPAQQ ATBUSYOKITEMS (ABORT PAUSE RESUME QUIT))(RPAQ? ATICONFONT (FONTCREATE (QUOTE HELVETICA)			      8			      (QUOTE MRR)))(RPAQ? DEFAULTAUTOTESTFONT (FONTCREATE (QUOTE GACHA)				       10				       (QUOTE MRR)))(RPAQ? ATTIMEWINDOWFONT (FONTCREATE (QUOTE GACHA)				    8				    (QUOTE MRR)))(RPAQ? ATPROMPTFONT (FONTCREATE (QUOTE GACHA)				8				(QUOTE MRR)))(RPAQ? AUTOTESTMENUFONT (FONTCREATE (QUOTE HELVETICA)				    10				    (QUOTE MRR)))(RPAQ? ATBORDERWIDTH 2)(RPAQ? ATINFOLISTINGWIDTHS (QUOTE (RESULT (Result . 70)					  NAME					  (Name . 180)					  FILE					  (File . 1800))))(RPAQ? ATINFOSHADE 16920)(RPAQ? ATITEMUNSELECTEDSHADE 0)(RPAQ? ATITEMSELECTEDSHADE 43605)(RPAQ ATICON (READBITMAP))(80 80"OOOOOOOOOOOOOOOOOOOO""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@AOOOOOOON@@@@@A""H@@@@AOOOOOOON@@@@@A""H@@@@AOOOOOOON@@@COA""H@@@@AOOOOOOON@@@GOI""H@@@@AOOOOOOON@@@NAM""H@@@@AOOOOOOON@@@L@M""H@@@@AOOOOOOON@@@L@M""H@@@@AOOOOOOON@@@@@M""H@@@@AOOOOOOON@@@@@M""H@@@@AOOOOOOON@@@@AM""HH@HFAOOOOOOONAH@@OI""HLAHCAOOOOOOON@L@@OA""HFC@AIOOOOOOON@F@@LA""HCF@@MOOOOOOON@C@@LA""HALGOOOOOOOOOOOOH@LA""HALGOOOOOOOOOOOOH@LA""HCF@@MOOOOOOON@C@@LA""HFC@AIOOOOOOON@F@@LA""HLAHCAOOOOOOON@L@@LA""HH@HFAOOOOOOONAH@@@A""H@@@@AOOOOOOON@@@@@A""H@@@@AOOOOOOON@@@@LA""H@@@@AOOOOOOON@@@@LA""H@@@@AOOOOOOON@@@@@A""H@@@@AOOOOOOON@@@@@A""H@@@@AOOOOOOON@@@@@A""H@@@@AOOOOOOON@@@@@A""H@@@@AOOOOOOON@@@@@A""H@@@@AOOOOOOON@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""H@@@@@@@@@@@@@@@@@@A""OOOOOOOOOOOOOOOOOOOO")(RPAQ ATICONMASK (READBITMAP))(80 80"OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO""OOOOOOOOOOOOOOOOOOOO")(RPAQ AT.RIGHTARROWCURSOR (CURSORCREATE (READBITMAP) 7 9))(16 16"@@@@""@@@@""@F@@""@GH@""@GN@""@GOH""OOON""OOOO""OOON""@GOH""@GN@""@GH@""@F@@""@@@@""@@@@""@@@@")(* * Main autotester fns)(DEFINEQ(AT  [NLAMBDA DIR                                               (* scv "23-May-85 11:28")    (AUTOTESTER (OR (CAR (NLAMBDA.ARGS DIR))		    (PROMPTFORWORD "Test directory pattern?" NIL NIL PROMPTWINDOW])(AUTOTESTER  [LAMBDA (FILESPEC)                                         (* scv "15-Jul-85 15:36")    (PROG ((PROMPTWHEIGHT 3)	   AUTOTESTWINDOW COMMANDMENUWINDOW COMMANDMENU DIRSTART HEADINGW COUNTERW TIMEW TTYDS)          (COND	    ((NULL FILESPEC)	      (RETURN)))          (SETQ FILESPEC (DIRECTORY.FILL.PATTERN FILESPEC (QUOTE DCOM)						 ""))          (SETQ COMMANDMENU	    (create MENU		    MENUFONT _ AUTOTESTMENUFONT		    ITEMS _ ATMENUITEMS		    MENUROWS _ 1		    CENTERFLG _ T		    WHENSELECTEDFN _(FUNCTION AT.MENU.WHENSELECTEDFN)))          (SETQ AUTOTESTWINDOW (CREATEW (GETREGION (WIDTHIFWINDOW (fetch IMAGEWIDTH of COMMANDMENU)								  (fetch MENUOUTLINESIZE								     of COMMANDMENU))						   (HEIGHTIFWINDOW (ITIMES 4 (FONTPROP 									      DEFAULTAUTOTESTFONT										       (QUOTE HEIGHT))									   )								   NIL ATBORDERWIDTH))					NIL ATBORDERWIDTH))          (SETQ HEADINGW (AT.MAKEHEADINGWINDOW (GETWINDOWPROP AUTOTESTWINDOW (QUOTE WIDTH))					       DEFAULTAUTOTESTFONT ATBORDERWIDTH 					       "Automated Tester Window"))          (SETQ COUNTERW (AT.MAKECOUNTERWINDOW (HEIGHTIFWINDOW (FONTPROP DEFAULTAUTOTESTFONT									 (QUOTE HEIGHT)))					       (WINDOWPROP HEADINGW (QUOTE WIDTH))					       AUTOTESTWINDOW))          (SETQ TIMEW (AT.MAKETIMEWINDOW (HEIGHTIFWINDOW (FONTPROP ATTIMEWINDOWFONT (QUOTE HEIGHT)))					 (WINDOWPROP HEADINGW (QUOTE WIDTH))					 AUTOTESTWINDOW))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE HEADINGWINDOW)			 HEADINGW)          (ATTACHWINDOW HEADINGW AUTOTESTWINDOW (QUOTE TOP))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE COUNTERWINDOW)			 COUNTERW)          (ATTACHWINDOW COUNTERW HEADINGW (QUOTE TOP))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE TIMEWINDOW)			 TIMEW)          (ATTACHWINDOW TIMEW COUNTERW (QUOTE TOP))          (SETQ COMMANDMENUWINDOW (ATTACHMENU COMMANDMENU AUTOTESTWINDOW (QUOTE TOP)))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE SCROLLFN)			 (FUNCTION AT.SCROLLFN))          (AT.MAKERIGIDWINDOW (GETPROMPTWINDOW AUTOTESTWINDOW PROMPTWHEIGHT ATPROMPTFONT))          (DSPFONT DEFAULTAUTOTESTFONT AUTOTESTWINDOW)          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE ICONFN)			 (FUNCTION AT.ICONFN))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE ICONTITLE)			 FILESPEC)          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE NUMCOMPLETED)			 0)          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE NUMSUCCESSFUL)			 0)          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE ORIGX)			 (DSPXPOSITION NIL AUTOTESTWINDOW))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE ORIGY)			 (DSPYPOSITION NIL AUTOTESTWINDOW))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE DIRWIDTH)			 (GETWINDOWPROP AUTOTESTWINDOW (QUOTE WIDTH)))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE BUTTONEVENTFN)			 (FUNCTION AT.BUTTONEVENTFN))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE RIGHTBUTTONFN)			 (FUNCTION AT.RIGHTBUTTONFN))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE REPAINTFN)			 (FUNCTION AT.REPAINTFN))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE CURSORMOVEDFN)			 (FUNCTION AT.CURSORMOVEDFN))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE CURSOROUTFN)			 (FUNCTION AT.CURSOROUTFN))          (WINDOWADDPROP AUTOTESTWINDOW (QUOTE RESHAPEFN)			 (FUNCTION RESHAPEBYREPAINTFN))          (WINDOWADDPROP AUTOTESTWINDOW (QUOTE SHRINKFN)			 (FUNCTION AT.CLOSEFN)			 T)          (WINDOWADDPROP AUTOTESTWINDOW (QUOTE CLOSEFN)			 (FUNCTION AT.CLOSEFN)			 T)          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE ITEMSPEC)			 FILESPEC)          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE HARDCOPYFN)			 (QUOTE AT.HARDCOPYFN))          (WINDOWPROP COMMANDMENUWINDOW (QUOTE HARDCOPYFN)		      (QUOTE AT.HARDCOPYFN))          (WINDOWPROP HEADINGW (QUOTE HARDCOPYFN)		      (QUOTE AT.HARDCOPYFN))          (WINDOWPROP COUNTERW (QUOTE HARDCOPYFN)		      (QUOTE AT.HARDCOPYFN))          (WINDOWPROP TIMEW (QUOTE HARDCOPYFN)		      (QUOTE AT.HARDCOPYFN))          (WINDOWPROP (GETPROMPTWINDOW AUTOTESTWINDOW)		      (QUOTE HARDCOPYFN)		      (QUOTE AT.HARDCOPYFN))          (SETQ TTYDS (WFROMDS (TTYDISPLAYSTREAM)))          (PUTWINDOWPROP AUTOTESTWINDOW (QUOTE ATDISPLAYSTREAM)			 TTYDS)          (WINDOWPROP TTYDS (QUOTE PAGEFULLFN)		      (QUOTE NILL))          (WINDOWPROP TTYDS (QUOTE AUTOTESTER)		      AUTOTESTWINDOW)          (ADD.PROCESS (LIST (FUNCTION AT.STARTUP)			     AUTOTESTWINDOW COMMANDMENU COMMANDMENUWINDOW)		       (QUOTE NAME)		       (QUOTE AT-Update))          (RETURN AUTOTESTWINDOW])(SINGLE-TEST  [LAMBDA (IDENTIFIER EXPRESSION PREDICATE TIMEOUT)          (* scv "12-Jul-85 16:22")    (PROG (MAIN PROC RESULT TESTEND)          (SETQ MAIN (WINDOWPROP (WFROMDS (TTYDISPLAYSTREAM))				 (QUOTE AUTOTESTER)))          (WINDOWPROP MAIN (QUOTE TESTRESULT)		      NIL)          (PUTWINDOWPROP MAIN (QUOTE TESTSTART)			 NIL)          (PUTWINDOWPROP MAIN (QUOTE TESTEND)			 NIL)          [SETQ PROC (ADD.PROCESS (LIST (QUOTE AT.SINGLE-TEST)					(KWOTE IDENTIFIER)					(KWOTE EXPRESSION)					(KWOTE PREDICATE)					(KWOTE TIMEOUT)					(KWOTE (TTYDISPLAYSTREAM))					(KWOTE (OUTPUT)))				  (QUOTE NAME)				  (CONCAT (QUOTE SINGLE-TEST-)					  IDENTIFIER)				  (QUOTE WINDOW)				  (WFROMDS (TTYDISPLAYSTREAM]          (WHILE (AND [NULL (SETQ RESULT (WINDOWPROP MAIN (QUOTE TESTRESULT]		      (OR (NULL TIMEOUT)			  [NULL (SETQ TESTEND (WINDOWPROP MAIN (QUOTE TESTEND]			  (LESSP (CLOCK 0)				 TESTEND))		      (PROCESSP PROC))	     DO (DISMISS 50))          (PUTWINDOWPROP MAIN (QUOTE TESTID)			 NIL)          (AT.SHOW.TESTID MAIN)          (PUTWINDOWPROP MAIN (QUOTE STARTTIME)			 NIL)          (AT.SHOW.STARTTIME MAIN)          (PUTWINDOWPROP MAIN (QUOTE ENDTIME)			 NIL)          (AT.SHOW.ENDTIME MAIN)          (IF (NULL RESULT)	      THEN (TEST-MESSAGE IDENTIFIER "timed out, timeout" TIMEOUT)		   (DEL.PROCESS PROC)		   (RETURN NIL)	    ELSE (RETURN (CAR RESULT])(TEST-MESSAGE  [LAMBDA (IDENTIFIER TEXT INFO)                             (* scv " 3-Jul-85 12:07")    (printout NIL "===> Test " IDENTIFIER ":  " TEXT ":  " INFO T]))(* * commands and major subfunctions)(DEFINEQ(AT.TESTCOMMAND  [LAMBDA (FILEENTRY KEY WINDOW STDOUT)                      (* scv "12-Jul-85 14:21")    (PROG (FILENAME NUM ITEMMAP RESULT)          (BLOCK)          (OUTPUT STDOUT)          [WINDOWPROP WINDOW (QUOTE TESTSUITE)		      (fetch (ATPRINTSPEC LABEL) of (CADR (fetch (TESTBUCKET ITEM) of FILEENTRY]          (AT.SHOW.TESTSUITE WINDOW)          (SETQ FILENAME (fetch (TESTBUCKET FILENAME) of FILEENTRY))          (SETQ NUM (fetch (TESTBUCKET #) of FILEENTRY))          (SETQ ITEMMAP (WINDOWPROP WINDOW (QUOTE AUTOTESTERITEMMAP)))          (LISPXEVAL (LIST (QUOTE LOAD)			   (LIST (QUOTE QUOTE)				 FILENAME)))          [SETQ RESULT (LISPXEVAL (LIST (FILENAMEFIELD FILENAME (QUOTE NAME))					(LIST (QUOTE QUOTE)					      (PACKFILENAME (QUOTE NAME)							    ""							    (QUOTE EXTENSION)							    ""							    (QUOTE VERSION)							    ""							    (QUOTE BODY)							    FILENAME]          (replace (TESTBUCKET COMPLETED?) of FILEENTRY with T)          [WINDOWPROP WINDOW (QUOTE NUMCOMPLETED)		      (ADD1 (WINDOWPROP WINDOW (QUOTE NUMCOMPLETED]          (replace (TESTBUCKET SUCCESSFUL?) of FILEENTRY with RESULT)          [if RESULT	      then (WINDOWPROP WINDOW (QUOTE NUMSUCCESSFUL)			       (ADD1 (WINDOWPROP WINDOW (QUOTE NUMSUCCESSFUL]          (AT.SHOW.NUMCOMPLETED WINDOW)          (AT.SHOW.NUMSUCCESSFUL WINDOW)          [replace (TESTBUCKET ITEM) of FILEENTRY with (CONS [create ATPRINTSPEC								     LABEL _(if RESULT										then (QUOTE pass)									      else (QUOTE FAIL))								     WIDTH _(fetch (ATPRINTSPEC										     WIDTH)									       of										(LISTGET										  ATINFOLISTINGWIDTHS										  (QUOTE RESULT]							     (CDR (fetch (TESTBUCKET ITEM)								     of FILEENTRY]          (SETQ ITEMMAP (for I in ITEMMAP collect (if (EQP NUM (fetch (TESTBUCKET #) of I))						      then FILEENTRY						    else I)))          (WINDOWPROP WINDOW (QUOTE AUTOTESTERITEMMAP)		      ITEMMAP)          (UNDOLISPX1 (LISPXFIND LISPXHISTORY (LIST (CADR LISPXHISTORY))				 (QUOTE ENTRY)				 NIL))          (UNDOLISPX1 (LISPXFIND LISPXHISTORY (LIST (SUB1 (CADR LISPXHISTORY)))				 (QUOTE ENTRY)				 NIL))          (REDISPLAYW WINDOW (fetch (TESTBUCKET ITEMREGION) of FILEENTRY))          (WINDOWPROP WINDOW (QUOTE TESTSUITE)		      NIL)          (AT.SHOW.TESTSUITE WINDOW)          (OUTPUT T])(AT.ABORTCOMMAND  [LAMBDA (KEY WINDOW)                                       (* scv "12-Jul-85 16:19")    (PROG (PAUSED? PAUSE)          (SETQ PAUSED? (GETWINDOWPROP WINDOW (QUOTE PAUSESTART)))          (if (NOT PAUSED?)	      then (SETQ PAUSE (CLOCK 0))		   (PUTWINDOWPROP WINDOW (QUOTE PAUSESTART)				  PAUSE))          (if (MOUSECONFIRM "Are you sure?  " 			    "Click left button to ABORT tests, right button to RESUME tests."			    (GETPROMPTWINDOW (MAINWINDOW WINDOW T)))	      then [PROG (PROC)		         (SETQ PROC (GETWINDOWPROP WINDOW (QUOTE TESTPROCESS)))		         (if PROC			     then (DEL.PROCESS PROC)				  (PUTWINDOWPROP WINDOW (QUOTE PAUSESTART)						 NIL)			   else (AT.CLRPROMPTW WINDOW)				(AT.PROMPTWPRINT WINDOW "No tests in process.")				(if (NOT PAUSED?)				    then (PUTWINDOWPROP WINDOW (QUOTE PAUSESTART)							NIL]	    else (if (NOT PAUSED?)		     then (PUTWINDOWPROP WINDOW (QUOTE PAUSESTART)					 NIL)			  (if (GETWINDOWPROP WINDOW (QUOTE TESTEND))			      then (PUTWINDOWPROP WINDOW (QUOTE ENDTIME)						  (PLUS (GETWINDOWPROP WINDOW (QUOTE ENDTIME))							(IQUOTIENT (DIFFERENCE (CLOCK 0)									       PAUSE)								   1000)))				   (AT.SHOW.ENDTIME (MAINWINDOW WINDOW T))				   (PUTWINDOWPROP WINDOW (QUOTE TESTEND)						  (PLUS (GETWINDOWPROP WINDOW (QUOTE TESTEND))							(DIFFERENCE (CLOCK 0)								    PAUSE])(AT.PAUSECOMMAND  [LAMBDA (KEY WINDOW)                                       (* scv " 2-Jul-85 15:29")    (PROG (PROC)          (SETQ PROC (GETWINDOWPROP WINDOW (QUOTE TESTPROCESS)))          (if PROC	      then (SUSPEND.PROCESS PROC)		   (PUTWINDOWPROP WINDOW (QUOTE PAUSESTART)				  (CLOCK 0))	    else (AT.CLRPROMPTW WINDOW)		 (AT.PROMPTWPRINT WINDOW "No tests in process."])(AT.RESUMECOMMAND  [LAMBDA (KEY WINDOW)                                       (* scv "12-Jul-85 16:19")    (PROG (PROC PAUSE)          (SETQ PROC (GETWINDOWPROP WINDOW (QUOTE TESTPROCESS)))          (if PROC	      then (if (SETQ PAUSE (GETWINDOWPROP WINDOW (QUOTE PAUSESTART)))		       then (PUTWINDOWPROP WINDOW (QUOTE PAUSESTART)					   NIL)			    [if (GETWINDOWPROP WINDOW (QUOTE TESTEND))				then (PUTWINDOWPROP WINDOW (QUOTE ENDTIME)						    (PLUS (GETWINDOWPROP WINDOW (QUOTE ENDTIME))							  (IQUOTIENT (DIFFERENCE (CLOCK 0)										 PAUSE)								     1000)))				     (AT.SHOW.ENDTIME (MAINWINDOW WINDOW T))				     (PUTWINDOWPROP WINDOW (QUOTE TESTEND)						    (PLUS (GETWINDOWPROP WINDOW (QUOTE TESTEND))							  (DIFFERENCE (CLOCK 0)								      PAUSE]			    (WAKE.PROCESS PROC)		     else (AT.CLRPROMPTW WINDOW)			  (AT.PROMPTWPRINT WINDOW "No tests paused."))	    else (AT.CLRPROMPTW WINDOW)		 (AT.PROMPTWPRINT WINDOW "No tests in process."])(AT.DIRECTORYCOMMAND  [LAMBDA (KEY WINDOW)                                       (* scv "20-Jun-85 12:58")    (PROG (FILESPEC)          (AT.CLRPROMPTW WINDOW)          (if (NULL (SETQ FILESPEC (AT.PROMPTFORINPUT "New test directory pattern?  "						      (GETWINDOWPROP WINDOW (QUOTE ITEMSPEC))						      WINDOW)))	      then (RETURN))          (PUTWINDOWPROP WINDOW (QUOTE ICONTITLE)			 FILESPEC)          (PUTWINDOWPROP WINDOW (QUOTE ITEMSPEC)			 (DIRECTORY.FILL.PATTERN FILESPEC (QUOTE DCOM)						 ""))          (RETURN T])(AT.PRINTCOMMAND  [LAMBDA (FILEENTRY KEY WINDOW IMAGESTREAM)                 (* scv " 2-Jul-85 10:36")    (PROG (XPOS FONTWIDTH)          (SETQ FONTWIDTH (CHARWIDTH (CHCON1 "M")				     (DSPFONT NIL IMAGESTREAM)))          (SETQ XPOS (DSPLEFTMARGIN NIL IMAGESTREAM))          (for I in (fetch (TESTBUCKET ITEM) of FILEENTRY)	     do (printout IMAGESTREAM (fetch (ATPRINTSPEC LABEL) of I))		(DSPXPOSITION (SETQ XPOS (PLUS XPOS (ITIMES (fetch (ATPRINTSPEC WIDTH) of I)							    FONTWIDTH)))			      IMAGESTREAM))          (TERPRI IMAGESTREAM])(AT.QUITCOMMAND  [LAMBDA (KEY WINDOW)                                       (* scv "31-May-85 12:49")    (CLOSEW WINDOW]))(DEFINEQ(AT.COMMANDDISPATCH  [LAMBDA (ITEM MENU KEY)                                    (* scv " 3-Jul-85 11:53")    (PROG (WINDOW ATUPDATE? FILELIST ITEMMAP NUMCOMPLETED NUMSUCCESSFUL FILE XPOS STDOUT)          (SETQ WINDOW (WINDOWPROP (WFROMMENU MENU)				   (QUOTE MAINWINDOW)))          (COND	    ((FMEMB (CADR ITEM)		    ATBUSYOKITEMS))	    ((GETWINDOWPROP WINDOW (QUOTE AUTOTESTERBUSY))	      (AT.PROMPTWPRINT WINDOW "The autotester is busy.")	      (RETURN)))          (COND	    ((EQUAL (CADR ITEM)		    (QUOTE ""))	      (RETURN)))          (SETQ ITEMMAP (WINDOWPROP WINDOW (QUOTE AUTOTESTERITEMMAP)))          (OR (FMEMB (CADR ITEM)		     ATNOARGITEMS)	      [SETQ FILELIST (for INDEX in (WINDOWPROP WINDOW (QUOTE CURRENTTESTNUMBERS))				collect (CAR (NTH ITEMMAP INDEX]	      (PROGN (AT.PROMPTWPRINT WINDOW "No tests are selected")		     (RETURN)))          (RESETLST (RESETSAVE NIL (LIST (QUOTE SHADEITEM)					 ITEM MENU ATITEMUNSELECTEDSHADE))		    [RESETSAVE NIL (LIST (FUNCTION [LAMBDA (W P)					     (PUTWINDOWPROP W (QUOTE AUTOTESTERBUSY)							    P])					 WINDOW					 (GETWINDOWPROP WINDOW (QUOTE AUTOTESTERBUSY]		    (PUTWINDOWPROP WINDOW (QUOTE AUTOTESTERBUSY)				   T)		    (SHADEITEM ITEM MENU ATITEMSELECTEDSHADE)		    [SELECTQ (CADR ITEM)			     [TEST (RESETLST (RESETSAVE NIL (LIST (QUOTE PUTWINDOWPROP)								  WINDOW								  (QUOTE TESTPROCESS)								  NIL))					     [RESETSAVE NIL (LIST (QUOTE SETTOPVAL)								  (QUOTE HELPFLAG)								  (GETTOPVAL (QUOTE HELPFLAG]					     (RESETSAVE NIL (LIST (QUOTE SET)								  (QUOTE HELPFLAG)								  HELPFLAG))					     (PUTWINDOWPROP WINDOW (QUOTE TESTPROCESS)							    (THIS.PROCESS))					     (SETTOPVAL (QUOTE HELPFLAG)							NIL)					     (SETQ HELPFLAG NIL)					     [SETQ STDOUT (if (EQ KEY (QUOTE LEFT))							      then T							    else (OPENFILE (AT.PROMPTFORINPUT 							    "Name of file to direct output to?  "											      "" 											   WINDOW)									   (QUOTE OUTPUT]					     (SETQ NUMCOMPLETED (WINDOWPROP WINDOW (QUOTE 										     NUMCOMPLETED)))					     (SETQ NUMSUCCESSFUL (WINDOWPROP WINDOW (QUOTE 										    NUMSUCCESSFUL)))					     [for FILEENTRY in ITEMMAP						do (if (AND (FMEMB (fetch (TESTBUCKET #)								      of FILEENTRY)								   (WINDOWPROP WINDOW (QUOTE 									       CURRENTTESTNUMBERS)))							    (fetch (TESTBUCKET COMPLETED?)							       of FILEENTRY))						       then (SETQ NUMCOMPLETED (SUB1 NUMCOMPLETED))							    (replace (TESTBUCKET COMPLETED?)							       of FILEENTRY with NIL)							    (if (fetch (TESTBUCKET SUCCESSFUL?)								   of FILEENTRY)								then (SETQ NUMSUCCESSFUL								       (SUB1 NUMSUCCESSFUL))								     (replace (TESTBUCKET SUCCESSFUL?)									of FILEENTRY with NIL]					     (WINDOWPROP WINDOW (QUOTE NUMCOMPLETED)							 NUMCOMPLETED)					     (WINDOWPROP WINDOW (QUOTE NUMSUCCESSFUL)							 NUMSUCCESSFUL)					     (AT.SHOW.NUMCOMPLETED WINDOW)					     (AT.SHOW.NUMSUCCESSFUL WINDOW)					     (WINDOWPROP WINDOW (QUOTE AUTOTESTERITEMMAP)							 ITEMMAP)					     (REDISPLAYW WINDOW)					     (TTYDISPLAYSTREAM (WINDOWPROP WINDOW (QUOTE 										  ATDISPLAYSTREAM)))					     (CLEARW (WINDOWPROP WINDOW (QUOTE ATDISPLAYSTREAM)))					     (for FILEENTRY in FILELIST						do (AT.TESTCOMMAND FILEENTRY KEY WINDOW STDOUT))					     (if (NEQ STDOUT T)						 then (CLOSEF STDOUT]			     (ABORT (AT.ABORTCOMMAND KEY WINDOW))			     (PAUSE (AT.PAUSECOMMAND KEY WINDOW))			     (RESUME (AT.RESUMECOMMAND KEY WINDOW))			     (DIRECTORY (SETQ ATUPDATE? (AT.DIRECTORYCOMMAND KEY WINDOW)))			     (PRINT (SETQ FILE (AT.GETPRINTDESTINATION KEY))				    (printout FILE "Testing results for " (WINDOWPROP WINDOW										      (QUOTE ITEMSPEC)										      )					      ":" T T)				    (SETQ XPOS (DSPLEFTMARGIN NIL FILE))				    (for I on ATINFOLISTINGWIDTHS by (CDDR I)				       do (printout FILE (fetch (ATPRINTSPEC LABEL)							    of (CADR I)))					  (DSPXPOSITION [SETQ XPOS							  (PLUS XPOS (ITIMES (fetch (ATPRINTSPEC										      WIDTH)										of (CADR I))									     (CHARWIDTH (CHCON1											  "M")											(DSPFONT											  NIL FILE]							FILE))				    (TERPRI FILE)				    (for FILEENTRY in FILELIST do (AT.PRINTCOMMAND FILEENTRY KEY 										   WINDOW FILE))				    (CLOSEF FILE))			     (SUMMARIZE (SETQ FILE (AT.GETPRINTDESTINATION KEY))					(printout FILE "Testing summary for " (WINDOWPROP						    WINDOW						    (QUOTE ITEMSPEC))						  ":" T T)					(SETQ XPOS (DSPLEFTMARGIN NIL FILE))					(for I on ATINFOLISTINGWIDTHS by (CDDR I)					   do (printout FILE (fetch (ATPRINTSPEC LABEL)								of (CADR I)))					      (DSPXPOSITION [SETQ XPOS							      (PLUS XPOS								    (ITIMES (fetch (ATPRINTSPEC										     WIDTH)									       of (CADR I))									    (CHARWIDTH (CHCON1 "M")										       (DSPFONT											 NIL FILE]							    FILE))					(TERPRI FILE)					(for FILEENTRY in FILELIST					   do (if (NULL (fetch (TESTBUCKET SUCCESSFUL?) of FILEENTRY))						  then (AT.PRINTCOMMAND FILEENTRY KEY WINDOW FILE)))					(CLOSEF FILE))			     (QUIT (AT.QUITCOMMAND KEY WINDOW))			     (LET ((FN (CADR ITEM)))			       (if (EQ (CAR FN)				       (QUOTE FUNCTION))				   then (APPLY* (CADR FN)						FILELIST KEY WINDOW)				 else (SHOULDNT]		    (COND		      (ATUPDATE? (AT.UPDATEAUTOTESTERITEMS (WINDOWPROP WINDOW (QUOTE ITEMSPEC))							   WINDOW])(AT.SELECT  [LAMBDA (WINDOW)                                           (* scv "22-May-85 15:32")    (PROG (AUTOTESTERITEMMAP TEST SETSEL ADDSEL EXTEND CURRENT#S TEST# FIRST# LAST#)          (OR (SETQ SETSEL (MOUSESTATE LEFT))	      (SETQ ADDSEL (LASTMOUSESTATE MIDDLE))	      (SETQ EXTEND (LASTMOUSESTATE RIGHT))	      (RETURN))          (SETQ AUTOTESTERITEMMAP (WINDOWPROP WINDOW (QUOTE AUTOTESTERITEMMAP)))          (SETQ TEST (AT.FINDTESTBUCKET WINDOW))          (COND	    ((NULL TEST)	      (RETURN)))          [COND	    (SETSEL (for TEST# in (GETWINDOWUSERPROP WINDOW (QUOTE CURRENTTESTNUMBERS))		       do (AT.UNSELECTFILE (CAR (FNTH AUTOTESTERITEMMAP TEST#))					   WINDOW))		    (AT.SELECTFILE TEST WINDOW))	    (ADDSEL (if (fetch (TESTBUCKET SELECTED?) of TEST)			then (AT.UNSELECTFILE TEST WINDOW)		      else (AT.SELECTFILE TEST WINDOW)))	    (EXTEND                                          (* have to find all the messages between TEST and the 							     one selected *)		    (COND		      ([SETQ CURRENT#S (SORT (WINDOWPROP WINDOW (QUOTE CURRENTTESTNUMBERS]			(SETQ TEST# (fetch (TESTBUCKET #) of TEST))			[COND			  [(ILESSP TEST# (CAR CURRENT#S))    (* before *)			    (SETQ FIRST# TEST#)			    (SETQ LAST# (SUB1 (CAR CURRENT#S]			  (T (SETQ LAST# TEST#)              (* after *)			     (SETQ FIRST# (ADD1 (CAR (LAST CURRENT#S]			(for I from FIRST# to LAST# do (AT.SELECTFILE (CAR (NTH AUTOTESTERITEMMAP I))								      WINDOW]          (AT.SHOW.NUMSELECTED WINDOW])(AT.UPDATEAUTOTESTERITEMS  [LAMBDA (ITEMSPEC WINDOW)                                  (* scv "12-Jul-85 14:07")    (PROG ((INFOWANTED (QUOTE (RESULT NAME FILE)))	   HEADINGWINDOW FILEGENERATOR FILENAME FILEINFO MAXWIDTH AUTOTESTERITEMMAP)          [SETQ FILEGENERATOR (\GENERATEFILES ITEMSPEC (QUOTE (NAME))					      (QUOTE (SORT RESETLST]          (SETQ HEADINGWINDOW (GETWINDOWPROP WINDOW (QUOTE HEADINGWINDOW)))          (WINDOWPROP HEADINGWINDOW (QUOTE TITLE)		      "Auto Tester")          (CLEARW (WINDOWPROP WINDOW (QUOTE COUNTERWINDOW)))          (PUTWINDOWPROP WINDOW (QUOTE EXTENT)			 NIL)                                (* set EXTENT to NIL while updating)          (PUTWINDOWPROP WINDOW (QUOTE INFOGOTTEN)			 INFOWANTED)          (PUTWINDOWPROP WINDOW (QUOTE DIRWIDTH)			 (SETQ MAXWIDTH (AT.PRINTHEADINGSON HEADINGWINDOW INFOWANTED)))          (DSPRIGHTMARGIN 32767 WINDOW)          (CLEARW WINDOW)          [SETQ AUTOTESTERITEMMAP (while (SETQ FILENAME (\GENERATENEXTFILE FILEGENERATOR))				     as ITEMCOUNT from 1 bind ITEM bind STARTOFNAME				     collect (if (LISTP FILENAME)						 then (SETQ FILENAME (CONCATCODES FILENAME)))					     (SETQ FILEINFO (AT.GETALLFILEINFO FILENAME FILEGENERATOR 									       INFOWANTED))					     (create TESTBUCKET						     FILENAME _ FILENAME						     # _ ITEMCOUNT						     ITEM _[SETQ ITEM						       (AT.CREATEPRINTSPEC FILEINFO INFOWANTED									   (OR STARTOFNAME									       (SETQ STARTOFNAME										 (AT.STARTOFNAME										   FILENAME ITEMSPEC]						     ITEMREGION _(AT.PRINTANDGETREGION ITEM WINDOW 										      AT.MARKXPOS 10)						     SELECTED? _ NIL						     COMPLETED? _ NIL						     SUCCESSFUL? _(QUOTE ?]          (PUTWINDOWPROP WINDOW (QUOTE AUTOTESTERITEMMAP)			 AUTOTESTERITEMMAP)          (PUTWINDOWPROP WINDOW (QUOTE EXTENT)			 (if AUTOTESTERITEMMAP			     then [create REGION					  LEFT _ 0					  BOTTOM _[fetch (REGION BOTTOM)						     of (fetch (TESTBUCKET ITEMREGION)							   of (CAR (LAST AUTOTESTERITEMMAP]					  WIDTH _ MAXWIDTH					  HEIGHT _(IDIFFERENCE (fetch (REGION PTOP)								  of (fetch (TESTBUCKET ITEMREGION)									of (CAR AUTOTESTERITEMMAP)))							       (fetch (REGION BOTTOM)								  of (fetch (TESTBUCKET ITEMREGION)									of (CAR (LAST 										AUTOTESTERITEMMAP]			   else (AT.CLRPROMPTW WINDOW)				(AT.PROMPTWPRINT WINDOW "No files in group " ITEMSPEC)				NIL))          (PUTWINDOWPROP HEADINGWINDOW (QUOTE TITLE)			 (CONCAT (WINDOWPROP WINDOW (QUOTE ITEMSPEC))				 " tester"))          (PUTWINDOWPROP WINDOW (QUOTE CURRENTTESTNUMBERS)			 NIL)          (PUTWINDOWPROP WINDOW (QUOTE CURRENTITEM)			 NIL)          (PUTWINDOWPROP WINDOW (QUOTE NUMCOMPLETED)			 0)          (PUTWINDOWPROP WINDOW (QUOTE NUMSUCCESSFUL)			 0)          (AT.SHOW.NUMFILES WINDOW)          (AT.SHOW.NUMSELECTED WINDOW)          (AT.SHOW.NUMCOMPLETED WINDOW)          (AT.SHOW.NUMSUCCESSFUL WINDOW)          (AT.SHOW.TESTSUITE WINDOW)          (AT.SHOW.TESTID WINDOW)          (AT.SHOW.STARTTIME WINDOW)          (AT.SHOW.ENDTIME WINDOW])(AT.SINGLE-TEST  [LAMBDA (IDENTIFIER EXPRESSION PREDICATE TIMEOUT TTYDS STDOUT)                                                             (* scv "12-Jul-85 16:08")    (PROG (RESULT MAIN START)          (TTYDISPLAYSTREAM TTYDS)          (OUTPUT STDOUT)          (SETQ MAIN (WINDOWPROP (WFROMDS TTYDS)				 (QUOTE AUTOTESTER)))          (PUTWINDOWPROP MAIN (QUOTE TESTID)			 IDENTIFIER)          (AT.SHOW.TESTID MAIN)          (PUTWINDOWPROP MAIN (QUOTE STARTTIME)			 (IDATE))          (AT.SHOW.STARTTIME MAIN)          (IF TIMEOUT	      THEN                                           (* The following assumes that the date format used by 							     IDATE and GDATE is in seconds.)		   (PUTWINDOWPROP MAIN (QUOTE ENDTIME)				  (PLUS (IDATE)					(QUOTIENT TIMEOUT 1000)))		   (AT.SHOW.ENDTIME MAIN))          (BLOCK)          (SETQ START (CLOCK 0))          (PUTWINDOWPROP MAIN (QUOTE TESTSTART)			 START)          (PUTWINDOWPROP MAIN (QUOTE TESTEND)			 (if TIMEOUT			     then (PLUS START TIMEOUT)			   else -1))          (SETQ RESULT (ERRORSET EXPRESSION T))          (PUTWINDOWPROP MAIN (QUOTE TESTSTART)			 NIL)          (PUTWINDOWPROP MAIN (QUOTE TESTEND)			 NIL)          (BLOCK)          (if (NULL RESULT)	      then (TEST-MESSAGE IDENTIFIER "got an error in expression" EXPRESSION)		   (PUTWINDOWPROP MAIN (QUOTE TESTRESULT)				  (QUOTE (NIL)))	    elseif (EQ (CAR RESULT)		       (QUOTE NOBIND))	      then (TEST-MESSAGE IDENTIFIER "returned NOBIND in expression" EXPRESSION)		   (PUTWINDOWPROP MAIN (QUOTE TESTRESULT)				  (QUOTE (NIL)))	    else [SETQ RESULT (ERSETQ (APPLY* PREDICATE (CAR RESULT]		 (BLOCK)		 (if (NULL RESULT)		     then (TEST-MESSAGE IDENTIFIER "got an error in predicate" PREDICATE)			  (PUTWINDOWPROP MAIN (QUOTE TESTRESULT)					 (QUOTE (NIL)))		   elseif (EQ (CAR RESULT)			      (QUOTE NOBIND))		     then (TEST-MESSAGE IDENTIFIER "returned NOBIND in predicate" PREDICATE)			  (PUTWINDOWPROP MAIN (QUOTE TESTRESULT)					 (QUOTE (NIL)))		   else (PUTWINDOWPROP MAIN (QUOTE TESTRESULT)				       RESULT]))(* * lower-level window mungers)(DEFINEQ(AT.MAKERIGIDWINDOW  [LAMBDA (WINDOW)                                           (* lmm "14-Sep-84 16:22")          (* * make the argument window immutable w/r/to attachedwindow package)    (PROG [(HEIGHT (fetch (REGION HEIGHT) of (GETWINDOWPROP WINDOW (QUOTE REGION]          (PUTWINDOWPROP WINDOW (QUOTE MINSIZE)			 (CONS 0 HEIGHT))          (PUTWINDOWPROP WINDOW (QUOTE MAXSIZE)			 (CONS SCREENWIDTH HEIGHT])(AT.CLRPROMPTW  [LAMBDA (MAINWINDOW)                                       (* Jellinek " 6-May-84 16:48")    (CLEARW (CAR (GETWINDOWPROP MAINWINDOW (QUOTE PROMPTWINDOW])(AT.PRINTHEADINGSON  [LAMBDA (WINDOW HEADINGS)                                  (* scv " 1-Jul-85 10:35")    (PROG ((totalwidth 0)	   BOTTOM)          (DSPRIGHTMARGIN 32000 WINDOW)          (DSPTEXTURE BLACKSHADE WINDOW)          (DSPOPERATION (QUOTE INVERT)			WINDOW)          (DSPFILL NIL BLACKSHADE (QUOTE REPLACE)		   WINDOW)          (for HEADING in ATINFOLISTINGWIDTHS by (CDDR HEADING) bind word width (pos _ AT.MARKXPOS)	     when (FMEMB HEADING HEADINGS)	     do (SETQ word (fetch (ATPRINTSPEC LABEL) of (LISTGET ATINFOLISTINGWIDTHS HEADING)))		(SETQ width (ITIMES (fetch (ATPRINTSPEC WIDTH) of (LISTGET ATINFOLISTINGWIDTHS 									   HEADING))				    (CHARWIDTH (CHCON1 "M")					       DEFAULTAUTOTESTFONT)))		(SETQ totalwidth (IPLUS totalwidth width))		(DSPXPOSITION pos WINDOW)		(PRIN3 word WINDOW)		(add pos width))          (PUTWINDOWPROP WINDOW (QUOTE EXTENT)			 (create REGION				 LEFT _ 0				 BOTTOM _[SETQ BOTTOM (IPLUS (DSPYPOSITION NIL WINDOW)							     (FONTPROP WINDOW (QUOTE ASCENT]				 WIDTH _ totalwidth				 HEIGHT _(IDIFFERENCE (GETWINDOWPROP WINDOW (QUOTE HEIGHT))						      BOTTOM)))          (RETURN totalwidth])(AT.PRINTANDGETREGION  [LAMBDA (PRINTSPEC STREAM LFTMARGIN MINSPACE)              (* scv " 1-Jul-85 11:29")                                                             (* prints PRINTSPEC on WINDOW and returns the box taken							     by the characters.)    (PROG (YSTART YEND HEIGHT)          (DSPXPOSITION LFTMARGIN STREAM)          (SETQ YSTART (DSPYPOSITION NIL STREAM))          (for SPEC in PRINTSPEC bind OLDX PRETTYWIDTH	     do (SETQ OLDX (DSPXPOSITION NIL STREAM))		[SETQ PRETTYWIDTH (ITIMES (fetch (ATPRINTSPEC WIDTH) of SPEC)					  (CHARWIDTH (CHCON1 "M")						     (DSPFONT NIL STREAM]		(COND		  ((fetch (ATPRINTSPEC LABEL) of SPEC)		    (PRIN3 (fetch (ATPRINTSPEC LABEL) of SPEC)			   STREAM)		    (PRIN3 " " STREAM)))                     (* If any single item won't fit, skip a line and 							     continue)		(if (IGEQ (IDIFFERENCE (DSPXPOSITION NIL STREAM)				       OLDX)			  PRETTYWIDTH)		    then (TERPRI STREAM))		(DSPXPOSITION (IPLUS OLDX PRETTYWIDTH)			      STREAM))          (SETQ YEND (DSPYPOSITION NIL STREAM))          (RETURN (PROG1 (create REGION				 LEFT _ LFTMARGIN				 BOTTOM _(IDIFFERENCE YEND (FONTPROP STREAM (QUOTE DESCENT)))				 HEIGHT _(IPLUS (IDIFFERENCE YSTART YEND)						(FONTPROP STREAM (QUOTE HEIGHT)))				 WIDTH _(IDIFFERENCE (DSPXPOSITION NIL STREAM)						     LFTMARGIN))			 (TERPRI STREAM])(AT.MAKEHEADINGWINDOW  [LAMBDA (WIDTH FONT BORDER TITLE)                          (* scv "23-May-85 11:56")    (PROG (PWINDOW)          (SETQ PWINDOW (CREATEW (create REGION					 LEFT _ 0					 BOTTOM _ 0					 WIDTH _ WIDTH					 HEIGHT _(HEIGHTIFWINDOW (FONTPROP FONT (QUOTE HEIGHT))								 TITLE BORDER))				 TITLE BORDER T))          (DSPFONT FONT PWINDOW)          (PUTWINDOWPROP PWINDOW (QUOTE PAGEFULLFN)			 (FUNCTION NILL))          (PUTWINDOWPROP PWINDOW (QUOTE NOSCROLLBARS)			 T)          (PUTWINDOWPROP PWINDOW (QUOTE SCROLLFN)			 (FUNCTION SCROLLBYREPAINTFN))          (PUTWINDOWPROP PWINDOW (QUOTE REPAINTFN)			 (FUNCTION AT.HEADINGWREDISPLAYFN))          (AT.MAKERIGIDWINDOW PWINDOW)          (RETURN PWINDOW])(AT.MAKECOUNTERWINDOW  [LAMBDA (HEIGHT WIDTH AUTOTESTW)                           (* scv "30-May-85 16:59")    (LET ((COUNTERW (CREATEW (create REGION				     LEFT _ 0				     BOTTOM _ 0				     HEIGHT _(HEIGHTIFWINDOW (FONTPROP DEFAULTAUTOTESTFONT								       (QUOTE HEIGHT)))				     WIDTH _(WINDOWPROP AUTOTESTW (QUOTE WIDTH)))			     NIL NIL T)))      (AT.MAKERIGIDWINDOW COUNTERW)      (WINDOWPROP COUNTERW (QUOTE AUTOTESTERWINDOW)		  AUTOTESTW)      (WINDOWPROP COUNTERW (QUOTE REPAINTFN)		  (FUNCTION AT.REPAINT.COUNTERW))      COUNTERW])(AT.MAKETIMEWINDOW  [LAMBDA (HEIGHT WIDTH AUTOTESTW)                           (* scv "15-Jul-85 15:36")    (LET ((TIMEW (CREATEW (create REGION				  LEFT _ 0				  BOTTOM _ 0				  HEIGHT _(HEIGHTIFWINDOW (FONTPROP ATTIMEWINDOWFONT (QUOTE HEIGHT)))				  WIDTH _(WINDOWPROP AUTOTESTW (QUOTE WIDTH)))			  NIL NIL T)))      (AT.MAKERIGIDWINDOW TIMEW)      (WINDOWPROP TIMEW (QUOTE AUTOTESTERWINDOW)		  AUTOTESTW)      (WINDOWPROP TIMEW (QUOTE REPAINTFN)		  (FUNCTION AT.REPAINT.TIMEW))      (DSPFONT ATTIMEWINDOWFONT TIMEW)      TIMEW])(AT.PROMPTWPRINT  [LAMBDA U                                                  (* Jellinek " 6-May-84 16:37")    (PROG (WINDOW)          (COND	    ((ILESSP U 2)	      (ERROR "not enough args to PROMPTWPRINT")))    (* CAR is window, CDR is height in lines)          [SETQ WINDOW (CAR (GETWINDOWPROP (ARG U 1)					   (QUOTE PROMPTWINDOW]          (for ITEM from 2 to U do (PRIN1 (ARG U ITEM)					  WINDOW])(AT.PROMPTWTERPRI  [LAMBDA (MAINWINDOW)                                       (* Jellinek " 6-May-84 16:37")                                                             (* CAR is prompt window, CDR is height in lines)    (TERPRI (CAR (GETWINDOWPROP MAINWINDOW (QUOTE PROMPTWINDOW])(AT.SELECTFILE  [LAMBDA (FOLDER WINDOW)                                    (* scv "23-May-85 12:10")    (COND      (FOLDER (replace (TESTBUCKET SELECTED?) of FOLDER with T)	      (WINDOWADDPROP WINDOW (QUOTE CURRENTTESTNUMBERS)			     (fetch (TESTBUCKET #) of FOLDER))	      [WINDOWPROP WINDOW (QUOTE CURRENTTESTNUMBERS)			  (SORT (WINDOWPROP WINDOW (QUOTE CURRENTTESTNUMBERS]	      (\ITEMW.SELECTITEM (LIST (fetch (TESTBUCKET ITEMREGION) of FOLDER))				 WINDOW])(AT.UNSELECTFILE  [LAMBDA (MSG WINDOW)                                       (* scv "28-May-85 12:53")    (COND      (MSG (replace (TESTBUCKET SELECTED?) of MSG with NIL)	   [WINDOWPROP WINDOW (QUOTE CURRENTTESTNUMBERS)		       (REMOVE (fetch (TESTBUCKET #) of MSG)			       (WINDOWPROP WINDOW (QUOTE CURRENTTESTNUMBERS]	   (\ITEMW.DESELECTITEM (LIST (fetch ITEMREGION of MSG))				WINDOW])(AT.CHANGECOMPLETEMARK  [LAMBDA (TEST WINDOW)                                      (* scv "28-May-85 12:37")    (PROG ((TESTREGION (fetch ITEMREGION of TEST)))          (BITBLT NIL 0 0 WINDOW (fetch (REGION LEFT) of TESTREGION)		  (IDIFFERENCE (fetch (REGION PTOP) of TESTREGION)			       (IQUOTIENT (FONTPROP WINDOW (QUOTE HEIGHT))					  2))		  (fetch (REGION WIDTH) of TESTREGION)		  1		  (QUOTE TEXTURE)		  (QUOTE INVERT)		  BLACKSHADE])(AT.SHOW.NUMCOMPLETED  [LAMBDA (AUTOTESTERW)                                      (* scv "20-Jun-85 09:30")    (LET ((COUNTERW (WINDOWPROP AUTOTESTERW (QUOTE COUNTERWINDOW)))       (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))					 4)			      2))       (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))				       4)			    3)))      (LET [(PRINTINGREGION (create REGION				    LEFT _ STARTPOSITION				    WIDTH _(IDIFFERENCE ENDPOSITION STARTPOSITION)				    BOTTOM _ 0				    HEIGHT _(WINDOWPROP COUNTERW (QUOTE HEIGHT]	(DSPFILL PRINTINGREGION WHITESHADE (QUOTE REPLACE)		 COUNTERW)	(DSPXPOSITION STARTPOSITION COUNTERW)	(PRIN3 "Completed:" COUNTERW)	(CENTERPRINTINREGION (WINDOWPROP AUTOTESTERW (QUOTE NUMCOMPLETED))			     PRINTINGREGION COUNTERW])(AT.SHOW.NUMFILES  [LAMBDA (AUTOTESTERW)                                      (* scv "20-Jun-85 09:28")    (LET ((COUNTERW (WINDOWPROP AUTOTESTERW (QUOTE COUNTERWINDOW)))       (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))					 4)			      0))       (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))				       4)			    1)))      (LET [(PRINTINGREGION (create REGION				    LEFT _ STARTPOSITION				    WIDTH _(IDIFFERENCE ENDPOSITION STARTPOSITION)				    BOTTOM _ 0				    HEIGHT _(WINDOWPROP COUNTERW (QUOTE HEIGHT]	(DSPFILL PRINTINGREGION WHITESHADE (QUOTE REPLACE)		 COUNTERW)	(DSPXPOSITION STARTPOSITION COUNTERW)	(PRIN3 "Files:" COUNTERW)	(CENTERPRINTINREGION (LENGTH (WINDOWPROP AUTOTESTERW (QUOTE AUTOTESTERITEMMAP)))			     PRINTINGREGION COUNTERW])(AT.SHOW.NUMSELECTED  [LAMBDA (AUTOTESTERW)                                      (* scv "20-Jun-85 09:35")    (LET ((COUNTERW (WINDOWPROP AUTOTESTERW (QUOTE COUNTERWINDOW)))       (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))					 4)			      1))       (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))				       4)			    2)))      (LET [(PRINTINGREGION (create REGION				    LEFT _ STARTPOSITION				    WIDTH _(IDIFFERENCE ENDPOSITION STARTPOSITION)				    BOTTOM _ 0				    HEIGHT _(WINDOWPROP COUNTERW (QUOTE HEIGHT]	(DSPFILL PRINTINGREGION WHITESHADE (QUOTE REPLACE)		 COUNTERW)	(DSPXPOSITION STARTPOSITION COUNTERW)	(PRIN3 "Selected:" COUNTERW)	(CENTERPRINTINREGION (LENGTH (WINDOWPROP AUTOTESTERW (QUOTE CURRENTTESTNUMBERS)))			     PRINTINGREGION COUNTERW])(AT.SHOW.NUMSUCCESSFUL  [LAMBDA (AUTOTESTERW)                                      (* scv "20-Jun-85 09:30")    (LET ((COUNTERW (WINDOWPROP AUTOTESTERW (QUOTE COUNTERWINDOW)))       (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))					 4)			      3))       (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))				       4)			    4)))      (LET [(PRINTINGREGION (create REGION				    LEFT _ STARTPOSITION				    WIDTH _(IDIFFERENCE ENDPOSITION STARTPOSITION)				    BOTTOM _ 0				    HEIGHT _(WINDOWPROP COUNTERW (QUOTE HEIGHT]	(DSPFILL PRINTINGREGION WHITESHADE (QUOTE REPLACE)		 COUNTERW)	(DSPXPOSITION STARTPOSITION COUNTERW)	(PRIN3 "Successful:" COUNTERW)	(CENTERPRINTINREGION (WINDOWPROP AUTOTESTERW (QUOTE NUMSUCCESSFUL))			     PRINTINGREGION COUNTERW])(AT.SHOW.ENDTIME  [LAMBDA (AUTOTESTERW)                                      (* scv "12-Jul-85 16:01")    (LET ((TIMEW (WINDOWPROP AUTOTESTERW (QUOTE TIMEWINDOW)))       (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))					 4)			      3))       (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))				       4)			    4)))      (LET [(PRINTINGREGION (create REGION				    LEFT _ STARTPOSITION				    WIDTH _(IDIFFERENCE ENDPOSITION STARTPOSITION)				    BOTTOM _ 0				    HEIGHT _(WINDOWPROP TIMEW (QUOTE HEIGHT]	(DSPFILL PRINTINGREGION WHITESHADE (QUOTE REPLACE)		 TIMEW)	(DSPXPOSITION STARTPOSITION TIMEW)	(PRIN3 "End:" TIMEW)	(IF (WINDOWPROP AUTOTESTERW (QUOTE ENDTIME))	    THEN (CENTERPRINTINREGION (GDATE (WINDOWPROP AUTOTESTERW (QUOTE ENDTIME)))				      PRINTINGREGION TIMEW])(AT.SHOW.STARTTIME  [LAMBDA (AUTOTESTERW)                                      (* scv "15-Jul-85 15:43")    (LET ((TIMEW (WINDOWPROP AUTOTESTERW (QUOTE TIMEWINDOW)))       (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))					 4)			      2))       (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))				       4)			    3)))      (LET [(PRINTINGREGION (create REGION				    LEFT _ STARTPOSITION				    WIDTH _(IDIFFERENCE ENDPOSITION STARTPOSITION)				    BOTTOM _ 0				    HEIGHT _(WINDOWPROP TIMEW (QUOTE HEIGHT]	(DSPFILL PRINTINGREGION WHITESHADE (QUOTE REPLACE)		 TIMEW)	(DSPXPOSITION STARTPOSITION TIMEW)	(PRIN3 "Start:" TIMEW)	(IF (WINDOWPROP AUTOTESTERW (QUOTE STARTTIME))	    THEN (CENTERPRINTINREGION (GDATE (WINDOWPROP AUTOTESTERW (QUOTE STARTTIME)))				      PRINTINGREGION TIMEW])(AT.SHOW.TESTID  [LAMBDA (AUTOTESTERW)                                      (* scv "12-Jul-85 13:49")    (LET ((TIMEW (WINDOWPROP AUTOTESTERW (QUOTE TIMEWINDOW)))       (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))					 4)			      1))       (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))				       4)			    2)))      (LET [(PRINTINGREGION (create REGION				    LEFT _ STARTPOSITION				    WIDTH _(IDIFFERENCE ENDPOSITION STARTPOSITION)				    BOTTOM _ 0				    HEIGHT _(WINDOWPROP TIMEW (QUOTE HEIGHT]	(DSPFILL PRINTINGREGION WHITESHADE (QUOTE REPLACE)		 TIMEW)	(DSPXPOSITION STARTPOSITION TIMEW)	(PRIN3 "ID:" TIMEW)	(IF (WINDOWPROP AUTOTESTERW (QUOTE TESTID))	    THEN (CENTERPRINTINREGION (WINDOWPROP AUTOTESTERW (QUOTE TESTID))				      PRINTINGREGION TIMEW])(AT.SHOW.TESTSUITE  [LAMBDA (AUTOTESTERW)                                      (* scv "12-Jul-85 13:47")    (LET ((TIMEW (WINDOWPROP AUTOTESTERW (QUOTE TIMEWINDOW)))       (STARTPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))					 4)			      0))       (ENDPOSITION (ITIMES (IQUOTIENT (WINDOWPROP AUTOTESTERW (QUOTE WIDTH))				       4)			    1)))      (LET [(PRINTINGREGION (create REGION				    LEFT _ STARTPOSITION				    WIDTH _(IDIFFERENCE ENDPOSITION STARTPOSITION)				    BOTTOM _ 0				    HEIGHT _(WINDOWPROP TIMEW (QUOTE HEIGHT]	(DSPFILL PRINTINGREGION WHITESHADE (QUOTE REPLACE)		 TIMEW)	(DSPXPOSITION STARTPOSITION TIMEW)	(PRIN3 "Suite:" TIMEW)	(IF (WINDOWPROP AUTOTESTERW (QUOTE TESTSUITE))	    THEN (CENTERPRINTINREGION (WINDOWPROP AUTOTESTERW (QUOTE TESTSUITE))				      PRINTINGREGION TIMEW]))(* * window functions)(DEFINEQ(AT.HEADINGWREDISPLAYFN  [LAMBDA (WINDOW)                                           (* scv "24-May-85 17:06")    (AT.PRINTHEADINGSON WINDOW (GETWINDOWPROP (GETWINDOWPROP WINDOW (QUOTE MAINWINDOW))					      (QUOTE INFOGOTTEN])(AT.REPAINT.COUNTERW  [LAMBDA (COUNTERWINDOW)                                    (* scv "29-May-85 14:12")    (LET [(AUTOTESTERW (WINDOWPROP COUNTERWINDOW (QUOTE AUTOTESTERWINDOW]      (DSPFILL NIL WHITESHADE (QUOTE REPLACE)	       COUNTERWINDOW)      (AT.SHOW.NUMFILES AUTOTESTERW)      (AT.SHOW.NUMSELECTED AUTOTESTERW)      (AT.SHOW.NUMCOMPLETED AUTOTESTERW)      (AT.SHOW.NUMSUCCESSFUL AUTOTESTERW])(AT.REPAINT.TIMEW  [LAMBDA (TIMEWINDOW)                                       (* scv "12-Jul-85 13:16")    (LET [(AUTOTESTERW (WINDOWPROP TIMEWINDOW (QUOTE AUTOTESTERWINDOW]      (DSPFILL NIL WHITESHADE (QUOTE REPLACE)	       TIMEWINDOW)      (AT.SHOW.TESTSUITE AUTOTESTERW)      (AT.SHOW.TESTID AUTOTESTERW)      (AT.SHOW.STARTTIME AUTOTESTERW)      (AT.SHOW.ENDTIME AUTOTESTERW])(AT.ICONFN  [LAMBDA (W I)                                              (* scv " 3-Jun-85 14:41")    (PROG (OLDICONREGION)          [SETQ OLDICONREGION (AND I (GETWINDOWPROP I (QUOTE REGION]          (RETURN (TITLEDICONW (create TITLEDICON				       ICON _ ATICON				       MASK _ ATICONMASK				       TITLEREG _(create REGION							 LEFT _ 5							 WIDTH _ 70							 BOTTOM _ 45							 HEIGHT _ 75))			       (GETWINDOWPROP W (QUOTE ITEMSPEC))			       ATICONFONT			       (AND I (create POSITION					      XCOORD _(fetch (REGION LEFT) of OLDICONREGION)					      YCOORD _(fetch (REGION BOTTOM) of OLDICONREGION)))			       NIL			       (QUOTE TOP])(AT.BUTTONEVENTFN  [LAMBDA (WINDOW)                                           (* scv "30-May-85 09:23")    (AT.SELECT WINDOW])(AT.CURSORMOVEDFN  [LAMBDA (WINDOW)                                           (* scv "29-May-85 09:49")    (if (IGEQ AT.MARKXPOS (fetch XCOORD of (CURSORPOSITION NIL WINDOW)))	then (SETCURSOR AT.RIGHTARROWCURSOR)      else (if (NEQ (CURSOR)		    DEFAULTCURSOR)	       then (SETCURSOR DEFAULTCURSOR])(AT.CURSOROUTFN  [LAMBDA (WINDOW)                                           (* rao: "30-JUN-82 15:49")    (SETCURSOR DEFAULTCURSOR])(AT.REPAINTFN  [LAMBDA (WINDOW R)                                         (* scv "29-May-85 09:45")    (PROG ((AUTOTESTERITEMMAP (GETWINDOWPROP WINDOW (QUOTE AUTOTESTERITEMMAP)))	   (HEADINGWINDOW (GETWINDOWPROP WINDOW (QUOTE HEADINGWINDOW)))	   (TOP (fetch (REGION TOP) of R))	   [BOTTOM (IDIFFERENCE (fetch (REGION BOTTOM) of R)				(FONTPROP WINDOW (QUOTE ASCENT]	   YPOS ITEMSPEC DIRWIDTH STARTOFNAME ATTRS)          (COND	    ((NULL AUTOTESTERITEMMAP)	      (RETURN)))          (for FILE in AUTOTESTERITEMMAP bind REGION	     do (if (AND [IGREATERP TOP (SETQ YPOS (fetch (REGION BOTTOM)						      of (SETQ REGION (fetch (TESTBUCKET ITEMREGION)									 of FILE]			 (ILESSP BOTTOM (fetch (REGION TOP) of REGION)))		    then (DSPYPOSITION (IDIFFERENCE (IPLUS (fetch (REGION BOTTOM) of REGION)							   (fetch (REGION HEIGHT) of REGION))						    (FONTPROP WINDOW (QUOTE ASCENT)))				       WINDOW)			 (OR (EQUAL (AT.PRINTANDGETREGION (fetch (TESTBUCKET ITEM) of FILE)							  WINDOW AT.MARKXPOS 10)				    REGION)			     T			     (HELP))			 (if (fetch (TESTBUCKET SELECTED?) of FILE)			     then (\ITEMW.SELECTITEM (LIST (fetch ITEMREGION of FILE))						     WINDOW))			 (if (fetch (TESTBUCKET COMPLETED?) of FILE)			     then (AT.CHANGECOMPLETEMARK FILE WINDOW)))	     repeatwhile (ILESSP BOTTOM YPOS])(AT.SCROLLFN  [LAMBDA (WINDOW HORIZ VERT CONTINUOUS?)                    (* scv "28-May-85 12:45")          (* * Scroll AT window up/down and right/left. In right/left case, tell heading window to scroll also)          (* * only scroll an integral number of text lines)    (if (GETWINDOWPROP WINDOW (QUOTE AUTOTESTERBUSY))	then (AT.CLRPROMPTW WINDOW)	     (AT.PROMPTWPRINT WINDOW "The autotester is busy.")      else (COND	     ((NOT (ZEROP HORIZ))	       (SCROLLW (GETWINDOWPROP WINDOW (QUOTE HEADINGWINDOW))			HORIZ VERT CONTINUOUS?)))	   (SCROLLBYREPAINTFN WINDOW HORIZ VERT CONTINUOUS?])(AT.RIGHTBUTTONFN  [LAMBDA (WINDOW)                                           (* scv "29-May-85 09:45")    (COND      ((IGREATERP (LASTMOUSEX WINDOW)		  AT.MARKXPOS)	(DOWINDOWCOM WINDOW))      (T (AT.SELECT WINDOW])(AT.MENU.WHENSELECTEDFN  [LAMBDA (Item Menu Key)                                    (* scv "28-May-85 11:03")    (ADD.PROCESS (LIST (FUNCTION AT.COMMANDDISPATCH)		       (KWOTE Item)		       (KWOTE Menu)		       (KWOTE Key))		 (QUOTE NAME)		 (PACK (LIST (QUOTE AT-)			     (CAR Item])(AT.CLOSEFN  [LAMBDA (WINDOW)                                           (* scv " 2-Jul-85 13:55")                                                             (* did you really want to close up shop?)          (* * do the right thing; if we are really closing, smash pointers which can cause circularities, so everything gets 	  collected)    (PROG (PROC)          (SETQ PROC (GETWINDOWPROP WINDOW (QUOTE TESTPROCESS)))          (RETURN (COND		    (PROC (SUSPEND.PROCESS PROC)			  (if (MOUSECONFIRM "Tests in progress:  " 				"Click left button to ABORT tests, right button to RESUME tests."					    (GETPROMPTWINDOW (MAINWINDOW WINDOW T)))			      then (DEL.PROCESS PROC)				   (PUTWINDOWPROP (GETWINDOWPROP WINDOW (QUOTE COUNTERWINDOW))						  (QUOTE AUTOTESTERWINDOW)						  NIL)				   (PUTWINDOWPROP WINDOW (QUOTE ATDISPLAYSTREAM)						  NIL)			    else (WAKE.PROCESS PROC)				 (QUOTE DON'T)))		    (T (PUTWINDOWPROP (GETWINDOWPROP WINDOW (QUOTE COUNTERWINDOW))				      (QUOTE AUTOTESTERWINDOW)				      NIL)		       (PUTWINDOWPROP WINDOW (QUOTE ATDISPLAYSTREAM)				      NIL])(AT.HARDCOPYFN  [LAMBDA (WINDOW IMAGESTREAM)                               (* scv " 1-Jul-85 14:15")    (SETQ WINDOW (MAINWINDOW WINDOW T))    (PROG (XPOS FONTWIDTH)          (printout IMAGESTREAM "Testing results for " (GETWINDOWPROP WINDOW (QUOTE ITEMSPEC))		    ":" T T)          (SETQ FONTWIDTH (CHARWIDTH (CHCON1 "M")				     (DSPFONT NIL IMAGESTREAM)))          (SETQ XPOS (DSPLEFTMARGIN NIL IMAGESTREAM))          (for I on ATINFOLISTINGWIDTHS by (CDDR I)	     do (printout IMAGESTREAM (fetch (ATPRINTSPEC LABEL) of (CADR I)))		(DSPXPOSITION (SETQ XPOS (PLUS XPOS (ITIMES (fetch (ATPRINTSPEC WIDTH)							       of (CADR I))							    FONTWIDTH)))			      IMAGESTREAM))          (TERPRI IMAGESTREAM)          (for FILEENTRY in (for INDEX in (GETWINDOWPROP WINDOW (QUOTE CURRENTTESTNUMBERS))			       collect (CAR (NTH (GETWINDOWPROP WINDOW (QUOTE AUTOTESTERITEMMAP))						 INDEX)))	     do (AT.PRINTCOMMAND FILEENTRY (QUOTE RIGHT)				 WINDOW IMAGESTREAM]))(* * odds and ends)(DEFINEQ(AT.FETCHFILENAME  [LAMBDA (ENTRY)                                            (* scv "24-May-85 16:45")    (fetch (TESTBUCKET FILENAME) of ENTRY])(AT.STARTOFNAME  [LAMBDA (FILENAME SPEC)                                    (* lmm "14-Sep-84 17:59")                                                             (* assume that hosts match)    [SETQ SPEC (SUBSTRING SPEC (ADD1 (OR (LASTCHPOS (CHARCODE })						    SPEC)					 0]    (bind (DIRSTART _(ADD1 (OR (LASTCHPOS (CHARCODE })					  FILENAME)			       0)))	  DIREND first (SETQ FILENAME (SUBSTRING FILENAME DIRSTART)) while (SETQ DIREND									     (LASTCHPOS (CHARCODE											  >)											SPEC))       do (SETQ SPEC (SUBSTRING SPEC 1 DIREND SPEC))	  [if (STRPOS SPEC FILENAME 1 NIL T NIL (UPPERCASEARRAY))	      then (RETURN (IPLUS DIRSTART (NCHARS SPEC]	  (SETQ SPEC (SUBSTRING SPEC 1 -2 SPEC))       finally (RETURN DIRSTART])(AT.STARTUP  [LAMBDA (WINDOW COMMANDMENU COMMANDMENUWINDOW)             (* scv "20-Jun-85 11:05")    (PROG ((DIR (FASSOC (QUOTE DIRECTORY)			ATMENUITEMS)))          (RESETLST (RESETSAVE NIL (LIST (QUOTE SHADEITEM)					 DIR COMMANDMENU WHITESHADE))		    (RESETSAVE NIL (LIST (FUNCTION [LAMBDA (W P)					     (PUTWINDOWPROP W (QUOTE AUTOTESTERBUSY)							    P])					 WINDOW NIL))		    (SHADEITEM DIR COMMANDMENU ATITEMSELECTEDSHADE COMMANDMENUWINDOW)		    (PUTWINDOWPROP WINDOW (QUOTE AUTOTESTERBUSY)				   T)		    (AT.UPDATEAUTOTESTERITEMS (GETWINDOWPROP WINDOW (QUOTE ITEMSPEC))					      WINDOW])(AT.CREATEPRINTSPEC  [LAMBDA (FILEINFO WANTTOSEE NAMESTART)                     (* scv "13-Jun-85 17:23")    (for HEADING in ATINFOLISTINGWIDTHS by (CDDR HEADING) when (FMEMB HEADING WANTTOSEE)       collect (create ATPRINTSPEC		       LABEL _[COND			 ((EQ HEADING (QUOTE FILE))			   (SUBSTRING (CDR (FASSOC HEADING FILEINFO))				      NAMESTART))			 (T (CDR (FASSOC HEADING FILEINFO]		       WIDTH _(fetch (ATPRINTSPEC WIDTH) of (LISTGET ATINFOLISTINGWIDTHS HEADING])(AT.FINDTESTBUCKET  [LAMBDA (WINDOW)                                           (* scv "22-May-85 15:30")    (for TEST in (WINDOWPROP WINDOW (QUOTE AUTOTESTERITEMMAP))       bind [YPOS _(IPLUS (LASTMOUSEY WINDOW)			  (FONTPROP WINDOW (QUOTE DESCENT]       thereis (IGREATERP YPOS (fetch BOTTOM of (fetch (TESTBUCKET ITEMREGION) of TEST])(AT.PROMPTFORINPUT  [LAMBDA (PROMPT EXPRS WINDOW)                              (* hdj " 1-Sep-84 15:58")    (PROMPTFORWORD PROMPT EXPRS NIL (CAR (GETWINDOWPROP WINDOW (QUOTE PROMPTWINDOW)))		   NIL		   (QUOTE TTY)		   (CHARCODE (CR ESC])(AT.GETALLFILEINFO  [LAMBDA (FILE GENERATOR ATTRIBUTES)                        (* scv "13-Jun-85 16:15")          (* *)    (for ATTR in ATTRIBUTES collect (if (EQ ATTR (QUOTE FILE))					then (CONS ATTR FILE)				      elseif (EQ ATTR (QUOTE NAME))					then (CONS ATTR (FILENAMEFIELD FILE (QUOTE NAME)))				      elseif (EQ ATTR (QUOTE RESULT))					then (CONS ATTR (QUOTE ?))				      else (CONS ATTR (\GENERATEFILEINFO GENERATOR ATTR])(AT.GETPRINTDESTINATION  [LAMBDA (KEY)                                              (* scv " 2-Jul-85 10:24")    (if (EQ KEY (QUOTE LEFT))	then (OPENIMAGESTREAM (QUOTE {LPT}))      else (SELECTQ (MENU (create MENU				  ITEMS _(QUOTE (File Printer))				  TITLE _ "Print where?"				  MENUCOLUMNS _ 1))		    [File (PROG (FILE)			        (SETQ FILE (GetImageFile))			        (RETURN (OPENIMAGESTREAM (CAR FILE)							 (CDR FILE]		    [Printer (OPENIMAGESTREAM (PACKFILENAME (QUOTE HOST)							    (QUOTE LPT)							    (QUOTE NAME)							    (GetPrinterName]		    (SHOULDNT "Bad printer destination"])(AT.\ItemWithTag  [LAMBDA (TAG ITEMS)                                        (* hdj "16-Sep-84 16:16")          (* * search a menu's items for one with tag TAG)    (for ITEM in ITEMS do (if (EQ (CADR ITEM)				  TAG)			      then (RETURN ITEM]))(DECLARE: EVAL@COMPILE DONTCOPY (DECLARE: EVAL@COMPILE (RPAQQ AT.MARKXPOS 16)(CONSTANTS (AT.MARKXPOS 16)))[DECLARE: EVAL@COMPILE (RECORD ATPRINTSPEC (LABEL . WIDTH))(RECORD TESTBUCKET (FILENAME ITEMREGION # SELECTED? COMPLETED? SUCCESSFUL? ITEM))])(ADDTOVAR BackgroundMenuCommands ("AutomatedTester" (AT)						    					"Opens an automated tester window; prompts for directory"))(RPAQQ BackgroundMenu NIL)(DECLARE: DONTEVAL@LOAD DOEVAL@COMPILE DONTCOPY COMPILERVARS (ADDTOVAR NLAMA AT)(ADDTOVAR NLAML )(ADDTOVAR LAMA AT.PROMPTWPRINT))(PUTPROPS AUTOTEST COPYRIGHT ("XEROX Corporation" 1985))(DECLARE: DONTCOPY  (FILEMAP (NIL (9367 16583 (AT 9377 . 9610) (AUTOTESTER 9612 . 14714) (SINGLE-TEST 14716 . 16399) (TEST-MESSAGE 16401 . 16581)) (16628 24097 (AT.TESTCOMMAND 16638 . 19449) (AT.ABORTCOMMAND 19451 . 21083) (AT.PAUSECOMMAND 21085 . 21532) (AT.RESUMECOMMAND 21534 . 22689) (AT.DIRECTORYCOMMAND 22691 . 23307) (AT.PRINTCOMMAND 23309 . 23958) (AT.QUITCOMMAND 23960 . 24095)) (24098 38258 (AT.COMMANDDISPATCH 24108 . 30527) (AT.SELECT 30529 . 32304) (AT.UPDATEAUTOTESTERITEMS 32306 . 35823) (AT.SINGLE-TEST 35825 . 38256)) (38298 53841 (AT.MAKERIGIDWINDOW 38308 . 38784) (AT.CLRPROMPTW 38786 . 38985) (AT.PRINTHEADINGSON 38987 . 40340) (AT.PRINTANDGETREGION 40342 . 41924) (AT.MAKEHEADINGWINDOW 41926 . 42761) (AT.MAKECOUNTERWINDOW 42763 . 43384) (AT.MAKETIMEWINDOW 43386 . 43996) (AT.PROMPTWPRINT 43998 . 44481) (AT.PROMPTWTERPRI 44483 . 44799) (AT.SELECTFILE 44801 . 45349) (AT.UNSELECTFILE 45351 . 45816) (AT.CHANGECOMPLETEMARK 45818 . 46341) (AT.SHOW.NUMCOMPLETED 46343 . 47252) (AT.SHOW.NUMFILES 47254 . 48173) (AT.SHOW.NUMSELECTED 48175 . 49101) (AT.SHOW.NUMSUCCESSFUL 49103 . 50015) (AT.SHOW.ENDTIME 50017 . 50974) (AT.SHOW.STARTTIME 50976 . 51941) (AT.SHOW.TESTID 51943 . 52884) (AT.SHOW.TESTSUITE 52886 . 53839)) (53871 61709 (AT.HEADINGWREDISPLAYFN 53881 . 54138) (AT.REPAINT.COUNTERW 54140 . 54591) (AT.REPAINT.TIMEW 54593 . 55022) (AT.ICONFN 55024 . 55771) (AT.BUTTONEVENTFN 55773 . 55913) (AT.CURSORMOVEDFN 55915 . 56280) (AT.CURSOROUTFN 56282 . 56428) (AT.REPAINTFN 56430 . 58022) (AT.SCROLLFN 58024 . 58704) (AT.RIGHTBUTTONFN 58706 . 58955) (AT.MENU.WHENSELECTEDFN 58957 . 59301) (AT.CLOSEFN 59303 . 60543) (AT.HARDCOPYFN 60545 . 61707)) (61736 66330 (AT.FETCHFILENAME 61746 . 61910) (AT.STARTOFNAME 61912 . 62808) (AT.STARTUP 62810 . 63502) (AT.CREATEPRINTSPEC 63504 . 64065) (AT.FINDTESTBUCKET 64067 . 64476) (AT.PROMPTFORINPUT 64478 . 64752) (AT.GETALLFILEINFO 64754 . 65308) (AT.GETPRINTDESTINATION 65310 . 66031) (AT.\ItemWithTag 66033 . 66328)))))STOP