(DEFINE-FILE-INFO READTABLE "INTERLISP" PACKAGE "INTERLISP")(FILECREATED "16-May-90 20:36:32" {DSK}<usr>local>lde>lispcore>sources>MEM.;2 9319         changes to%:  (VARS MEMCOMS)      previous date%: " 5-Sep-86 13:42:56" {DSK}<usr>local>lde>lispcore>sources>MEM.;1)(* ; "Copyright (c) 1982, 1983, 1986, 1990 by Venue & Xerox Corporation.  All rights reserved.")(PRETTYCOMPRINT MEMCOMS)(RPAQQ MEMCOMS       ((FNS MKI.NEXTPAGE WriteoutPage MKI.NEWPAGE MKI.LOCKPAGES MKI.LOCKEDPAGEP RESETMEMORY)        (DECLARE%: EVAL@COMPILE (VARS (PTRNIL 0)                                      (PTRNOBIND 1))               DONTCOPY               (RECORDS ALTOPOINTER))        (VARS (NEWPAGETRACE)              (BLANKPAGE))        (FNS I.PUTBASE I.GETBASE I.PUTBASEPTR I.GETBASEPTR)        (DECLARE%: DONTCOPY (MACROS .DOADDBASE. I.HILOC I.LOLOC I.ADDBASE I.PAGELOC I.VAG2))        (VARS (MEMARRAY))        (GLOBALVARS MEMARRAY NONPAGE NONPAGE2 PTRNIL BLANKPAGE NEWPAGETRACE)))(DEFINEQ(MKI.NEXTPAGE  [LAMBDA (VP)                                           (* lmm "30-JUL-80 13:33")    (PROG (A I)      L1  (COND             ((IGREATERP VP 65535)              (RETURN))             ((EQ (SETQ A (FASTELT MEMARRAY (LRSH VP 8)))                  NONPAGE2)              (SETQ VP (ADD1 (LOGOR VP 255)))              (GO L1)))          (SETQ I (LOGAND VP 255))      L2  [COND             ((EQ I 256)              (SETQ VP (ADD1 (LOGOR VP 255)))              (GO L1))             ((NEQ (FASTELT A I)                   NONPAGE)              (RETURN (IPLUS (LOGAND VP 65280)                             I]          (SETQ I (ADD1 I))          (GO L2])(WriteoutPage  [LAMBDA (FX VP)                                        (* lmm "17-MAR-81 16:20")                                                             (* For MAXC)    (PROG [(A (FASTELT (FASTELT MEMARRAY (LRSH VP 8))                     (LOGAND VP 255]          (AOUT A 0 256 FX 'SMALLPOSP])(MKI.NEWPAGE  [LAMBDA (PTR NOERROR LOCK? BLANKFLG)                   (* edited%: " 7-SEP-83 12:04")    (PROG (A LO1 PAGE)          [COND             ((EQ (SETQ A (FASTELT MEMARRAY (LRSH PTR 16)))                  NONPAGE2)              (FASTSETA MEMARRAY (LRSH PTR 16)                     (SETQ A (POINTERARRAY 256 NONPAGE]          [COND             ((NEQ (FASTELT A (SETQ LO1 (LRSH (LOGAND PTR 65535)                                              8)))                   NONPAGE)              (HELP PTR '"already allocated"]          (COND             (NEWPAGETRACE (printout NEWPAGETRACE "page " |.I3.8| (I.HILOC PTR)                                  "," |.I3.8| (LRSH (I.LOLOC PTR)                                                    8)                                  %,,,)))          [FASTSETA A LO1 (COND                             ((NOT BLANKFLG)                              (WORDARRAY 256))                             (T (OR BLANKPAGE (SETQ BLANKPAGE (WORDARRAY 256]          (AND LOCK? (MKI.LOCKPAGES PTR 1))          (RETURN PTR])(MKI.LOCKPAGES  [LAMBDA (PTR NPAGES)                                   (* lmm "11-AUG-80 21:53")    (push LOCKEDPAGES (CONS (I.PAGELOC PTR)                                NPAGES])(MKI.LOCKEDPAGEP  [LAMBDA (VP)                                           (* lmm " 9-FEB-82 21:54")    (for X in LOCKEDPAGES when [AND (IGEQ VP (CAR X))                                                (ILESSP VP (IPLUS (CAR X)                                                                  (CDR X] do (RETURN T])(RESETMEMORY  [LAMBDA NIL                                            (* lmm "26-MAR-81 09:23")    (SETQ LOCKEDPAGES)    (COND       ((NULL MEMARRAY)        (SETQ NONPAGE (WORDARRAY 256))        (SETQ NONPAGE2 (POINTERARRAY 256 NONPAGE))        (SETQ MEMARRAY (POINTERARRAY 256 NONPAGE2)))       (T (for I from 0 to 255 do (FASTSETA MEMARRAY I NONPAGE2]))(DECLARE%: EVAL@COMPILE (RPAQQ PTRNIL 0)(RPAQQ PTRNOBIND 1)DONTCOPY (DECLARE%: EVAL@COMPILE(ACCESSFNS ALTOPOINTER ((HILOC (LRSH DATUM 16))                            (LOLOC (LOGAND DATUM 65535)))                           (CREATE (IPLUS (LLSH HILOC 16)                                              LOLOC))                           [ACCESSFNS ALTOPOINTER ((6to13 (LRSH (LOGAND DATUM 65535)                                                                8))                                                   [bit12 (NOT (ZEROP (LOGAND 512 DATUM]                                                   (0to13 (I.PAGELOC DATUM))                                                   (0to11 (LRSH (I.PAGELOC DATUM)                                                                2])))(RPAQQ NEWPAGETRACE NIL)(RPAQQ BLANKPAGE NIL)(DEFINEQ(I.PUTBASE  [LAMBDA (PTR D V)    (PROG (HI LO1 LO2)          (DECLARE (LOCALVARS . T))          (.DOADDBASE. PTR D)          (AND (EQ (SETQ HI (FASTELT (FASTELT MEMARRAY HI)                                   LO1))                   NONPAGE)               (INVALIDADDR))          (RETURN (FASTSETAW HI LO2 V])(I.GETBASE  [LAMBDA (PTR D)    (PROG (HI LO1 LO2)          (DECLARE (LOCALVARS HI LO1 LO2))          (.DOADDBASE. PTR D)          (COND             ((EQ (SETQ HI (FASTELT (FASTELT MEMARRAY HI)                                  LO1))                  NONPAGE)              (INVALIDADDR)))          (RETURN (FASTELTW HI LO2])(I.PUTBASEPTR  [LAMBDA (PTR D V)    (PROG (HI LO1 LO2 (VAL (OR V PTRNIL)))          (DECLARE (LOCALVARS . T))          (.DOADDBASE. PTR D)          (AND (EQ (SETQ HI (FASTELT (FASTELT MEMARRAY HI)                                   LO1))                   NONPAGE)               (INVALIDADDR))          (FASTSETAW HI LO2 (LRSH VAL 16))          (FASTSETAW HI (ADD1 LO2)                 (LOGAND VAL 65535))          (RETURN VAL])(I.GETBASEPTR  [LAMBDA (PTR D)    (PROG (HI LO1 LO2)          (DECLARE (LOCALVARS . T))          (.DOADDBASE. PTR D)          (COND             ((EQ (SETQ HI (FASTELT (FASTELT MEMARRAY HI)                                  LO1))                  NONPAGE)              (INVALIDADDR)))          (RETURN (I.VAG2 (LOGAND 255 (FASTELTW HI LO2))                         (FASTELTW HI (ADD1 LO2]))(DECLARE%: DONTCOPY (DECLARE%: EVAL@COMPILE [PROGN (PUTPROPS .DOADDBASE. MACRO ((PTR D)                                            (ASSEMBLE NIL (CQ (VAG (IPLUS PTR D)))                                                   (LSHC 1 %, -16)                                                   (ADDI 1 %, ASZ)                                                   (SETQ HI)                                                   (LSHC 1 %, 8)                                                   (ANDI 1 %, 255)                                                   (ADDI 1 %, ASZ)                                                   (SETQ LO1)                                                   (LSHC 1 %, 8)                                                   (ANDI 1 %, 255)                                                   (ADDI 1 %, ASZ)                                                   (SETQ LO2))))       (PUTPROPS .DOADDBASE. ALTOMACRO ((PTR D)                                                (SETQ HI (LRSH (SETQ LO2 (IPLUS PTR D))                                                               16))                                                (SETQ LO1 (LOGAND 255 (LRSH LO2 8)))                                                (SETQ LO2 (LOGAND LO2 255))))       (PUTPROPS .DOADDBASE. DMACRO ((PTR D)                                             (SETQ HI (LRSH (SETQ LO2 (IPLUS PTR D))                                                            16))                                             (SETQ LO1 (LOGAND 255 (LRSH LO2 8)))                                             (SETQ LO2 (LOGAND LO2 255))))](PUTPROPS I.HILOC MACRO ((PTR)                                 (LRSH (OR PTR PTRNIL)                                       16)))(PUTPROPS I.LOLOC MACRO ((PTR)                                 (LOGAND (OR PTR PTRNIL)                                        65535)))(PUTPROPS I.ADDBASE MACRO ((PTR D)                                   (IPLUS (OR PTR PTRNIL)                                          D)))(PUTPROPS I.PAGELOC MACRO ((PTR)                                   (LRSH (OR PTR PTRNIL)                                         8)))(PUTPROPS I.VAG2 MACRO ((HI LO)                                ([LAMBDA (X)                                   (DECLARE (LOCALVARS . T))                                   (COND                                      ((ZEROP X)                                       NIL)                                      (T X]                                 (IPLUS (LLSH HI 16)                                        LO))))))(RPAQQ MEMARRAY NIL)(DECLARE%: DOEVAL@COMPILE DONTCOPY(GLOBALVARS MEMARRAY NONPAGE NONPAGE2 PTRNIL BLANKPAGE NEWPAGETRACE))(PUTPROPS MEM COPYRIGHT ("Venue & Xerox Corporation" 1982 1983 1986 1990))(DECLARE%: DONTCOPY  (FILEMAP (NIL (999 4037 (MKI.NEXTPAGE 1009 . 1696) (WriteoutPage 1698 . 2015) (MKI.NEWPAGE 2017 . 3098) (MKI.LOCKPAGES 3100 . 3298) (MKI.LOCKEDPAGEP 3300 . 3644) (RESETMEMORY 3646 . 4035)) (4901 6437 (I.PUTBASE 4911 . 5236) (I.GETBASE 5238 . 5578) (I.PUTBASEPTR 5580 . 6027) (I.GETBASEPTR 6029 . 6435)))))STOP